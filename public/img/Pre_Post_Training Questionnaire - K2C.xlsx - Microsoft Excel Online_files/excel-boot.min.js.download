var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(t){var i={};function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(i){return t[i]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=5)}({5:function(t,i,e){"use strict";e.r(i),e.d(i,"DocRebootSupportMode",(function(){return Rt})),e.d(i,"CommandIds",(function(){return gt})),e.d(i,"Application",(function(){return Wt}));var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};function o(t,i){function e(){this.constructor=t}n(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}var r=function(){return(r=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)};var s= "16.0.12918.35052";function a(){return s}var c,u,h,f=function(){function t(){}return t.prototype.u=function(){},t.prototype.shipAssertTag=function(){},t.prototype.debugAssertTag=function(){},t}();(u=c||(c={}))[u.Error=10]="Error",u[u.Warning=15]="Warning",u[u.Info=50]="Info",u[u.Verbose=100]="Verbose",u[u.Spam=200]="Spam",function(t){t[t.h=0]="msoulscat_ES_EWAJS",t[t.v=1]="msoulscat_ES_EWAJSGrid",t[t.g=6]="msoulscat_ES_EWAJSChart",t[t._=301]="msoulscat_Wac_WordViewer",t[t.O=306]="msoulscat_Wac_BrowserGeneral",t[t.A=320]="msoulscat_Wac_TaskPane",t[t.U=339]="msoulscat_Wac_OneNoteGeneral",t[t.R=340]="msoulscat_Wac_Ribbon",t[t.P=379]="msoulscat_Wac_WopiPendingApplication",t[t.W=383]="msoulscat_Wac_Telemetry",t[t.F=391]="msoulscat_Wac_WacCatchUpActivities",t[t.N=394]="msoulscat_Wac_Dictation",t[t.k=395]="msoulscat_Wac_OneNoteSync",t[t.B=700]="msoulscat_Wac_VisioApp",t[t.H=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.J=800]="msoulscat_Wac_PptAnimation",t[t.j=833]="msoulscat_Wac_PptLive",t[t.q=834]="msoulscat_Wac_PptMWeb",t[t.X=815]="msoulscat_Wac_PptShape",t[t.Z=817]="msoulscat_Wac_PptSession",t[t.$=830]="msoulscat_Wac_PptSlideshow",t[t.K=2300]="msoulscat_Wac_VersionHistory",t[t.Y=302]="msoulscat_Wac_WordPresence",t[t.tt=3005]="msoulscat_Wac_WordVersionHistory",t[t.it=3006]="msoulscat_Wac_LivePersonaCard",t[t.et=3012]="msoulscat_Wac_CatchUpFlyout"}(h||(h={}));var l;(function(){function t(){}t.tagIntToString=function(i){return i<=t.maxNumericTag?i.toString():i>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i):t.map.charAt(i>>24&63)+t.map.charAt(i>>18&63)+t.map.charAt(i>>12&63)+t.map.charAt(i>>6&63)+t.map.charAt(63&i)},t.getLogMessage=function(i,e,n){return"tag_"+t.tagIntToString(i)+" ["+h[e]+"] "+n},t.prototype.u=function(i,e,n,o){var r=console.log;switch(n){case c.Error:r=console.error;break;case c.Warning:r=console.warn;break;case c.Info:r=console.info;break;case c.Verbose:r=console.debug;break;case c.Spam:default:r=console.log}try{r(t.getLogMessage(i,e,o))}catch(t){var s="undefined"!=typeof navigator?navigator:void 0;if(s&&!/rv:11.0/i.test(s.userAgent))throw t}},t.prototype.shipAssertTag=function(i,e,n,o){console.assert(n,t.getLogMessage(i,e,o))},t.prototype.debugAssertTag=function(t,i,e,n){this.shipAssertTag(t,i,e,n)},t.maxNumericTag=65535,t.minOldSchemeHighByteValue=36,t.map="abcdefghijklmnopqrstuvwxyz0123456789"})(),new(function(){function t(){this.externalLogger=new f}return t.prototype.setLogger=function(t){this.externalLogger=t},t.prototype.u=function(t,i,e,n){this.externalLogger.u(t,i,e,n)},t.prototype.debugAssertTag=function(t,i,e,n){this.externalLogger.debugAssertTag(t,i,e,n)},t.prototype.shipAssertTag=function(t,i,e,n){this.externalLogger.shipAssertTag(t,i,e,n)},t}());function d(t,i,e){if(""!==i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",i,e),n.send(t))}}function p(t,i,e,n){var o=t.map((function(t){return function(t,i){var e={};e.G=t.tag,e.T=t.timestamp-i,e.M=t.message,e.C=t.category;var n=1e3*t.type+t.level;return e.D=n,e}(t,n)})),r=function(t,i,e,n){var o={};return o.T=t,o.L=i,o.S=e,o.I=n,o.V=1,o}(n,o,i,e);return JSON.stringify(r)}!function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(l||(l={}));!function(){function t(i,e){var n=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){n.triggerUpload(!1,!1)},this.flush=function(){n.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(i,e){(window.clearTimeout(n.timeoutId),n.logCache.length>0)&&(n.uploadId+=1,d(p(n.logCache,n.userSessionId,n.uploadId,n.timestampBase),n.remoteUrlEndpoint,e),n.logCache=[],n.timestampBase=Date.now());i&&(n.timeoutId=window.setTimeout(n.triggerUploadAsync,t.uploadCadenceInMsSec))},this.userSessionId=i,this.remoteUrlEndpoint=e+"?usid="+i,window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)}t.prototype.handleTrace=function(i){i.message.length>t.messageMaxChars&&(i.message=i.message.substr(0,t.messageMaxChars-t.trimmedMessage.length)+t.trimmedMessage),this.logCache.push(i),(this.logCache.length>t.uploadTriggerSize||i.level===c.Error)&&this.triggerUploadAsync()},t.messageMaxChars=3072,t.uploadCadenceInMsSec=3e4,t.uploadTriggerSize=30,t.trimmedMessage="... [Trimmed]"}();c.Info;!function(t){function i(){return null!==t&&t.apply(this,arguments)||this}o(i,t)}(f);function v(t){return 8===t.toLowerCase().indexOf("ffc")}function w(t){return 8===t.toLowerCase().indexOf("ppc")}function m(t){var i=t.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!i)throw new Error("Invalid URL");return i[1]}function g(t,i){var e=t.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!e)throw new Error("Invalid URL");var n=e[2];if(void 0===i)return n;if(i<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(i+1)).join(".")}function S(t,i){var e=t.indexOf("&"+i+"=");if(-1===e&&(e=t.indexOf("?"+i+"=")),-1===e)return"";var n=e+(i.length+2),o=t.indexOf("&",n);return t.substring(n,-1===o?void 0:o)}function b(t,i,e,n){if(void 0===n&&(n=!1),!e)return t;var o=t,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=i.toLowerCase()+"=",c=o.toLowerCase().indexOf(a,r);if("?"!==s&&c>=0){if(n){var u=o.indexOf("&",c);o=o.substring(0,c)+a+e+(-1===u?"":o.substring(u))}return o}return o.concat(s,a,e)}function _(t){if(!t)return"";var i=-1===t.indexOf("#")?t.length:t.indexOf("#"),e=t.lastIndexOf("/",i);if(-1!==e&&e+1===t.indexOf("://")+"://".length)return"";e+=1;var n=t.indexOf("?");if(-1!==(n=n>=i?-1:n)&&e>n)return"";var o=-1===n?i:n;return e>=o?"":t.substring(e,o)}function y(t){return JSON.stringify(t,Object.getOwnPropertyNames(t))}function I(t){try{if(void 0===window.performance)return void t.ULS.u(595948609,h.P,c.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.u(595948610,h.P,c.Info,"No resources under performance");for(var e=new RegExp("(excel|onenote)-boot.min.js|(word|visio).boot.js","i"),n=0,o=i;n<o.length;n++){var r=o[n];if(e.test(r.name)){var s=JSON.stringify(r),a=_(r.name);return s=s.replace(new RegExp(r.name,"g"),a),void t.ULS.u(595948616,h.P,c.Info,s)}}t.ULS.u(595948484,h.P,c.Info,"Could not find JSAPI resource timing entry")}catch(i){t.ULS.u(595948617,h.P,c.Info,"Could not trace the resource timing: "+y(i))}}function O(){if(window&&window.navigator){var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection,e={};return i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency,e}}function E(){var t=new Uint8Array(31),i=function(t){var i={crypto:!1,perfNow:!1,exceptions:[]},e=window.crypto||window.msCrypto;if(e){i.crypto=!0;try{return e.getRandomValues(t),i}catch(t){i.exceptions.push("crypto: "+y(t))}}var n=!1,o=window.performance;try{o&&o.now&&o.now()!==1/0&&(n=!0)}catch(t){i.exceptions.push("perfNow: "+y(t))}for(var r=0;r<t.length;r+=1){try{if(n){i.perfNow=!0;var s=Math.floor(100*o.now())%10;(s<0||s>9)&&(s=0);for(var a=0;a<s;a+=1)Math.random()}}catch(t){i.exceptions.push("Math.random: "+y(t))}t[r]=Math.floor(16*Math.random())}return i}(t),e=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){var n=15&t[e];return e+=1,("x"===i?n:3&n|8).toString(16)})),i]}var T,x,C=function(){function t(t,i){var e=this;this.nt=3072,this.ot="... [Trimmed]",this.rt=1e3,this.st=3e4,this.at=30,this.ct=0,this.ut=[],this.ht=Date.now(),this.ft="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){e.lt(!1,!1)},this.flush=function(){e.dt()},this.dt=function(){window.setTimeout((function(){return e.lt(!0,!0)}),0)},this.lt=function(t,i){if(window.clearTimeout(e.pt),e.vt){if(e.ut.length>0)e.ct+=1,d(p(e.ut.splice(0,t?e.at:e.ut.length),e.ft,e.ct,e.ht),e.vt,i),e.ht=Date.now();t&&(e.pt=window.setTimeout(e.dt,e.ut.length>e.at?e.rt:e.st))}},this.ft=t,i&&this.configure(i)}return t.prototype.configure=function(t){var i=this;if(t.uploadCadenceInMs&&(this.st=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.at=t.uploadTriggerSize),t.remoteUlsEndpoint){if(this.vt)throw new Error("Remote ULS endpoint is already set");this.vt=t.remoteUlsEndpoint+"?usid="+this.ft,this.ht=Date.now(),window.setTimeout((function(){return i.lt(!0,!0)}),0)}},t.prototype.handleTrace=function(t){t.message.length>this.nt&&(t.message=t.message.substring(0,this.nt-this.ot.length)+this.ot),this.ut.push(t),(this.ut.length>this.at||t.level===c.Error)&&this.dt()},t}(),A=[];!function(t){t.wt="ExcelInstantShellEnabled",t.gt="BootstrapperMaxUlsHeartbeatTime",t.St="BootstrapperNoCompleteWarning1Time",t.bt="BootstrapperNoCompleteWarning2Time",t._t="RemoteUlsETag",t.yt="RemoteUlsSuppressions",t.It="BootstrapperSettingsFetchPeriod",t.Ot="timestamp",t.Et="BootstrapperUlsHeartbeatIntervalMs",t.Tt="BootstrapperUlsHeartBeatIsEnabled",t.xt="BootstrapperUlsUploadCadenceMs"}(x||(x={}));var U,R,P,W,F;function N(t,i){var e=new C(t,i);function n(t,i,n,o){if(!function(t){return 1===A[t]}(t)){var r={timestamp:Date.now(),category:i,tag:t,level:n,type:l.Trace,message:o};e.handleTrace(r)}}return{ULS:{u:function(t,i,e,o){n(t,i,e,o)},shipAssertTag:function(t,i,e,o){e&&n(t,i,c.Error,o)},debugAssertTag:function(t,i,e,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:e.flush,flushOnClose:e.flushOnClose},configure:function(t){e.configure(t)},settingsChangeHandler:function(t){var i,n;i=t.settingsManager.getValue(x.yt,""),n=t.settingsManager.getValue(x._t,""),T&&n===T||(A=[],T=n,i&&i.split(",").forEach((function(t){var i=parseInt(t,10);i&&(A[i]=1)}))),e.configure({uploadCadenceInMs:t.settingsManager.getValue(x.xt,6e4)})}}}function k(){if(null!=navigator&&null!=navigator.userAgent){var t=navigator.userAgent;if(t.indexOf("Firefox")>-1)return U.Firefox;if(t.indexOf("Opera")>-1)return U.Opera;if(t.indexOf("Trident")>-1)return U.IE;if(t.indexOf("Edge")>-1)return U.Edge;if(t.indexOf("Chrome")>-1)return U.Chrome;if(t.indexOf("Safari")>-1)return U.Safari}return U.Unknown}function D(){try{return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&L()&&!(navigator.userAgent.indexOf("iPhone")>=0)||navigator.userAgent.indexOf("Android")>=0||L()}catch(t){return!1}}function M(){return k()===U.IE&&!function(){if(k()!==U.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function L(){return navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function B(t){var i=t.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!i)throw new Error("Invalid URL");return i[1]}function H(t,i){i&&i.Diagnostics&&Object.keys(i.Diagnostics).forEach((function(e){return t[e]=i.Diagnostics[e]}))}function J(t,i,e){i.ULS.u(596459999,h.P,e,"SessionTraces: "+JSON.stringify(t))}function j(t,i,e){e.Stop();var n=e.GetVisibilityChangeEvents();null!=n&&n.length>0&&(t.documentLoadedWithTabSwitch=!0,i.tabSwitchDiagnostics=JSON.stringify(n)),e.Dispose()}function z(t,i,e){if(t){var n="Page lifecycle: "+i+" fired.";n+=e?" Flushing ULS logger":"",t.ULS.u(595957843,h.P,c.Info,n),e&&t.ULS.flush()}}function V(t,i,e){t.ULS.u(596464283,h.P,c.Info,"Initializing session. Build version: "+a()),e&&t.ULS.u(595937313,h.P,c.Info,JSON.stringify(e)),i.rebootOverrideData&&(i.rebootOverrideData.previousSessionId||t.ULS.u(594613645,h.P,c.Warning,"Missing previous session id")),t.ULS.u(595632928,h.P,c.Info,function(){if(window&&window.navigator){var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;if(i)return"EffectiveType: "+i.effectiveType+", BandwidthMps: "+i.downlink+", ConnectionType: "+i.type}return""}()),i&&i.wopiInfo&&i.wopiInfo.AccessToken&&i.wopiInfo.AccessTokenExpiry?(0===i.wopiInfo.AccessToken.length||i.wopiInfo.AccessTokenExpiry.getTime()<=Date.now())&&t.ULS.u(595894621,h.P,c.Error,"Invalid AccessToken. AccessTokenLength: "+i.wopiInfo.AccessToken.length+", AccessTokenExpiry: "+i.wopiInfo.AccessTokenExpiry+", AccessTokenTTL: "+i.wopiInfo.AccessTokenExpiry.getTime()+", DateNow: "+Date.now()):t.ULS.u(595894553,h.P,c.Warning,"There are some missing paramters");var n=function(t,i){var e=JSON.parse(JSON.stringify(i));delete e.UserId,delete e.OwnerId,delete e.WdParams;var n=i.WdParams?JSON.parse(JSON.stringify(i.WdParams).toLowerCase()):{};return e.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf","wdsandboxwacframe"].forEach((function(t){n[t]&&(e.WdParams[t]=n[t])})),e.UiEmbedMode=t.toLowerCase().indexOf("uiembed=1")>=0,e.UiHostName=S(t,"uih")||"N/A",e.hostName=location?location.hostname:"",e}(i.applicationUrl,i.sessionInformation);t.ULS.u(596444237,h.P,c.Info,JSON.stringify({hostSessionInformation:n,clientSignals:O()})),t.ULS.u(596444238,h.P,c.Info,"HostInitDiagnostics: "+(i.diagnostics.HostInitializeDiagnostics?JSON.stringify(i.diagnostics.HostInitializeDiagnostics):"N/A"))}!function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.Unknown=6]="Unknown"}(U||(U={})),function(t){t.Ct="App_AccessibilityLoopComplete",t.At="Wac_AppFailed",t.Ut="Wac_AppBootState",t.Rt="Wac_AppCompleted",t.Pt="BrowserEvent",t.Wt="UI_Close",t.Ft="UI_Conversation",t.Nt="UI_CopyAndEdit",t.kt="UI_Download",t.Dt="Error",t.Mt="UI_FileEmbed",t.Lt="UI_FileProperties",t.Bt="File_Rename",t.Ht="File_RenameFailed",t.Jt="UI_FileVersions",t.jt="StateChanged",t.zt="App_WopiInfoFromUrl",t.Vt="WacInitialize_FrameLoaded",t.qt="WacInitialize_Ready",t.Gt="App_LoadingStatus",t.Xt="App_SwitchMode",t.Zt="UI_OpenInBrowser",t.$t="UI_OpenInClient",t.Kt="PageChanged",t.Qt="App_PushState",t.Yt="App_DocReboot",t.ti="UI_RedeemForCommenting",t.ii="App_RefreshSessionInfo",t.ei="UI_ReplyWithChanges",t.ni="UI_ReportAbuse",t.oi="UI_SaveStatus",t.ri="WopiSession_Complete_Ack",t.si="UI_Sharing",t.ai="UI_ShareForm",t.ci="UI_SignIn",t.hi="App_IsFrameTrusted",t.fi="App_Unloaded",t.li="PageCount",t.di="UI_CheckUserAccessAndGrantPermissions",t.pi="User_Activity",t.vi="Edit_Notification",t.wi="UI_Workflow",t.mi="ZoomChanged"}(R||(R={})),function(t){t.gi="Ack",t.Si="Blur_Focus",t.bi="Wac_AppFailed_Ack",t._i="Wac_AppCompleted_Ack",t.yi="Host_AccessibilityLoopComplete",t.Ii="WopiPendingSession_Fail",t.Oi="Grab_Focus",t.Ei="HostCacheDiagnostic",t.Ti="WacInitialize_Ready_Ack",t.xi="JsApiDiagnostics",t.Ci="PageChanged_Ack",t.Ai="WopiPendingApplicationComplete_Received",t.Ui="WopiPendingSession_Complete",t.Ri="App_PopState",t.Pi="Host_PostmessageReady",t.Wi="File_Rename",t.Fi="CanEmbed",t.Ni="Host_RefreshSessionInfo",t.ki="CheckUserAccessAndGrantPermissions_Result",t.Di="Host_WopiInfoFromUrl",t.Mi="SetCurrentPage",t.Li="SetZoomLevel",t.Bi="WopiStartSession_Complete",t.Hi="Host_SwitchMode",t.hi="Host_IsFrameTrusted",t.Ji="Host_Unload",t.ji="PageCount_Ack",t.zi="ZoomChanged_Ack"}(P||(P={})),function(t){t.Vi="EnterpriseTemplates",t.qi="ExcelAdaptiveLayoutDownload",t.Gi="ExcelHashedUrl",t.Xi="ExcelLandingPageOfflineTelemetry",t.Zi="ExcelLandingPageObserverRetry",t.$i="H2StaticContent",t.Ki="HashedUrl",t.Qi="InstantShell",t.Yi="ODCShareLinkPreload",t.te="OfficeComUiHost",t.ie="WordJsApiV2"}(W||(W={})),function(t){t.Unknown="Unknown",t.AppInitError="AppInitError",t.ApiDisabledError="ApiDisabledError",t.CannotLoadFirstPage="CannotLoadFirstPage",t.CannotLoadScript="CannotLoadScript",t.PageChangeError="PageChangeError",t.ZoomChangeError="ZoomChangeError",t.CannotLoadBundleItem="CannotLoadBundleItem",t.InvalidPageIndex="InvalidPageIndex",t.UnsupportedBundleVersion="UnsupportedBundleVersion",t.InvalidWopiInfo="InvalidWopiInfo",t.TimeoutWacReady="TimeoutWacReady",t.WacFailed="WacFailed"}(F||(F={}));var q;function G(t,i,e){void 0===e&&(e=!1);var n=t.applicationUrl;t.wopiPrecheckInfo.IsNewFile&&n.replace("unified=1","edit=1&new=1");var o={jsApi:"1"};if(e&&(o.NewSession="1"),o.corrid=t.sessionId,o.usid=t.sessionId,o.sftc="1",(t.applicationCustomSettings&&t.applicationCustomSettings.IsCore||t.sessionInformation.IsCore)&&(o.core="1"),t.sessionInformation.HideViewerToolbar&&(o.hvt="1"),t.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),t.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(t.sessionInformation.HighContrastMode)),t.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),t.sessionInformation.SupportsDocReboot){var s=t.sessionInformation.SupportsDocReboot;o.sdr=!0===s?"1":s.toString()}return t.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),t.sessionInformation.HideHeader&&(o.hhdr="1"),t.applicationCustomSettings&&t.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),t.wopiPrecheckInfo.ReadOnly&&(o.readOnly="1"),t.sessionInformation.UIEmbed&&(o.uiEmbed="1"),t.applicationCustomSettings&&t.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),i.isSingleStepBoot?(i.bootFlowType===q.unifiedSingleFlush&&(t.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=i.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(t.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(m(window.location.href)),t.isCreateNew&&(o.new="1",t.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),t.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(t.wopiPrecheckInfo.PreseededSessionKey)),t.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(t.wopiPrecheckInfo.PreseededWacSessionId)),t.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=t.wopiPrecheckInfo.RequestedCallThrottling),t.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=t.wopiPrecheckInfo.ClientThrottlingProtection),function(t){var i=t.featureManager.isFeatureEnabled(W.Qi),e=t.applicationUrl;return(v(e)||w(e))&&t.settingsManager.getValue(x.wt,!1)||i;return!1}(t)&&(o.instantshell="1"),t.applicationCustomSettings&&t.applicationCustomSettings.additionalApplicationParameters&&(o=r(r({},t.applicationCustomSettings.additionalApplicationParameters),o)),t.rebootOverrideData&&t.rebootOverrideData.queryOverrides&&(o=r(r({},o),t.rebootOverrideData.queryOverrides)),function(t,i,e,n,o){var s=function(t){var i={},e=t.indexOf("?");return-1===e||e===t.length-1||t.substring(e+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(t){if(t){var e=t.indexOf("=");-1!==e&&e!==t.length-1&&(i[t.substring(0,e).toLowerCase()]=t.substring(e+1))}})),i}(t);"teams"!==s.uih&&"owa"!==s.uih||(s.hhdr="1");var a=t.indexOf("?"),c=-1===a?t.concat("?"):t.substring(0,a+1);i.UiLocale&&(s.ui=encodeURIComponent(i.UiLocale));i.DataLocale&&(s.rs=encodeURIComponent(i.DataLocale));i.HostSessionId&&(s.hid=encodeURIComponent(i.HostSessionId));i.DisableChat&&(s.dchat="1");i.SessionContext&&(s.sc=encodeURIComponent(i.SessionContext));e&&e.WopiSrc&&(s.wopisrc=encodeURIComponent(e.WopiSrc));i.CookieCompliant&&(s.mscc="1");n&&(n.entryPoint&&(s.wdorigin=encodeURI(n.entryPoint)),n.userClickTime&&(s.wdhostclicktime=n.userClickTime.toString()));s=r(r(r({},s),i.WdParams),o);var u={};for(var h in s)u[h.toLowerCase()]=s[h];var f=[];for(var h in u)u[h]&&f.push(h.concat("=",u[h]));return c.concat(f.join("&"))}(n,t.sessionInformation,t.wopiInfo,t.diagnostics.HostInitializeDiagnostics,o)}function X(t){return t.AccessTokenExpiry?t.AccessTokenExpiry.getTime().toString():"0"}!function(t){t.bootWithoutWopiInfo="",t.unifiedSingleFlush="Unified_SingleFlush",t.unifiedIrmEnabled="Unified_IrmEnabled",t.unifiedViewActionUrl="Unified_ViewActionUrl",t.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",t.forceSingleStepBoot="Force_SingleStepBoot",t.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",t.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect"}(q||(q={}));var Z,$,K,Q,Y,tt,it,et=!1,nt=!1,ot=["xlviewerinternal.aspx","xlembed.aspx"],rt=0;function st(t,i,e,n){K=t,Q=i,tt=e,it=n,at(),setTimeout((function(){K.ULS.u(593589517,h.P,c.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver heartbeat signal called after ms: 3000")}),3e3),setTimeout((function(){!function t(){if(rt>=3)return void K.ULS.u(595350870,h.P,c.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Max Limit reached for retry attempts3");if(at(),et)setTimeout((function(){(!nt||rt>0)&&K.ULS.u(595350872,h.P,c.Info,"ExcelLandingPageObserver: checkSecondFlushArrived Second Flush status: "+nt+" after first flush retry attempt: "+rt)}),$);else{if(rt+=1,K.ULS.u(595350871,h.P,c.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Retry Request: "+rt),tt.isFeatureEnabled(W.Zi)&&1===rt)document.getElementById(Q).submit();setTimeout((function(){t()}),Z)}}()}),Z),tt.isFeatureEnabled(W.Xi)&&(window.localStorage?window.addEventListener("offline",ct):K.ULS.u(593589518,h.P,c.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver localstorage not supported by Browser. Skip saving in cache")),K.ULS.u(594622165,h.P,c.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver called with OfflineTelemetry: "+tt.isFeatureEnabled(W.Xi))}function at(){Z=3750,$=6e3;var t=function(){if(window&&window.navigator){var t=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return t?t.effectiveType:void 0}}();if(void 0!==t)switch(void 0!==Y&&Y!==t&&K.ULS.u(595350873,h.P,c.Info,"ExcelLandingPageObserver: initializeTimeOutIntervals previousConnection: "+Y+" currentConnection: "+t+" First Flush: "+et+" Second Flush:"+nt),Y=t,t){case"4g":Z=3750,$=6e3;break;case"3g":Z=5e3,$=8e3;break;case"2g":Z=1e4,$=24e3;break;case"slow-2g":Z=2e4,$=4e4}}function ct(){try{var t=(new Date).getTime(),i="OfflineMode_"+it+"_"+t,e={"Sessionid:":it,OfflineTime:t};localStorage.setItem(i,JSON.stringify(e))}catch(t){K.ULS.u(593589522,h.P,c.Error,"ExcelLandingPageObserver:logOfflineModeTelemetry exception during saving into cache exception: "+y(t))}}var ut;function ht(t,i,e,n,o,r,s,a){var c=function(t,i,e,n,o){var r=t.ownerDocument.createElement("iframe");return r.id=i,r.name=i,r.src="",r.title="Office on the web Frame",r.width="100%",r.height="100%",r.marginWidth="0",r.marginHeight="0",r.style.left="0",r.style.top="0",r.style.right="0",r.style.bottom="0",r.style.display="block",r.style.position="absolute",r.style.backgroundColor="transparent",r.style.border="none",r.frameBorder="0",r.setAttribute("allowfullscreen","true"),r.setAttribute("allowTransparency","true"),n&&r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-popups-to-escape-sandbox"),r.setAttribute("allow","microphone "+e+"; camera "+e+";"),o&&r.addEventListener("load",o,{once:!0}),r}(t,r||"WebApplicationFrame",m(i),n);!function(t,i){i[ut.wacFrameComputedHeightPx]=String(t.offsetHeight),i[ut.wacFrameComputedWidthPx]=String(t.offsetWidth),i[ut.wacFrameTouchMode]=String(D()),i[ut.wacFrameHighContrast]=String(function(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(t){return!1}}()),i[ut.wacFrameForceSLR]=String(function(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(t){return!1}}())}(c,e);var u=function(t,i,e,n){var o=t.ownerDocument,r=o.createElement("form");for(var s in r.id=i+"_form",r.name=i+"_form",r.action=e,r.target=i,r.method="POST",n){var a=o.createElement("input");a.type="hidden",a.name=s,a.value=n[s],r.appendChild(a)}return r}(t,"WebApplicationFrame",i,e);return function(t){return ot.some((function(i){return-1!==t.indexOf(i)}))}(i)&&st(s,u.id,o,a),function(t,i,e){t.appendChild(i),t.appendChild(e),e.submit()}(t,c,u),c}function ft(t,i){var e={};if(t.wopiInfo&&(e[ut.wacFrameAccessToken]=t.wopiInfo.AccessToken,e[ut.wacFrameAccessTokenTtl]=X(t.wopiInfo)),t.wopiPrecheckInfo.BundleInfo&&t.wopiPrecheckInfo.BundleInfo.Url&&t.wopiPrecheckInfo.BundleInfo.Url.length>0)if(e[ut.wacFrameBundleSource]=t.wopiPrecheckInfo.BundleInfo.Url,null!=t.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==t.wopiPrecheckInfo.BundleInfo.BundleStaleness){var n=t.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();i.ULS.u(593503580,h.P,c.Info,"Content bundle staleness - "+n),e[ut.wacFrameBundleStaleness]=n}else i.ULS.u(593503581,h.P,c.Info,"Content bundle staleness does not exist");if(t.wopiPrecheckInfo.FileGetUrl&&(e[ut.wacFrameFileGetUrl]=t.wopiPrecheckInfo.FileGetUrl),t.wopiPrecheckInfo.FileName){var o=t.wopiPrecheckInfo.FileName.lastIndexOf(".");if(-1!==o){var r=t.wopiPrecheckInfo.FileName.substring(o+1);r&&(e[ut.wacFrameFileExtension]=r)}e[ut.wacFrameFileName]=t.wopiPrecheckInfo.FileName}return t.newFileTemplateSource&&t.newFileTemplateSource.FileSize?e[ut.wacFrameFileSize]=t.newFileTemplateSource.FileSize.toString():t.wopiPrecheckInfo.FileSize&&(e[ut.wacFrameFileSize]=t.wopiPrecheckInfo.FileSize.toString()),t.sessionInformation.UserId&&(e[ut.wacFrameUserId]=t.sessionInformation.UserId),t.sessionInformation.OwnerId&&(e[ut.wacFrameOwnerId]=t.sessionInformation.OwnerId),t.sessionInformation.SessionContext&&(e[ut.wacFrameSessionContext]=t.sessionInformation.SessionContext),t.diagnostics&&(e[ut.wacFrameHostDiagnostics]=JSON.stringify(t.diagnostics)),e[ut.wacFrameFeatureStatus]=function(t,i){var e={};if(Object.keys(W).forEach((function(i){var n=t.isFeatureEnabled(W[i]);void 0!==n&&(e[W[i]]=n?"1":"0")})),i&&i.wdFlights)for(var n=i.wdFlights.toLowerCase(),o=0,r=n.split(",");o<r.length;o++){var s=r[o];"et-treatment"!==s&&"et-control"!==s||(e[W.Vi]="et-treatment"===s?"1":"0")}return JSON.stringify(e)}(t.featureManager,t.sessionInformation.WdParams),t.applicationCustomSettings&&t.applicationCustomSettings.HostUIControls&&(e[ut.wacFrameHostUIControlOverrides]=JSON.stringify(t.applicationCustomSettings.HostUIControls)),e[ut.wacFrameHighDpi]=String(window.devicePixelRatio>1.24),e[ut.wacSoftBlockedBrowser]=String(M()),e[ut.wacFrameHostName]=t.sessionInformation.HostName,t.newFileTemplateSource&&(e[ut.wacFrameTemplateUrl]=t.newFileTemplateSource.FileGetUrl),t.newFileTemplateSource&&t.newFileTemplateSource.DocUniqueId?e[ut.wacFrameDocID]=t.newFileTemplateSource.DocUniqueId:t.wopiPrecheckInfo.DocUniqueId&&(e[ut.wacFrameDocID]=t.wopiPrecheckInfo.DocUniqueId),t.newFileTemplateSource&&t.newFileTemplateSource.ETag?e[ut.wacFrameETag]=t.newFileTemplateSource.ETag:t.wopiPrecheckInfo.ETag&&(e[ut.wacFrameETag]=t.wopiPrecheckInfo.ETag),e}!function(t){t.wacFrameAccessToken="access_token",t.wacFrameAccessTokenTtl="access_token_ttl",t.wacFrameBundleSource="bundleSrc",t.wacFrameBundleStaleness="bundleStaleness",t.wacFrameFileGetUrl="fileGetUrl",t.wacFrameFileExtension="fileExtension",t.wacFrameFileSize="fileSize",t.wacFrameFileName="fileName",t.wacFrameOwnerId="owner_id",t.wacFrameUserId="user_id",t.wacFrameSessionContext="sc",t.wacFrameHostDiagnostics="host_diagnostics",t.wacFrameHighDpi="highDpi",t.wacFrameComputedHeightPx="frameHeightPx",t.wacFrameComputedWidthPx="frameWidthtPx",t.wacFrameHostFlights="hostFlights",t.wacFrameHighContrast="highContrast",t.wacFrameTouchMode="touchMode",t.wacFrameHostUIControlOverrides="huictrls",t.wacSoftBlockedBrowser="softBlockedBrowser",t.wacFrameHostName="hostName",t.wacFrameFeatureStatus="feature_status",t.wacFrameTemplateUrl="templateUrl",t.wacFrameETag="ETag",t.wacFrameDocID="DocID",t.wacFrameForceSLR="forceSLR"}(ut||(ut={}));var lt=function(){function t(t,i,e,n,o,r,s,a){if(this.ee=!1,this.ne=void 0,this.oe=[],void 0===i)throw new TypeError("bootFlowInfo");if(i.isSingleStepBoot&&void 0===t.wopiInfo)throw new TypeError("wopiInfo");this.re=t,this.se=i,this.ae=o,this.ce=r,this.ue=s,this.he=a,this.fe=e,this.le=n,this.le.wopiInitializeTime=Date.now()}return t.prototype.Boot=function(){var t=this;this.ae.ULS.u(596444241,h.P,c.Info,"Initializing WAC frame");var i=G(this.re,this.se,!0),e=ft(this.re,this.ae);if(this.re.settingsManager.getValue(x.Tt,!1)&&this.beginUlsHeartBeat(this.re.settingsManager.getValue(x.Et,v(i)?3e3:5e3)),this.ce.registerMessagePayloadHandler(R.Ut,(function(i){t.handleWacAppBootState(i)})),this.ce.registerMessagePayloadHandler(R.hi,(function(i){t.handleTrustFrameRequest(i)})),this.se.ignoreWacFramePostMessages||this.populateWacFrameCompletedAndFailedHandlers(),this.bootWacFrame(i,e),this.se.ignoreWacFramePostMessages){var n=this.getApplicationState();this.ue(n)}return this.ae.ULS.u(595661019,h.P,c.Info,"Created Wac Frame"),this.de},t.prototype.bootWacFrame=function(t,i){this.fe.officeFrameCreateTime=Date.now(),this.le.frameCreateStartTime=this.fe.officeFrameCreateTime;var e=!(!this.re.sessionInformation.WdParams||!this.re.sessionInformation.WdParams.wdSandboxWacFrame),n=this.re.applicationCustomSettings&&this.re.applicationCustomSettings.appFrameName;this.de=ht(this.re.container,t,i,e,this.re.featureManager,n,this.ae,this.fe.officeSessionId),this.ce.activate(this.de)},t.prototype.populateWacFrameCompletedAndFailedHandlers=function(){var t=this;this.ce.registerMessagePayloadHandler(R.Rt,(function(i){t.handleWacCompleteMessage(i)})),this.ce.registerMessagePayloadHandler(R.At,(function(i){t.handleWacFailureMessage(i)})),this.oe.push(window.setTimeout((function(){return t.timeoutWacAppCompleteOrFail()}),15e3)),this.oe.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(1)}),this.re.settingsManager.getValue(x.St,6e4))),this.oe.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(2)}),this.re.settingsManager.getValue(x.bt,18e4)))},t.prototype.handleWacAppBootState=function(t){var i=t&&t.state?t.state:"unknown";this.ae.ULS.u(595714271,h.P,c.Info,"WAC Boot App state:["+i+"]"),function(t){"PageLoadSkeleton Presented"===t?et=!0:"BootstapContext Recieved"===t&&(nt=!0)}(i)},t.prototype.handleTrustFrameRequest=function(t){var i=window===window.top||window.parent===window.top&&window.location.origin===window.top.origin;this.ae.ULS.u(595653903,h.P,c.Info,"Top frame is trusted: "+i),this.ce.sendPostMessage(this.de.contentWindow,P.hi,{isTopFrameTrusted:i})},t.prototype.handleWacCompleteMessage=function(t){if(this.ae.ULS.u(595986314,h.P,c.Info,"Received wac complete message"),this.ae.ULS.flush(),this.endUlsHeartBeat(),this.clearLogTimers(),function(){if(tt.isFeatureEnabled(W.Xi))if(window.localStorage)for(var t=0;t<localStorage.length;t+=1)try{var i=localStorage.key(t);if("OfflineMode_"===i.substring(0,"OfflineMode_".length)){var e=localStorage.getItem(i);K.ULS.u(593589520,h.P,c.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry Message"+e),localStorage.removeItem(i)}}catch(t){K.ULS.u(593589521,h.P,c.Error,"ExcelLandingPageObserver:uploadOfflineModeTelemetry exception during loading from cache. Exception: "+y(t))}else K.ULS.u(593589519,h.P,c.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry localstorage not supported by Browser. Skip uploading")}(),this.ee)this.ae.ULS.u(596444234,h.P,c.Info,"Received multiple wac complete or failure messages");else{this.ee=!0,this.sendWacPostMessage(P._i,{}),H(this.fe,t);var i=this.getApplicationState();this.ue(i),this.sendJsApiDiagnosticsToWacFrame(this.re.diagnostics)}},t.prototype.getApplicationState=function(){return{innerApplicationFrame:this.de}},t.prototype.handleWacFailureMessage=function(t){if(this.ae.ULS.u(595986315,h.P,c.Error,"Received wac failed message"),this.ae.ULS.flush(),this.endUlsHeartBeat(),this.clearLogTimers(),this.ee)this.ae.ULS.u(596444235,h.P,c.Info,"Received multiple wac complete or failure messages");else{this.ee=!0,this.sendWacPostMessage(P.bi,{});var i={errorType:F.WacFailed,errorObject:{}};t&&(i.errorObject=t.Error,this.le.error=i),this.he(i)}},t.prototype.timeoutWacAppCompleteOrFail=function(){this.ee||this.ae.ULS.u(596444236,h.P,c.Warning,"Timeout. SessionTraces:"+JSON.stringify(this.le))},t.prototype.clearLogTimers=function(){for(var t=0;t<this.oe.length;t+=1)this.oe[t]&&window.clearTimeout(this.oe[t]);this.oe=[]},t.prototype.logWarningOnNoAppComplete=function(t){this.ee||(this.ae.ULS.u(594901218,h.P,c.Warning,"Boot_NotComplete_"+(t||"Final")),this.ae.ULS.flush())},t.prototype.sendJsApiDiagnosticsToWacFrame=function(t){this.sendWacPostMessage(P.xi,t)},t.prototype.beginUlsHeartBeat=function(t){var i=this;this.pe=Date.now(),this.ne=window.setInterval((function(){i.ae.ULS.u(595724178,h.P,c.Info,"Boot_HeartBeat"),Date.now()-i.pe>i.re.settingsManager.getValue(x.gt,3e5)&&(i.logWarningOnNoAppComplete(),i.endUlsHeartBeat())}),t)},t.prototype.endUlsHeartBeat=function(){this.ne&&(window.clearInterval(this.ne),this.ne=void 0)},t.prototype.sendWacPostMessage=function(t,i){this.de&&this.de.contentWindow?this.ce.sendPostMessage(this.de.contentWindow,t,i):this.ae.ULS.u(595955718,h.P,c.Info,"Attempted to send postmessage: "+t)},t}(),dt=!1,pt=!1;function vt(){dt=!1}function wt(t,i,e,n,o,r){if(i.ULS.u(595714433,h.P,c.Info,"Starting disposing the application. unloadApp:"+t+"; disposed:"+dt+"; unloading:"+pt),dt||pt&&t)i.ULS.u(595714908,h.P,c.Info,"Application is already disposed or unloading");else{var s,a={logger:i,postMessenger:e,innerApplicationFrame:n,onDisposed:o,unloadTimeoutInMs:r||1e3,forceAppUnload:!1,disposeStartTime:Date.now(),appUnloadTimedOut:!1};if(t&&n)return pt=!0,a.forceAppUnload=!0,(s=a).forceAppUnloadStartTime=Date.now(),s.logger.ULS.u(595855490,h.P,c.Info,"Sending postmessage to unload app"),s.logger.ULS.flush(),s.postMessenger.registerMessagePayloadHandler(R.fi,(function(t){return function(t,i){t.forceAppUnloadEndTime=Date.now(),t.appUnloadedMessageValues=i,t.logger.ULS.u(595855491,h.P,c.Info,"AppUnloaded received from app"),mt(t)}(s,t)})),s.postMessenger.sendPostMessage(s.innerApplicationFrame.contentWindow,P.Ji,{}),void window.setTimeout((function(){return function(t){!pt&&dt||(t.appUnloadTimedOut=!0,t.logger.ULS.u(595855492,h.P,c.Info,"ApplicationUnload timed out, forcing dispose"),mt(t))}(s)}),s.unloadTimeoutInMs);mt(a)}}function mt(t){if(!dt)try{dt=!0,pt=!1,function(t){if(!t.innerApplicationFrame)return;t.innerApplicationFrame.src="about:blank",window.setTimeout((function(){t.innerApplicationFrame&&t.innerApplicationFrame.parentElement&&t.innerApplicationFrame.parentElement.removeChild(t.innerApplicationFrame)}),0)}(t),function(t){var i={disposeStartTime:t.disposeStartTime,disposeEndTime:Date.now(),forceAppUnload:t.forceAppUnload,appUnloadTimedOut:t.appUnloadTimedOut};t.forceAppUnloadStartTime&&(i.appUnloadStartTime=t.forceAppUnloadStartTime);t.forceAppUnloadEndTime&&(i.appUnloadEndTime=t.forceAppUnloadEndTime);if(t.appUnloadedMessageValues){var e=t.appUnloadedMessageValues;void 0!==e.sendBeaconFlight&&(i.sendBeaconFlight=e.sendBeaconFlight),void 0!==e.sendBeaconSupported&&(i.sendBeaconSupported=e.sendBeaconSupported);var n=Number(e.hostMessageReceived);t.forceAppUnloadStartTime&&!isNaN(n)&&(i.hostToAppPostMessageLatency=n-t.forceAppUnloadStartTime);var o=Number(e.appMessageSent);!isNaN(o)&&t.forceAppUnloadEndTime&&(i.appToHostPostMessageLatency=t.forceAppUnloadEndTime-o);var r=Number(e.appUnloadStart),s=Number(e.appUnloadEnd);if(isNaN(r)||isNaN(s)||(i.appUnloadLatency=s-r),e.serverTimings){var a=e.serverTimings;for(var u in a)i["st-"+u.toString()]=a[u]}}t.logger.ULS.u(595855436,h.P,c.Info,"App disposed "+JSON.stringify(i)),t.logger.ULS.flushOnClose()}(t),t.onDisposed&&t.onDisposed()}catch(i){t.logger.ULS.u(595714434,h.P,c.Error,"Error disposing: "+y(i))}}var gt,St,bt=function(){function t(t,i,e,n,o,r,s,a,c){var u=this;this.ve=!1,this.we=!1,this.me=!1,this.ge=null,this.Se=!0,this.be=!1,this._e=!1,this.re=t,this.se=i,this.fe=e,this.ae=n,this.ce=o,this.ue=a,this.he=c,this.le=r,this.le.wopiPendingInitializeTime=Date.now(),this.ye=s,vt(),window.setTimeout((function(){return u.timeoutCompleteOrFail()}),5e3)}return t.prototype.Complete=function(t,i){if(this.me)this.ae.ULS.u(596444184,h.P,c.Warning,"Complete called after Complete/Fail already called");else{this.ae.ULS.u(596444185,h.P,c.Info,"Complete called."),this.me=!0,this.Ie=t,this.le.wopiPendingCompleteTime=Date.now();try{this.se.isSingleStepBoot?this.completeSingleStepFlow():this.completeTwoStepFlow(),this.ve&&this.sendWacPostMessage(P.Ai,{}),this.updateBrowserHistoryForCreateNew(i)}catch(t){this.ae.ULS.u(596444186,h.P,c.Error,"Unexpected script error: "+y(t))}finally{this.ae.ULS.flush()}}},t.prototype.Fail=function(t){this.me?this.ae.ULS.u(596444187,h.P,c.Warning,"Fail called after Complete/Fail already called"):(this.ae.ULS.u(596444188,h.P,c.Warning,"Fail called. Reason: "+(t?JSON.stringify(t):"N/A")),this.me=!0,this.se.isSingleStepBoot?this.failSingleStepFlow():this.failTwoStepFlow(t),this.ae.ULS.flush())},t.prototype.Dispose=function(t,i,e){var n=this;wt(t||!1,this.ae,this.ce,this.de,(function(){delete n.de,i&&i(),n.ye(),n.ce.dispose()}),e)},t.prototype.Boot=function(){this.se.isSingleStepBoot||this.bootTwoStepFlow(),this.ae.ULS.flush()},t.prototype.bootTwoStepFlow=function(){var t=this;this.ae.ULS.u(596444231,h.P,c.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout((function(){return t.timeoutWacReadyMessage()}),5e3),this.populateWacFrameEventHandlersForTwoStepFlow();var i=new lt(this.re,this.se,this.fe,this.le,this.ae,this.ce,this.ue,this.he);this.de=i.Boot()},t.prototype.populateWacFrameEventHandlersForTwoStepFlow=function(){var t=this;this.ce.registerMessagePayloadHandler(R.qt,(function(i){t.handleWacReadyMessage(i)})),this.ce.registerMessagePayloadHandler(R.Vt,(function(i){t.handleWacFrameLoadedMessage(i)})),this.ce.registerMessagePayloadHandler(R.ri,(function(i){t.handleWacFrameSessionCompleteAckMessage(i)}))},t.prototype.completeTwoStepFlow=function(){var t={ParallelizeStartSession:this.Se,WacFrameIsLoaded:this.ve,WacAcceptsStartSessionComplete:this.be};this.ae.ULS.u(596444232,h.P,c.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(t)),!this.Se||this.ve&&!this.be?this.ve&&this.sendWopiInfoToWacFrame():this.makeStartSessionRequest()},t.prototype.completeSingleStepFlow=function(){this.ae.ULS.u(596444233,h.P,c.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),this.re.wopiInfo=this.Ie;var t=new lt(this.re,this.se,this.fe,this.le,this.ae,this.ce,this.ue,this.he);this.de=t.Boot()},t.prototype.failTwoStepFlow=function(t){this.ve?(this.ae.ULS.u(595968481,h.P,c.Warning,"Fail called and wacframe is able to accept postmessages"),this.sendFailurePostMessageToWacFrame(t)):(this.ae.ULS.u(595968482,h.P,c.Warning,"Fail was called on the session prior to WacReady."),this.ge=t)},t.prototype.sendFailurePostMessageToWacFrame=function(t){this.ae.ULS.u(596444189,h.P,c.Warning,"Fail called, sending the failure postmessage to IFrame"),this.sendWacPostMessage(P.Ii,t)},t.prototype.failSingleStepFlow=function(){this.ae.ULS.u(596444190,h.P,c.Warning,"Fail called during single step boot, calling host failure callback..."),this.he({errorType:F.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},t.prototype.timeoutWacReadyMessage=function(){this.ve||(this.ae.ULS.u(596444191,h.P,c.Warning,"Timeout Wac Ready"),this.he({errorType:F.TimeoutWacReady,errorObject:void 0}))},t.prototype.timeoutCompleteOrFail=function(){this.me||(this.le.timeoutCompleteOrFail=Date.now(),this.ae.ULS.u(596444192,h.P,c.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(this.le)))},t.prototype.timeoutWacSessionCompletionMessageAck=function(t,i,e){this._e||(this.ae.ULS.u(596444193,h.P,c.Info,"SessionCompletion timed out with no ack."),this.sendSessionCompletionMessageWithRetryHelper(t,i,e+1))},t.prototype.handleWacReadyMessage=function(t){if(this.le.readyMessageReceiveTime=Date.now(),this.sendWacPostMessage(P.Ti,{}),this.ve)this.ae.ULS.u(596444194,h.P,c.Info,"Received multiple ready messages - frame is already loaded.");else{this.ve=!0,this.be=t&&t.CanAcceptStartSessionComplete;var i={AcceptStartSessionComplete:this.be,ParallelizeStartSession:this.Se,StartSessionResponse:null!=this.Oe,WopiInfo:null!=this.Ie};this.ae.ULS.u(596444195,h.P,c.Info,"HandleWacReadyMessage - "+JSON.stringify(i)),this.me&&(this.ge?this.sendFailurePostMessageToWacFrame(this.ge):this.sendWacPostMessage(P.Ai,{})),this.Se&&this.be?this.Oe&&this.startSessionCompleted():this.Ie&&this.sendWopiInfoToWacFrame(),H(this.fe,t)}},t.prototype.handleWacFrameLoadedMessage=function(t){H(this.fe,t)},t.prototype.handleWacFrameSessionCompleteAckMessage=function(t){this._e=!0,this.le.sessionCompleteAckReceivedTime=Date.now()},t.prototype.sendWacPostMessage=function(t,i){this.de&&this.ce.sendPostMessage(this.de.contentWindow,t,i)},t.prototype.sendSessionCompletionMessageWithRetry=function(t,i){this.sendSessionCompletionMessageWithRetryHelper(t,i,1)},t.prototype.sendSessionCompletionMessageWithRetryHelper=function(t,i,e){var n=this;if(e>3)this.ae.ULS.u(596444224,h.P,c.Error,"Attempted to call complete, but received no ack from the frame. Time: "+Date.now());else{this.ae.ULS.u(596444225,h.P,c.Info,"Sending completion message to frame. Attempt number: "+e+", Time: "+Date.now());var o=Date.now();1===e&&(this.Oe&&this.Oe.Diagnostics&&(this.Oe.Diagnostics.completeMessageCreateTime=o),this.le.completeMessageCreateTime=o),i.Diagnostics.completeMessageSendTime=o,this.le.completeMessageSendTime=o,this.sendWacPostMessage(t,i),window.setTimeout((function(){return n.timeoutWacSessionCompletionMessageAck(t,i,e)}),1e3)}},t.prototype.makeStartSessionRequest=function(){var t=this;this.ae.ULS.u(596444226,h.P,c.Info,"Making parallelized startSession request.");var i=this.buildStartSessionUrl(this.Ie),e={"Content-Type":"application/x-www-form-urlencoded"},n="access_token="+encodeURIComponent(this.Ie.AccessToken)+"&access_token_ttl="+encodeURIComponent(X(this.Ie));this.le.startSessionStartTime=Date.now(),function(t,i,e,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",t),e)o.setRequestHeader(r,e[r]);o.send(i)}(i,n,e,(function(i){return t.onStartSessionRequestCompleted(i)}))},t.prototype.onStartSessionRequestCompleted=function(t){if(this.le.startSessionCompleteTime=Date.now(),this.le.startSessionResponseStatus=t.status,this.Oe={StartSessionResponse:{RequestStatus:t.status,ResponseText:t.responseText},Diagnostics:{wopiPendingInitializeTime:this.le.wopiPendingInitializeTime,wopiPendingCompleteTime:this.le.wopiPendingCompleteTime,startSessionStartTime:this.le.startSessionStartTime,startSessionCompleteTime:this.le.startSessionCompleteTime,readyMessageReceiveTime:this.le.readyMessageReceiveTime}},this.ae.ULS.u(596444227,h.P,c.Info,"StartSession request completed with status code: "+this.Oe.StartSessionResponse.RequestStatus+", Time: "+Date.now()),this.ve&&this.be)this.startSessionCompleted();else{var i={WacFrameIsLoaded:this.ve,InitializeCompleted:this.we};this.ae.ULS.u(596444228,h.P,c.Info,"StartSessionCompleted not called - "+JSON.stringify(i))}},t.prototype.sendWopiInfoToWacFrame=function(){if(!this.we){this.we=!0,this.ae.ULS.u(596444229,h.P,c.Info,"Sending wopi info to the frame.");var t={WopiDetails:{WopiSrc:this.Ie.WopiSrc,AccessToken:this.Ie.AccessToken,AccessTokenTtl:X(this.Ie)},Diagnostics:{wopiPendingInitializeTime:this.le.wopiPendingInitializeTime,wopiPendingCompleteTime:this.le.wopiPendingCompleteTime,readyMessageReceiveTime:this.le.readyMessageReceiveTime}};this.sendSessionCompletionMessageWithRetry(P.Ui,t)}},t.prototype.startSessionCompleted=function(){200===this.Oe.StartSessionResponse.RequestStatus?this.we||(this.we=!0,this.sendSessionCompletionMessageWithRetry(P.Bi,this.Oe)):this.sendWopiInfoToWacFrame()},t.prototype.buildStartSessionUrl=function(t){var i=this.re.applicationBasePath+"wordeditorstartsession.ashx",e=G(this.re,this.se,!1);return i=b(i+="?"+e.substring(e.indexOf("?")+1),"WOPISrc",encodeURIComponent(t.WopiSrc)),i=b(i,"build",encodeURIComponent(a())),i=b(i,"WacUserType",encodeURIComponent("WOPI")),this.re.wopiPrecheckInfo.FileGetUrl&&(i=b(i,"fileGetUrlPresent","1")),i},t.prototype.updateBrowserHistoryForCreateNew=function(t){if(this.re.isCreateNew){if(!t||!t.NewFilePath)return void this.ae.ULS.u(596444230,h.P,c.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",t.NewFilePath),t.UpdatedPageTitle&&(document.title=t.UpdatedPageTitle)}},t}();!function(t){t.blurFocus="blurFocus",t.boot="boot",t.continueAccessibilityLoop="continueAccessibilityLoop",t.dispose="dispose",t.grabFocus="grabFocus",t.rename="rename",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.switchMode="switchMode"}(gt||(gt={})),function(t){t.AckExpected="ackExpected",t.ErrorObject="errorObject",t.ErrorType="errorType",t.IsDisabled="isDisabled",t.NewPageNumber="newPage",t.NewZoomLevel="newLevel",t.PageCount="pageCount"}(St||(St={}));var _t=function(){function t(t,i){var e=this;if(this.Ee=!1,this.Te=function(t){return e.handleWacFramePostMessage(t)},this.xe=!1,this.Ce=!1,this.Ae=!1,this.Ue={},!t)throw new Error("Missing origin for PostMessageHandler");this.Ce=v(t),this.Ae=w(t),this.ae=i,this.setOrigin(t)}return t.prototype.registerMessagePayloadHandler=function(t,i){if(this.Ue[t])throw new Error("Duplicate registration!");this.Ue[t]=i},t.prototype.removeMessageHandler=function(t){delete this.Ue[t]},t.prototype.sendPostMessage=function(t,i,e){if(t){this.ae.ULS.u(596464334,h.P,c.Info,"Sending message: "+i);var n={MessageId:i,SendTime:Date.now(),Values:e};this.sendPostMessageInternal(t,JSON.stringify(n),this.Re)}else this.ae.ULS.u(595948308,h.P,c.Info,"Missing target for SendPostMessage")},t.prototype.activate=function(t,i){void 0===i&&(i=!1),this.de=t,this.xe=i,this.Ee||(window.addEventListener("message",this.Te,!1),this.Ee=!0)},t.prototype.postMessageForCommand=function(t,i,e){var n;(n=i===gt.sendWopiInfo?P.Di:void 0)?(this.ae.ULS.u(595702598,h.P,c.Info,"Sending message "+n+" for command "+i),this.sendPostMessage(t,n,e)):this.ae.ULS.u(595702599,h.P,c.Warning,"No mapping for command "+i)},t.prototype.dispose=function(){for(var t=0,i=Object.keys(this.Ue);t<i.length;t++){var e=i[t];delete this.Ue[e]}this.Ee&&(window.removeEventListener("message",this.Te,!1),this.Ee=!1)},t.prototype.sendAckBack=function(t,i,e){if(t){var n={MessageId:P.gi,CorrelationId:e,SendTime:Date.now()};this.ae.ULS.u(595732176,h.P,c.Info,"Sending Ack back"),t.postMessage(JSON.stringify(n),i)}else this.ae.ULS.u(595736136,h.P,c.Info,"Missing target to send Ack back")},t.prototype.handleWacFramePostMessage=function(t){var i=!1,e=!0,n="",o=!1;if(this.de&&this.de.contentWindow&&(i=!0,e=t.source===this.de.contentWindow),t.origin&&(o=(n=g(t.origin,2).toLowerCase())===this.Pe),!this.Ce&&(!this.Ae||o&&e)||this.ae.ULS.u(595730526,h.P,c.Info,"Window is available: "+i+", window is valid: "+e+", origin is valid: "+o+", expected origin: "+this.Pe+", actual origin: "+n),o&&(!this.xe||e)){var r;try{r=JSON.parse(t.data)}catch(i){return this.ae.ULS.u(596464282,h.P,c.Info,"Failed to parse event data: "+y(i)+"."),void(this.Ce&&this.ae.ULS.u(595732175,h.P,c.Info,"string"==typeof t.data?"Length of event data: "+t.data.length+". First 200 characters of event data: "+t.data.substring(0,200):"Event data: "+JSON.stringify(t.data)))}var s=r.MessageId;if(s){this.ae.ULS.u(595714715,h.P,c.Info,"Received messageId: "+s+", correlation: "+r.CorrelationId),s!==R.Rt&&s!==R.Gt||this.setOrigin(t.origin),r.Values&&r.Values[St.AckExpected]&&this.sendAckBack(t.source,t.origin,r.CorrelationId);var a=this.Ue[s];if(a){this.ae.ULS.u(596464288,h.P,c.Info,"Processing message: "+s);try{a(r.Values||{})}catch(t){this.ae.ULS.u(593773704,h.P,c.Error,"Handler error: "+y(t))}}else this.ae.ULS.u(596464289,h.P,c.Info,"No handler found for message id: "+s)}else(this.Ce||this.Ae)&&this.ae.ULS.u(595730520,h.P,c.Info,"Could not find message id")}},t.prototype.sendPostMessageInternal=function(t,i,e){t.postMessage(i,e)},t.prototype.setOrigin=function(t){var i=t.toLowerCase();this.Re&&this.Re!==i&&this.ae.ULS.u(596128131,h.P,c.Warning,"Updating origin:"+this.Re+"->"+i),this.Re=i,this.Pe=g(i,2),this.Ce=v(i),this.Ae=w(i)},t}(),yt=function(){function t(){var t=this;if(this.We=[],this.Ue=[],this.Fe=function(){return t.handleVisibilityChange()},"hidden"===document.visibilityState){var i={visibility:document.visibilityState,time:Date.now(),initialState:!0};this.We.push(i)}document.addEventListener("visibilitychange",this.Fe)}return t.prototype.RegisterEventHandler=function(t){this.Ue.push(t)},t.prototype.RemoveEventHandler=function(t){if(t){var i=this.Ue.indexOf(t);this.Ue.splice(i,1)}},t.prototype.Stop=function(){document.removeEventListener("visibilitychange",this.Fe)},t.prototype.GetVisibilityChangeEvents=function(){return this.We},t.prototype.Dispose=function(){this.Stop(),this.Ue=[],this.We=[]},t.prototype.handleVisibilityChange=function(){var t={visibility:document.visibilityState,time:Date.now(),initialState:!1};this.We.push(t);for(var i=0,e=this.Ue;i<e.length;i++){var n=e[i];n&&n(t)}},t}();var It=function(){function t(){this.Ne=[]}return t.prototype.add=function(t){t&&this.Ne.push(t)},t.prototype.remove=function(t){if(t){var i=this.Ne.indexOf(t);i>-1&&this.Ne.splice(i,1)}},t.prototype.removeAll=function(){this.Ne=[]},t.prototype.dispatch=function(t,i){this.Ne.forEach((function(e){try{e(t)}catch(t){i&&i(t)}}))},t}(),Ot=function(){function t(t,i,e){var n=this;this.ke=0,this.De=function(){var t=new XMLHttpRequest;t.open("GET",n.Me),t.responseType="json",t.timeout=5e3,t.send(),t.onload=function(){if(200===t.status&&t.response?(n.setSettingsOnIdle(t.response),n.ke=0):(n.ae.ULS.u(592836771,h.P,c.Error,"Fetch settings error. Status: "+t.status+", curErrors: "+n.ke),n.ke+=1),!(n.ke>7)){var i=n.getValue(x.It,3e5);n.ke>3&&(i+=(n.ke-3+1)*(i/2)),n.Le=window.setTimeout(n.De,i)}}},this.Be="Prod"+t+"Settings",this.Me="AppSettingsHandler.ashx?app="+t+"&usid="+i+"&build="+a(),this.ae=e,this.He=new It,this.getCurrentSettings()}return t.prototype.initializePeriodicFetch=function(t){v(t)&&(this.Be=this.Be.replace("Prod","FF"),this.getCurrentSettings()),this.Me=t+this.Me,this.Le||(this.Le=window.setTimeout(this.De,3e4))},t.prototype.getValue=function(t,i){if(this.Je||this.getCurrentSettings(),!this.Je||!this.Je.hasOwnProperty(t))return i;var e=this.Je[t],n=typeof i;if(typeof e===n)return e;if("string"==typeof e){if("number"===n)return parseInt(e,10);if("boolean"===n)return"true"===e}return i},t.prototype.addSettingsChangeListener=function(t){this.He.add(t)},t.prototype.removeSettingsChangeListener=function(t){this.He.remove(t)},t.prototype.dispose=function(){this.Le&&window.clearTimeout(this.Le),this.je&&self.cancelIdleCallback(this.je),this.Le=void 0,this.je=void 0,this.Je=void 0,this.He.removeAll()},t.prototype.getCurrentSettings=function(){try{if(!window||!window.localStorage)return;var t=window.localStorage.getItem(this.Be);if(!t)return;var i=JSON.parse(t);this.updateCurrentSettings(i)}catch(t){this.ae.ULS.u(592836768,h.P,c.Warning,"Failed to get settings from localStorage: "+y(t))}},t.prototype.updateCurrentSettings=function(t){var i=this;return!!this.isValidSettings(t)&&(this.Je=t,this.He.dispatch({settingsManager:this},(function(t){i.ae.ULS.u(592836769,h.P,c.Error,"Settings listener error: "+y(t))})),!0)},t.prototype.isValidSettings=function(t){if(t&&"object"==typeof t){if(t.hasOwnProperty(x.Ot)&&!isNaN(t.timestamp))return!0;this.ae.ULS.u(592836770,h.P,c.Error,"Received invalid settings")}return!1},t.prototype.setSettingsOnIdle=function(t){var i=this;"requestIdleCallback"in window?(this.je&&self.cancelIdleCallback(this.je),this.je=window.requestIdleCallback((function(){return i.setSettings(t)}),{timeout:1e4})):window.setTimeout((function(){return i.setSettings(t)}),0)},t.prototype.setSettings=function(t){if(this.updateCurrentSettings(t)&&window&&window.localStorage){var i=JSON.stringify(t);try{window.localStorage.setItem(this.Be,i)}catch(t){this.ae.ULS.u(592836800,h.P,c.Warning,"Failed to set localStorage: "+y(t))}}},t}();function Et(t,i){return{isFeatureEnabled:function(e){return function(t,i,e){if(!i)return;try{return i(t)}catch(t){e&&e.ULS.u(594883024,h.P,c.Error,"IsFeatureEnabled callback error: "+y(t))}return}(e,t,i)}}}var Tt=["excel-boot.min.js"];var xt,Ct=function(){function t(t,i){this.ze=t,this.Ve=i}return t.prototype.GetVersion=function(){return a()},t.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},t.prototype.Prefetch=function(t){if(null!=t&&void 0!==t){var i=document.createElement("link");i.rel="prefetch";var e=t.BootstrapperUrl;".js"!==e.toString().slice(-3)&&(e+=".js"),i.href=e;var n=document.getElementsByTagName("head")[0];null!=n&&void 0!==n&&n.appendChild(i)}},t.prototype.InitializeWopiPending=function(t,i,e,n,o,s){var u,f,l,d;try{var p=Date.now();!function(t){if(void 0===t)throw new TypeError("initParams");var i=t.Container;if(void 0===i||void 0===i.appendChild)throw new TypeError("Container");var e=t.SessionInformation;if(void 0===e||void 0===e.HostName||void 0===e.HostSessionId||void 0===e.UserId)throw new TypeError("SessionInformation");var n=t.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=t.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===t.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===t.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(t),function(t){var i=t.RebootOverrideData;if(i){var e=i.mode;if(!e)throw new Error("Missing mode in RebootOverrideData");if("view"!==(e=e.toLowerCase())&&"edit"!==e)throw new Error("Unknown mode in RebootOverrideData");0,i.queryOverrides||(i.queryOverrides={}),i.queryOverrides.wdforcedmode="view"===e?"View":"Edit"}}(t);var v=void 0,w=void 0;e?v=e:t.RebootOverrideData&&!t.RebootOverrideData.isNewSession&&t.RebootOverrideData.previousSessionId?v=t.RebootOverrideData.previousSessionId:(v=(u=E())[0],w=u[1]);var g=function(t,i,e,n,o,r){void 0===r&&(r=!1),t.SessionInformation.IsCore&&(t.SessionInformation.HideViewerToolbar=!0),function(t,i){t.SessionInformation.WdParams||(t.SessionInformation.WdParams={});if(t.SessionInformation.WdParams.wd)return;i.substring(1).split("&").filter((function(i){if(0===i.indexOf("wd")){var e=i.split("=");e[0].length>2&&(t.SessionInformation.WdParams[e[0]]=e[1])}})),t.RebootOverrideData&&t.RebootOverrideData.isNewSession&&t.RebootOverrideData.previousSessionId&&(t.SessionInformation.WdParams.wdprevioussession=t.RebootOverrideData.previousSessionId)}(t,window.location.search);var s=o||new Ot("Excel",i,e);return{container:t.Container,sessionInformation:t.SessionInformation,applicationUrl:t.ApplicationUrl,wopiPrecheckInfo:t.WopiPrecheckInfo,applicationCustomSettings:t.ApplicationCustomSettings,diagnostics:{HostInitializeDiagnostics:t.Diagnostics},fnOnInitializeSuccess:t.FnOnInitializeSuccess,fnOnInitializeFailure:t.FnOnInitializeFailure,sessionId:i,applicationBasePath:B(t.ApplicationUrl),wopiInfo:t.WopiInfo,forceSingleStepBoot:r,isCreateNew:t.WopiPrecheckInfo.IsNewFile||"1"===S(t.ApplicationUrl,"new"),featureManager:n||Et(t.FnIsFeatureEnabled,e),settingsManager:s,newFileTemplateSource:t.NewFileTemplateSource,rebootOverrideData:t.RebootOverrideData}}(t,v,f=i||N(v,{remoteUlsEndpoint:B(t.ApplicationUrl)+"RemoteUls.ashx"}),o,s,this.Ve.forceSingleStepBoot);s||(g.settingsManager.addSettingsChangeListener(f.settingsChangeHandler),g.settingsManager.initializePeriodicFetch(g.applicationBasePath)),g.diagnostics.HostInitializeDiagnostics&&(g.diagnostics.HostInitializeDiagnostics.hostInitializeCallTime=p),V(f,g,w);var b,O=function(){return z(f,"OnBeforeUnload",!0)},T=function(){return z(f,"OnPageHide",!0)},x=function(){return z(f,"VisibilityChange_"+document.visibilityState,!0)},C=function(t){return function(t,i){if(t){var e=y(i);/{("isTrusted":\w{4,5})?}/.test(e)||(t.ULS.u(594895886,h.P,c.Warning,"Unhandled Error:"+e),t.ULS.flush())}}(f,t)};window.addEventListener("beforeunload",O,{capture:!0,once:!0}),window.addEventListener("pagehide",T,{capture:!0}),window.addEventListener("visibilitychange",x,{capture:!0}),window.addEventListener("error",C,{capture:!0});var A=t&&t.BootstrapperUrl;A&&(b=this.periodicPrefetch(A,f));var U=function(){g.settingsManager.dispose(),window.removeEventListener("beforeunload",O,{capture:!0}),window.removeEventListener("pagehide",T,{capture:!0}),window.removeEventListener("visibilitychange",x,{capture:!0}),window.removeEventListener("error",C,{capture:!0}),window.clearInterval(b)},P=m(t.ApplicationUrl),k=n||new _t(P,f),D=new yt,M={},L=function(t,i){var e={isSingleStepBoot:t.forceSingleStepBoot,bootFlowType:t.forceSingleStepBoot?q.forceSingleStepBoot:q.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(t.forceSingleStepBoot,e.isSingleStepBoot){var n={singleStepBootIsRequired:!0,singleStepBootReason:e.bootFlowType,irmEnabled:t.wopiPrecheckInfo.IrmEnabled,readOnly:t.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:e.ignoreWacFramePostMessages};i.ULS.u(596444182,h.P,n.irmEnabled?c.Warning:c.Info,JSON.stringify(n))}else i.ULS.u(596444183,h.P,c.Info,"Received input valid for two step flow");return e}(g,f),H=r(r({},g.diagnostics.HostInitializeDiagnostics),{officeSessionId:g.sessionId,officeBootstrapperVersion:a(),hostName:g.sessionInformation.HostName}),G=function(t,i,e,n,o,r,s,a,u){return function(f){j(t,o,r),J(o,n,c.Info),n.ULS.u(596448985,h.P,c.Info,JSON.stringify(t));var l=u(i,n,e,s,f);try{a(l,t)}catch(t){n.ULS.u(595719171,h.P,c.Error,"Exception thrown from host's success callback: "+y(t))}I(n)}}(H,g.sessionId,k,f,M,D,U,t.FnOnInitializeSuccess,this.ze),X=function(t,i,e,n,o){return function(r){j(t,e,n),J(e,i,c.Warning),i.ULS.u(596448986,h.P,c.Error,JSON.stringify({error:r,appInitDiagnostics:t}));try{o(r,t)}catch(t){i.ULS.u(595719172,h.P,c.Error,"Exception thrown from host's failure callback: "+y(t))}I(i)}}(H,f,M,D,t.FnOnInitializeFailure);if("undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}}),t.FnOnAppModeSwitched&&k.registerMessagePayloadHandler(R.Xt,t.FnOnAppModeSwitched),t.WopiPrecheckInfo.ReadOnly&&t.FnOnAppModeSwitched,A&&this.Ve.preloader&&this.Ve.preloader.shouldPreload(g.applicationUrl))try{if(function(t){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",(function(){try{for(var i=0,e=window.performance.getEntriesByType("resource");i<e.length;i++){var n=e[i],o=_(n.name);if("about:blank"!==n.name&&-1===o.indexOf("RemoteUls.ashx")&&-1===o.indexOf("mhtml:file")&&-1!==Tt.indexOf(o)){var r=JSON.stringify(n);r=r.replace(new RegExp(n.name,"g"),o),t.ULS.u(595736532,h.P,c.Info,r)}}window.performance.clearResourceTimings()}catch(i){t.ULS.u(595732049,h.P,c.Info,"ExcelPreloader.tryObserveResourceTiming: could not trace resource timing, error is: "+JSON.stringify(i))}}),{once:!0})}(f),g.featureManager.isFeatureEnabled(W.$i)){f.ULS.u(595645891,h.P,c.Info,"HTTP2 preload enabled");var Z=(l=A,d=new RegExp("(c[1-5])h?(-)"),l.replace(d,"$1h$2"));this.Ve.preloader.preload(Z,f,g.featureManager)}else this.Ve.preloader.preload(A,f,g.featureManager)}catch(t){f.ULS.u(595943884,h.P,c.Error,y(t))}var $=new bt(g,L,H,f,k,M,U,G,X);return $.Boot(),$}catch(i){return f&&(f.ULS.u(596459925,h.P,c.Error,F.AppInitError+": "+y(i)),f.ULS.flushOnClose()),void t.FnOnInitializeFailure({errorType:F.AppInitError,errorObject:i},void 0)}},t.prototype.periodicPrefetch=function(t,i){var e=this;return window.setInterval((function(){e.Prefetch({BootstrapperUrl:t}),i.ULS.u(595895774,h.P,c.Info,"Prefetching "+_(t))}),36e5)},t}();!function(t){t.BrowserEvent="BrowserEvent",t.PageChanged="PageChanged",t.ZoomChanged="ZoomChanged",t.ContentRefreshBegin="ContentRefreshBegin",t.ContentRefreshEnd="ContentRefreshEnd",t.AppClosed="UI_Close",t.UserEdit="Edit_Notification",t.FileRename="File_Rename",t.FileShare="UI_Sharing",t.ShowFileVersions="UI_FileVersions",t.UIWorkflow="UI_Workflow",t.IsDisabled="IsDisabled",t.AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.Unloaded="Unloaded",t.SwitchMode="App_SwitchMode",t.DocumentReboot="DocReboot",t.WopiInfoFromUrl="WopiInfoFromUrl",t.ModeSwitched="ModeSwitched"}(xt||(xt={}));var At=function(){function t(t,i,e,n,o){this.Ue={},this.qe=!1,this.Ge=!1,this.Xe=t,this.ae=i,this.de=o.innerApplicationFrame,this.ce=e,this.Ze=n,this.registerPostMessageHandlers(),vt()}return t.prototype.GetApplicationType=function(){throw new Error("Not implemented")},t.prototype.GetVersion=function(){return a()},t.prototype.GetSessionId=function(){return this.Xe},t.prototype.RegisterEventHandler=function(t,i){if(this.Ge)throw new Error("RegisterEventHandler is not supposed to be called");this.qe=!0,this.registerEventHandlerInternal(t,i)},t.prototype.RemoveEventHandler=function(t,i){if(this.Ge)throw new Error("RemoveEventHandler is not supposed to be called");switch(t){case xt.Unloaded:case xt.DocumentReboot:case xt.WopiInfoFromUrl:if(this.Ue[t]!==i)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ue[t];break;default:this.ce.removeMessageHandler(t)}},t.prototype.RegisterErrorHandler=function(t){},t.prototype.RemoveErrorHandler=function(t){},t.prototype.RegisterAllEventsHandler=function(t){throw new Error("RegisterAllEventsHandler is not supposed to be called")},t.prototype.PostCommand=function(t,i){this.ce.postMessageForCommand(this.de.contentWindow,t,i)},t.prototype.Dispose=function(t,i){var e=this;wt(t||!1,this.ae,this.ce,this.de,(function(){delete e.de,e.Ze(),e.ce.dispose(),e.raiseEvent(xt.Unloaded,{});for(var t=0,i=Object.keys(e.Ue);t<i.length;t++){var n=i[t];delete e.Ue[n]}}),i)},t.prototype.registerEventHandlerInternal=function(t,i){switch(t){case xt.Unloaded:case xt.DocumentReboot:case xt.WopiInfoFromUrl:if(this.Ue[t])throw new Error("Duplicate registration");this.Ue[t]=i;break;default:this.ce.registerMessagePayloadHandler(t,i)}},t.prototype.registerPostMessageHandlers=function(){this.ce.registerMessagePayloadHandler(R.Yt,this.handleDocumentRebootMessage.bind(this)),this.ce.registerMessagePayloadHandler(R.zt,this.handleWopiInfoFromUrlRequest.bind(this))},t.prototype.raiseEvent=function(t,i){var e=this.Ue[t];if(e)try{e(i||{})}catch(t){this.ae.ULS.u(593773706,h.P,c.Error,"Handler error: "+y(t))}},t.prototype.handleDocumentRebootMessage=function(t){t.previousSessionId=this.Xe,this.raiseEvent(xt.DocumentReboot,t)},t.prototype.handleWopiInfoFromUrlRequest=function(t){this.raiseEvent(xt.WopiInfoFromUrl,t)},t}();var Ut=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.$e=[],n.initResources(),n}return o(i,t),i.prototype.initResources=function(){var t;(t=[{domain:"excel",url:"Ewa"+this.Ke+".js",localized:!1,type:"script"}]).push({domain:"excel",url:"Aacorlib"+this.Qe+".js",localized:!1,type:"script"}),t.push({domain:"excel",url:"CookieCompliance.js",localized:!1,type:"script"}),t.push({domain:"excel",url:"Ewa.Strings.Wac"+this.Ke+".js",localized:!0,type:"script"}),t.push({domain:"excel",url:"EwrDefault.css",localized:!0,type:"css"}),t.push({domain:"excel",url:"excelframe.css",localized:!0,type:"css"}),t.push({domain:"excel",url:"gridRenderer"+this.Qe+".js",localized:!1,type:"script"}),this.Ye&&this.Ye.isFeatureEnabled(W.qi)&&t.push({domain:"excel",url:"adaptiveLayout"+this.Qe+".js",localized:!1,type:"script"});for(var i=0,e=t;i<e.length;i++){var n=e[i],o=this.tn;Tt.push(n.url),"/"!==o[o.length-1]&&(o+="/");var r="App_Scripts";"css"===n.type&&(r="Resources");var s="";n.localized&&(s="1033/"),o+="x/s/"+this.in+"__layouts/"+r+"/"+s+n.url,this.$e.push(o)}},i}(function(){function t(t,i){var e;this.tn=m(t),this.in=function(){var t=a();if(!t)throw new Error("Build number not available");var i=t.split(".");if(4!==i.length)throw new Error("Build number has incorrect format");return i[0]+i[2]+i[3]}(),this.Ke="",this.Qe=".min",this.en=(e=k())===U.Firefox||e===U.IE?"prefetch":"preload",this.Ye=i}return t.prototype.preloadResources=function(t){for(var i=0,e=this.$e;i<e.length;i++){var n=e[i];this.preloadResource(n,t)}},t.prototype.preloadResource=function(t,i){var e=document.createElement("link");if(e.setAttribute("crossorigin","anonymous"),e.rel=this.en,e.href=t,i){e.addEventListener("error",(function(){i.ULS.u(595719107,h.P,c.Error,"Resource failed to load: "+_(t))}))}e.setAttribute("as","script"),document.head.appendChild(e)},t}());var Rt,Pt=function(){function t(){}return t.prototype.shouldPreload=function(t){return t.toLowerCase().indexOf("_layouts/xlviewerinternal.aspx".split("/")[1])>0},t.prototype.preload=function(t,i,e){new Ut(t,e).preloadResources(i)},t}();!function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(Rt||(Rt={}));var Wt=new Ct((function(t,i,e,n,o){return new At(t,i,e,n,o)}),{forceSingleStepBoot:!0,preloader:new Pt})}});

