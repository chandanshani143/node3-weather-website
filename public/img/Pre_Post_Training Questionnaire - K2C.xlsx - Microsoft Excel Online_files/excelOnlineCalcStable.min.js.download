var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.utils=n;var i=r(2);t.ULS=i.ULS,t.TraceLevel=i.TraceLevel,t.LogCategory=i.LogCategory,t.NulLogger=i.NulLogger,t.ConsoleLogger=i.ConsoleLogger;var a=r(3);t.browserSupport=a;var o=r(4);t.perfWatch=o;var u=r(5);t.initEwaUtils=u.initEwaUtils,t.ewaUtils=u.ewaUtils;var c=r(6);t.initStopwatchFactory=c.initStopwatchFactory;var s=r(7);t.getNewGuid=s.getNewGuid},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a={};return Object.keys(n).forEach((function(t){a[t]=e(n[t],r+1)})),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(void 0),n=function(t){r=r.catch((function(r){return e(t,r)}))},i=1;i<=t;i+=1)n(i);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.resolve();for(var r=t(e[0]),n=function(n){var i=e[n];r=r.catch((function(){return t(i)}))},i=1;i<e.length;i+=1)n(i);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").body.innerHTML:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,i=0;i<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==n-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));var a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a},t.getCharIndexInTextFromPoint=function(e,t){var r=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(r=i.offset,n=null!=i.offsetNode&&null!=i.offsetNode.parentElement&&"SPAN"===i.offsetNode.parentElement.nodeName?i.offsetNode.parentElement:i.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(r=i.startOffset,n=null!=i.startContainer&&null!=i.startContainer.parentElement&&"SPAN"===i.startContainer.parentElement.nodeName?i.startContainer.parentElement:i.startContainer)}else try{var i;n=document.elementFromPoint(e,t),(i=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(n),a.setEndPoint("EndToStart",i),r=a.text.length}catch(e){return r}for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(r+=n.textContent.length);return r},t.getBoundingRectForText=function(e,t,r){function n(e,t,r){if(!e||!e.textContent)return t;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var i=e.childNodes,a=0;a<i.length&&t>=0;a+=1)t=n(i[a],t,r);return t}var i=document.createRange();return n(e,t,(function(e,t){return i.setStart(e,t)})),n(e,r,(function(e,t){return i.setEnd(e,t)})),i.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,i){return t.traceTag(e,r,n,i)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,i){return t.debugTraceTag(e,r,n,i)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,i){return t.assertTag(e,r,n,i)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,i){return t.shipAssertTag(e,r,n,i)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var i=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function i(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,a=t,o={},u=function(e,t,n){return function(e,t,r,n,a,o){i(e,"end",r);var u={sessionName:t,result:n?"success":"failure",message:o,marks:e},c=JSON.stringify(u);a(c)}(o,r,a,e,t,n)};return o.start=0,{mark:function(e){return function(e){return i(o,e,a)}(e)},end:function(e){return u(!0,e)},success:function(e,t){return u(!0,e,t)},failure:function(e,t){return u(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var i=n(),a=r;return{reset:function(e){null!=e&&(a=e),i=n()},stop:function(){var r=n()-i,o=JSON.stringify({Target:a,Duration:r.toFixed(t)});e(o)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,i=window.performance;try{i&&i.now&&i.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var a=0;a<e.length;a+=1){try{if(n){t.perfNow=!0;var o=Math.floor(100*i.now())%10;(o<0||o>9)&&(o=0);for(var u=0;u<o;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[a]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";r.r(t),r.d(t,"testEmitter",(function(){return n})),r.d(t,"allWorkersDestroyed",(function(){return o}));var n=void 0,i=0,a=void 0;function o(){return 0===i?Promise.resolve():new Promise((function(e){return a.addListener("noworkers",e)}))}function u(e){return"undefined"!=typeof MessageEvent?new MessageEvent("message",{data:e}):{type:"message",data:e}}e:if("undefined"==typeof Worker){var c="undefined"!=typeof process&&null!=Object({NODE_ENV:"production"})&&null!=Object({NODE_ENV:"production"}).JEST_WORKER_ID,s="undefined"!=typeof global&&global.global===global;if(c||s){var l,f;try{l=require}catch(e){console.log("require is not defined (is this in a script executed by vm.runInThisContext?)");break e}try{f=l("worker_threads")}catch(e){console.log("error importing worker_threads (was node run without --experimental-worker?): "+e.stack);break e}var d=l("events");if(n=new d.EventEmitter,a=new d.EventEmitter,global.Worker=function(){function e(e){var t=this;this._onmessage=null,this._onerror=null,this.onmessageerror=null,this._messageHandler=function(e){null!=t._onmessage&&t._onmessage.call(t,u(e))},this._errorHandler=function(e){null!=t._onerror&&t._onerror.call(t,function(e,t){return"undefined"!=typeof ErrorEvent?new ErrorEvent("error",{message:e,error:t}):{type:"error",message:e,error:t,preventDefault:function(){}}}(e.message,e))},this._worker=new f.Worker(e),this._worker.on("exit",(function(e){n.emit("workerdestroyed",t),0==(i-=1)&&a.emit("noworkers")})),i+=1,n.emit("workercreated",this)}return Object.defineProperty(e.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?this._worker.removeListener("message",this._messageHandler):null==this._onmessage&&this._worker.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onerror",{get:function(){return this._onerror},set:function(e){null==e?this._worker.removeListener("error",this._errorHandler):null==this._onerror&&this._worker.on("error",this._errorHandler),this._onerror=e},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e){this._worker.postMessage(e)},e.prototype.terminate=function(){this._worker.terminate()},e.prototype.addEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.addEventListener")},e.prototype.removeEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.removeEventListener")},e.prototype.dispatchEvent=function(e){throw new Error("unimplemented: WorkerPolyfill.dispatchEvent")},e}(),!f.isMainThread&&"undefined"==typeof DedicatedWorkerGlobalScope){var h=function(){function e(){var e=this;this._onmessage=null,this.onmessageerror=null,this.onunhandledrejection=null,this._messageHandler=function(t){null!=e._onmessage&&e._onmessage.call(e,u(t))}}return Object.defineProperty(e.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?f.parentPort.removeListener("message",this._messageHandler):null==this._onmessage&&f.parentPort.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e,t){f.parentPort.postMessage(e)},e.prototype.close=function(){process.exit()},e}();global.DedicatedWorkerGlobalScope=h,global.self=new h,global.importScripts=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=l("vm"),n=l("fs");e.forEach((function(e){var t=n.readFileSync(e,"utf-8");r.runInThisContext(t)}))}}}}},function(e,t,r){"use strict";r.r(t),r.d(t,"packageVersion",(function(){return f})),r.d(t,"location",(function(){return ra})),r.d(t,"formula",(function(){return oa})),r.d(t,"value",(function(){return ia})),r.d(t,"signature",(function(){return ca})),r.d(t,"util",(function(){return la})),r.d(t,"config",(function(){return da})),r.d(t,"math",(function(){return va})),r.d(t,"parse",(function(){return n})),r.d(t,"analyze",(function(){return a})),r.d(t,"runtime",(function(){return u})),r.d(t,"calc",(function(){return l})),r.d(t,"funcs",(function(){return s})),r.d(t,"worker",(function(){return c}));var n={};r.r(n),r.d(n,"createParseGlobals",(function(){return Ra})),r.d(n,"ReasonKind",(function(){return Ia})),r.d(n,"parseLocals",(function(){return Oa})),r.d(n,"formatLocalsGrid",(function(){return Ta})),r.d(n,"formatLocalsName",(function(){return ka})),r.d(n,"notImplemented",(function(){return ya})),r.d(n,"notFormulaString",(function(){return Aa})),r.d(n,"createParser",(function(){return ms})),r.d(n,"parseResultHelper",(function(){return ks}));var i={};r.r(i),r.d(i,"SyntaxError",(function(){return Is})),r.d(i,"TypeError",(function(){return Ts}));var a={};r.r(a),r.d(a,"analyzeLocalsGrid",(function(){return Gs})),r.d(a,"analyzeLocalsName",(function(){return xs})),r.d(a,"analyzeFormatLocals",(function(){return Ps})),r.d(a,"diagnostics",(function(){return i})),r.d(a,"summarizeFormulaDiagnostics",(function(){return Ms})),r.d(a,"createAnalyzeGlobals",(function(){return Us})),r.d(a,"createAnalyzer",(function(){return Kf}));var o={};r.r(o),r.d(o,"TransitionKind",(function(){return Ad})),r.d(o,"nextTransition",(function(){return zd})),r.d(o,"callMachineTransition",(function(){return Zd})),r.d(o,"nextOnSuccessReceiver",(function(){return eh})),r.d(o,"MachineCycle",(function(){return rh})),r.d(o,"MachineRuntime",(function(){return nh})),r.d(o,"AllMachine",(function(){return ih})),r.d(o,"MachineCallKind",(function(){return th})),r.d(o,"machineCall",(function(){return ah})),r.d(o,"isMachineCall",(function(){return oh})),r.d(o,"ArrayMachine",(function(){return fh}));var u={};r.r(u),r.d(u,"fastMathpack",(function(){return zn})),r.d(u,"createCompiler",(function(){return Zh})),r.d(u,"createEvaluator",(function(){return Np})),r.d(u,"createFormulaInspector",(function(){return Vp})),r.d(u,"ReasonKind",(function(){return od})),r.d(u,"interval",(function(){return dd})),r.d(u,"CellKind",(function(){return sd})),r.d(u,"Interrupt",(function(){return ld})),r.d(u,"notImplemented",(function(){return id})),r.d(u,"finalValue",(function(){return vd})),r.d(u,"pendingValue",(function(){return pd})),r.d(u,"cellFormula",(function(){return md})),r.d(u,"userDefinedFunc",(function(){return Cd})),r.d(u,"unavailable",(function(){return ad})),r.d(u,"stopped",(function(){return gd})),r.d(u,"nameCycle",(function(){return yd})),r.d(u,"cellCycle",(function(){return Rd})),r.d(u,"paused",(function(){return Td})),r.d(u,"previousFailure",(function(){return Od})),r.d(u,"evalGlobals",(function(){return Sd})),r.d(u,"evalLocals",(function(){return Ed})),r.d(u,"compileLocals",(function(){return cd})),r.d(u,"getEvalFailureReason",(function(){return kd})),r.d(u,"illFormedFormula",(function(){return hd})),r.d(u,"createCompileGlobals",(function(){return ud})),r.d(u,"limitExceeded",(function(){return Id})),r.d(u,"LimitKind",(function(){return fd})),r.d(u,"extractResultValue",(function(){return Bd})),r.d(u,"evalToCellValue",(function(){return Hd})),r.d(u,"getBasicFirstOrderFunc",(function(){return uE})),r.d(u,"extension",(function(){return iE}));var c={};r.r(c),r.d(c,"WorkerKind",(function(){return ky})),r.d(c,"ErrorKind",(function(){return Ay})),r.d(c,"isWorkerSupported",(function(){return sR})),r.d(c,"createWorker",(function(){return fR})),r.d(c,"tryCreateWorker",(function(){return dR})),r.d(c,"dedicatedWorkerInsideInit",(function(){return vR})),r.d(c,"runSmokeTest",(function(){return yR})),r.d(c,"cancelSmokeTest",(function(){return SR})),r.d(c,"smokeTestInsideDef",(function(){return pR}));var s={};r.r(s),r.d(s,"getBasicFirstOrderFunc",(function(){return uE}));var l={};r.r(l),r.d(l,"recalcMapper",(function(){return FE})),r.d(l,"mapperContext",(function(){return LE})),r.d(l,"formulaCacheGlobals",(function(){return PE})),r.d(l,"formulaCache",(function(){return VE})),r.d(l,"createFormatInfo",(function(){return xE})),r.d(l,"worksheetFunctionName",(function(){return HE})),r.d(l,"errorTypeName",(function(){return jE})),r.d(l,"localeData",(function(){return KE})),r.d(l,"numberFormat",(function(){return qE})),r.d(l,"sheetName",(function(){return JE})),r.d(l,"blankValue",(function(){return XE})),r.d(l,"errorValue",(function(){return YE})),r.d(l,"richValue",(function(){return QE})),r.d(l,"getCellValueKind",(function(){return zE})),r.d(l,"cellLocation",(function(){return ZE})),r.d(l,"rangeLocation",(function(){return $E})),r.d(l,"sheetRangeLocation",(function(){return ey})),r.d(l,"cellData",(function(){return ty})),r.d(l,"cellFormulaCellData",(function(){return ry})),r.d(l,"arrayFormulaCellData",(function(){return ny})),r.d(l,"valueCellData",(function(){return iy})),r.d(l,"rangeUpdate",(function(){return ay})),r.d(l,"rangeWrite",(function(){return oy})),r.d(l,"rangePromote",(function(){return uy})),r.d(l,"arrayData",(function(){return cy})),r.d(l,"arrayUpdate",(function(){return sy})),r.d(l,"arrayWrite",(function(){return ly})),r.d(l,"arrayPromote",(function(){return fy})),r.d(l,"unusedCellsUpdate",(function(){return dy})),r.d(l,"namedValueData",(function(){return hy})),r.d(l,"namedFormulaData",(function(){return vy})),r.d(l,"namedRangeData",(function(){return py})),r.d(l,"namedFailureData",(function(){return my})),r.d(l,"namedObject",(function(){return gy})),r.d(l,"namedObjectsUpdate",(function(){return Cy})),r.d(l,"namedObjectsWrite",(function(){return Sy})),r.d(l,"undefinedNamesWrite",(function(){return Ey})),r.d(l,"namedObjectsPromote",(function(){return yy})),r.d(l,"rangeFormulaEdit",(function(){return Ry})),r.d(l,"cellFormulaRangeFormulaEdit",(function(){return Oy})),r.d(l,"valueRangeFormulaEdit",(function(){return Iy})),r.d(l,"inferredRangeFormulaEdit",(function(){return Ty})),r.d(l,"arrayFormulaEdit",(function(){return Fy})),r.d(l,"inferredFormat",(function(){return Ly})),r.d(l,"cellDataDelta",(function(){return wy})),r.d(l,"rangeDelta",(function(){return _y})),r.d(l,"arrayDelta",(function(){return Dy})),r.d(l,"rangeFailure",(function(){return My})),r.d(l,"recalcResults",(function(){return Uy})),r.d(l,"updateRequest",(function(){return Gy})),r.d(l,"recalcServiceConfig",(function(){return xy})),r.d(l,"createRecalcService",(function(){return Rk})),r.d(l,"RecalcServiceCreateMode",(function(){return Ck})),r.d(l,"recalcServiceInsideDef",(function(){return yk}));var f="11.6.4",d=r(0);function h(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function v(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t}function p(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t}function m(e){if(null==e||"object"!=typeof e)return"<not object>";var t=e,r=String(t.message);if(null!=t.stack){var n=String(t.stack);return n.indexOf(r)>=0?n:"Error: "+r+"\n"+n}return r}function g(e){return e}function C(e,t){if("string"==typeof t&&null!=E[t])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),n=void 0!==r?R[r]:void 0;return void 0===n&&(n=y[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(e instanceof Array)return"Array"}return t}(e)]),void 0!==n?n(e,t):"<unexpected>"}function S(e){try{return JSON.stringify(C(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var E={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},y={boolean:g,symbol:g,undefined:g,null:g,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function "+t+">":"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=C(e[r],r));return t},Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(C):"<unexpected>"}},R=Object.create(null),O={ULS:new(function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){if(!r)throw new Error("shipAssertTag "+e+" "+t+" "+n)},e.prototype.assertTag=function(e,t,r,n){if(!r)throw new Error("assertTag "+e+" "+t+" "+n)},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}())};function I(e){O.ULS=e}function T(e,t){var r=e+": code should be unreachable because a value has type 'never'; given "+S(t);return O.ULS.assertTag(595980872,d.LogCategory.msoulscat_ES_EWAJS,!1,r)}function k(e){return O.ULS.assertTag(595980873,d.LogCategory.msoulscat_ES_EWAJS,!1,e)}function A(e,t){t||k(e+": expected condition to be true")}function b(e,t){(!h(t)||t<0)&&k(e+": expected natural number; given "+S(t))}function N(e,t){(!h(t)||t<=0)&&k(e+": expected positive integer; given "+S(t))}function F(e,t,r){(!h(t)||t<0||t>=r)&&k(e+": expected natural number less than "+S(r)+"; given "+S(t))}function L(e,t,r){(!h(t)||t<=0||t>r)&&k(e+": expected positive integer at most "+S(r)+"; given "+S(t))}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var _,D,M,U,G,x,P,V=function(){return(V=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function W(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function B(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}c((n=n.apply(e,t||[])).next())}))}function H(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function j(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,u=a.length;o<u;o++,i++)n[i]=a[o];return n}function K(e){return void 0===e&&(e=0),{kind:D.Error,isQuoted:!1,label:e}}function q(e){return void 0===e&&(e=0),{kind:D.Relative,isQuoted:!1,label:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(_||(_={})),function(e){e.Error="QualError",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(D||(D={})),function(e){e.Error="RefError",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(M||(M={})),function(e){e.Abs="Abs",e.Rel="Rel"}(U||(U={})),function(e){e.WorksheetFuncName="WorksheetFuncName",e.LocalName="LocalName"}(G||(G={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(x||(x={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(P||(P={}));var J=K(),X=q();function Y(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:D.Document,isQuoted:r,label:n,document:e,path:t}}function Q(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:D.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function z(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:D.Ident,isQuoted:t,label:r,name:e}}function Z(e,t,r,n,i){return void 0===n&&(n=!1),void 0===i&&(i=0),{kind:D.SheetRange,isQuoted:n,label:i,sheet1:e,sheet2:t,document:r}}function $(e,t){return{kind:e,index:t}}function ee(e){return void 0===e&&(e=0),{kind:M.Error,label:e}}var te,re,ne,ie,ae,oe,ue=ee();function ce(e,t,r){return void 0===r&&(r=0),{kind:M.Single,label:r,row:e,col:t}}function se(e,t,r){return void 0===r&&(r=0),{kind:M.Range,label:r,ref1:e,ref2:t}}function le(e,t,r){return void 0===r&&(r=0),{kind:M.Row,label:r,row1:e,row2:t}}function fe(e,t,r){return void 0===r&&(r=0),{kind:M.Col,label:r,col1:e,col2:t}}function de(e,t,r){return{node:e,spans:t,annotations:r}}function he(e,t,r,n){var i,a;return b("calc.lang.formulaSpan",e),i="calc.lang.formulaSpan",h(a=t)||k(i+": expected integer; given "+S(a)),t<e&&k("calc.lang.formulaSpan: expected end >= "+e+"; given "+t),{start:e,end:t,pre:r,post:n}}function ve(e){return{kind:G.WorksheetFuncName,id:e}}function pe(e){return{kind:G.LocalName,name:e}}function me(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:x.Literal,label:r,oper:e,isClosed:t}}function ge(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:x.Array,label:r,nodes:e,isClosed:t}}function Ce(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:x.App,label:n,head:e,args:t,isClosed:r}}function Se(e,t){return void 0===t&&(t=0),{kind:x.Operator,label:t,id:e}}function Ee(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:x.Paren,label:r,node:e,isClosed:t}}function ye(e,t,r){return void 0===r&&(r=0),{kind:x.Name,label:r,whole:e,qualifier:t}}function Re(e,t,r){return void 0===r&&(r=0),{kind:x.CellRef,label:r,ref:e,qualifier:t}}function Oe(e,t,r){return void 0===r&&(r=0),{kind:x.Bad,label:r,type:e,contents:t}}function Ie(e,t,r,n,i,a,o){(b("calc.lang.functionType",e),0===r.length?0!==n.length:n.length>=r.length)&&k("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+JSON.stringify(n));0===r.length&&t.length+n.length<e&&k("calc.lang.functionType: expected headTypes.length + tailTypes.length >= "+e+"; given "+JSON.stringify(t));return{minArgs:e,headTypes:t,restTypes:r,tailTypes:n,returnType:i,staticPrecs:a,flags:o}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(te||(te={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(re||(re={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(ne||(ne={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(ie||(ie={})),function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(oe||(oe={}));var Te,ke;function Ae(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function be(e){var t=Pe[e];return void 0!==t?t:xe(e)}!function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(Te||(Te={})),function(e){e[e.First=1]="First",e[e.Last=13]="Last"}(ke||(ke={}));var Ne=xe(Te.NULL),Fe=xe(Te.DIV0),Le=xe(Te.VALUE),we=xe(Te.REF),_e=xe(Te.NAME),De=xe(Te.NUM),Me=xe(Te.NA),Ue=xe(Te.GETTING_DATA),Ge=xe(Te.FIELD);function xe(e){return{kind:te.Error,type:e}}var Pe=p(((ae={})[Te.NULL]=Ne,ae[Te.DIV0]=Fe,ae[Te.VALUE]=Le,ae[Te.REF]=we,ae[Te.NAME]=_e,ae[Te.NUM]=De,ae[Te.NA]=Me,ae[Te.GETTING_DATA]=Ue,ae[Te.FIELD]=Ge,ae));function Ve(e,t,r){return b("calc.lang.arrayOper",e),b("calc.lang.arrayOper",t),r.length!==e?k("calc.lang.arrayOper: Inconsistent row number"):{kind:te.Array,rows:e,cols:t,opers:r}}function We(e,t){return N("calc.lang.rangeSeqOper",t.length),{kind:te.Range,sheets:e,ranges:t}}function Be(e,t){return{kind:te.Range,sheets:e,ranges:[t]}}var He,je={kind:te.Missing},Ke={kind:te.Blank};!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.SUBARRAY=634]="SUBARRAY",e[e.APPENDROWS=635]="APPENDROWS",e[e.APPENDCOLUMNS=636]="APPENDCOLUMNS",e[e.SELECTROW=637]="SELECTROW",e[e.SELECTCOLUMN=638]="SELECTCOLUMN",e[e.LET=639]="LET",e[e.FUN=640]="FUN",e[e.ARRAYMAKE=641]="ARRAYMAKE",e[e.APPLY=642]="APPLY",e[e.ISFUN=643]="ISFUN",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.RECORD=646]="RECORD",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.TESTFUNCTIONBEGIN=649]="TESTFUNCTIONBEGIN",e[e.IMAGE=650]="IMAGE",e[e.GRF=651]="GRF",e[e.UNIT=652]="UNIT",e[e.RICHERROR=653]="RICHERROR",e[e.COUNTER=654]="COUNTER",e[e.BROKENRECORD=655]="BROKENRECORD",e[e.FORMULABYTES=656]="FORMULABYTES",e[e.FORMULACODE=657]="FORMULACODE",e[e.FORMULAHTML=658]="FORMULAHTML",e[e.STREAM=659]="STREAM",e[e.FORMATTEDNUMBER=660]="FORMATTEDNUMBER",e[e.LETREC=680]="LETREC"}(He||(He={}));var qe,Je=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[637,"SelectRow"],[638,"SelectColumn"],[641,"ARRAY.MAKE"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]),Xe=[],Ye=[[1,Xe,[57],Xe,1,0,16],[1,[36,831,831],Xe,Xe,823,0,0],[1,[15],Xe,Xe,4,0,0],[1,[15],Xe,Xe,4,0,0],[1,Xe,[305],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[0,[16],Xe,Xe,33,0,0],[0,[16],Xe,Xe,33,0,0],[0,Xe,Xe,Xe,3,0,16],[2,[1],[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,[1,1],Xe,Xe,2,0,0],[1,[1,65,4],Xe,Xe,2,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[0,Xe,Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[263,48,48],Xe,Xe,263,0,0],[2,[48,1,1,1],Xe,Xe,311,0,0],[2,[2,1],Xe,Xe,2,0,0],[3,[2,1,1],Xe,Xe,2,0,0],[1,[2],Xe,Xe,1,0,0],[1,[7],Xe,Xe,1,0,0],[0,Xe,Xe,Xe,4,0,16],[0,Xe,Xe,Xe,4,0,16],[1,Xe,[52],Xe,4,0,16],[1,Xe,[52],Xe,4,0,16],[1,[4],Xe,Xe,4,0,16],[2,[1,1],Xe,Xe,1,0,0],[3,[16,83,18],Xe,Xe,1,0,0],[3,[16,19,18],Xe,Xe,1,0,0],[3,[16,19,18],Xe,Xe,1,0,0],[3,[16,19,18],Xe,Xe,1,0,0],[3,[16,19,18],Xe,Xe,1,0,0],[3,[16,19,18],Xe,Xe,1,0,0],[1,Xe,[49],Xe,1,0,16],[3,[16,19,18],Xe,Xe,1,0,0],[2,[7,2],Xe,Xe,2,0,0],[1,[48,112,84,84],Xe,Xe,32,0,0],[1,[48,112,112,84],Xe,Xe,32,0,0],[1,[48,112,84,84],Xe,Xe,32,0,0],[1,[48,112,112,84],Xe,Xe,32,0,0],[1,[16],Xe,Xe,512,0,2],[0,[4],Xe,Xe,512,0,2],[0,[575],Xe,Xe,512,0,2],[3,[1,1,1,1,1],Xe,Xe,1,0,0],[3,[1,1,1,1,1],Xe,Xe,1,0,0],[3,[1,1,1,1,1],Xe,Xe,1,0,0],[3,[1,1,1,1,1],Xe,Xe,1,0,0],[3,[1,1,1,1,1,1],Xe,Xe,1,0,0],[3,[48,1,1],Xe,Xe,1,0,16],[1,[48,1],Xe,Xe,1,0,0],[0,Xe,Xe,Xe,1,16383,0],[2,[263,305,17],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1,1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[0,Xe,Xe,Xe,1,16383,0],[1,[16],Xe,Xe,1,0,0],[1,[48],Xe,Xe,1,0,0],[1,[48],Xe,Xe,1,0,0],[3,[16,65,65,65,65],Xe,Xe,16,16383,0],[2,[2,16],Xe,Xe,16,0,2],[2,[16,16],Xe,Xe,2,0,2],[0,[66,81,16],Xe,Xe,4,0,2],[2,[2,2,1],Xe,Xe,1,0,0],[1,[39],Xe,Xe,32,0,0],[0,[1,24],Xe,Xe,4,0,2],[0,Xe,Xe,Xe,4,0,2],[1,[303],Xe,Xe,1,0,0],[0,[4],Xe,Xe,4,0,2],[1,[2,63],Xe,Xe,4,0,2],[0,Xe,Xe,Xe,50,0,2],[1,[16],Xe,Xe,47,0,2],[0,[65,66],Xe,Xe,32,0,2],[4,[87,117,117,1,117],Xe,Xe,4,0,0],[0,[1,66],Xe,Xe,32,0,2],[0,Xe,Xe,Xe,16,0,2],[0,Xe,Xe,Xe,16,0,2],[0,[1],Xe,Xe,4,0,2],[2,[1,1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[2,[33],[831],Xe,823,0,0],[3,[263,49,49,4],Xe,Xe,295,0,0],[3,[263,49,49,4],Xe,Xe,295,0,0],[0,[66,65],Xe,Xe,32,0,2],[1,[2,65,66,67,65,65,2],Xe,Xe,575,0,2],[1,[63],Xe,Xe,4,0,0],[1,[18],Xe,Xe,2,0,2],[1,[2,4],Xe,Xe,6,0,2],[2,[16,47],Xe,Xe,4,0,2],[1,[1,1],Xe,Xe,1,0,0],[1,[2,1,4,4],Xe,Xe,7,0,2],[1,[1],Xe,Xe,2,0,0],[1,[2],Xe,Xe,2,0,0],[1,[2],Xe,Xe,2,0,0],[1,[2],Xe,Xe,2,0,0],[1,[2,9],Xe,Xe,2,0,0],[1,[2,9],Xe,Xe,2,0,0],[2,[2,2],Xe,Xe,4,0,0],[1,[2],Xe,Xe,2,0,0],[4,[2,1,1,2],Xe,Xe,2,0,0],[3,[2,2,2,2],Xe,Xe,2,0,0],[1,[2],Xe,Xe,1,0,0],[0,[66,65,66],Xe,Xe,32,0,2],[0,[2],Xe,Xe,2,0,2],[2,[2,2,1],Xe,Xe,1,0,0],[1,[2,16],Xe,Xe,303,16383,0],[1,[15],Xe,Xe,4,0,0],[1,[143],Xe,Xe,4,0,0],[1,[143],Xe,Xe,4,0,0],[1,[143],Xe,Xe,4,0,0],[1,[23],Xe,Xe,2,0,0],[1,[23],Xe,Xe,1,0,0],[1,[2,1],Xe,Xe,1,0,2],[1,[1],Xe,Xe,1,0,2],[1,[1],Xe,Xe,1,0,2],[1,[1],Xe,Xe,2,0,2],[2,[1,1],Xe,Xe,2,0,2],[2,[1,2],Xe,Xe,1,0,2],[2,[1,2],Xe,Xe,1,0,2],[1,[1,1],Xe,Xe,1,0,2],[1,[3],Xe,Xe,1,0,0],[1,[3],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[4,[1,1,1,1],Xe,Xe,1,0,0],[4,[1,1,1,1,1],Xe,Xe,1,0,0],[1,[2,66,65],Xe,Xe,2,0,2],[1,[16,4],Xe,Xe,2,0,2],[1,[2,4],Xe,Xe,16,0,2],[1,[2,4],Xe,Xe,16,16383,0],[1,[2,3,66,66,66,65,67,66,67],[66],Xe,3,0,2],[1,[3],[127],Xe,575,0,2],[0,[3],Xe,Xe,1,0,2],[2,[3,115,83,3],Xe,Xe,1,0,2],[3,[3,83,115,83,3],Xe,Xe,1,0,2],[4,[3,3,3,4,3],Xe,Xe,4,0,2],[4,[3,3,3,4,3],Xe,Xe,4,0,2],[4,[3,3,3,3,3],Xe,Xe,4,0,2],[0,[3],Xe,Xe,4,0,2],[2,[3,3,3],Xe,Xe,4,0,2],[3,[3,3,3,3],Xe,Xe,4,0,2],[1,[1,67,66],Xe,Xe,1,0,2],[1,[52],Xe,Xe,36,0,2],[1,[2],Xe,Xe,2,0,0],[1,[32],Xe,Xe,1,0,0],[1,[32],Xe,Xe,32,0,0],[2,[32,32],Xe,Xe,32,0,0],[0,[2,2],Xe,Xe,32,0,2],[4,[1,1,1,1,1,1],Xe,Xe,1,0,0],[4,[1,1,1,1,1,1],Xe,Xe,1,0,0],[1,Xe,[121],Xe,1,0,16],[0,[1,16],Xe,Xe,4,0,2],[3,[2,1,1,1],Xe,Xe,512,0,2],[1,[4],Xe,Xe,512,0,2],[0,Xe,Xe,Xe,512,0,2],[0,Xe,Xe,Xe,512,0,2],[2,[2,2],Xe,Xe,1,0,2],[2,[1,2],Xe,Xe,32,0,2],[3,[1,18,18],Xe,Xe,4,0,2],[2,[1,2],Xe,Xe,4,0,2],[1,[1],Xe,Xe,4,0,2],[0,[1],Xe,Xe,512,0,2],[0,[2],Xe,Xe,4,0,2],[0,[3,3,3,3],Xe,Xe,3,0,2],[1,Xe,[113],Xe,1,0,16],[1,[1],Xe,Xe,1,0,0],[1,[1,16],Xe,Xe,47,0,2],[1,[1],Xe,Xe,47,0,2],[1,[1,2],Xe,Xe,47,0,2],[1,[1,2],Xe,Xe,63,0,2],[3,[16,19,18],Xe,Xe,1,0,0],[1,[143],Xe,Xe,4,0,0],[0,[82,65,65],Xe,Xe,2,0,2],[0,[66,82,17,17],Xe,Xe,1,0,2],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[3,[16,19,18],Xe,Xe,1,0,0],[3,[16,19,18],Xe,Xe,1,0,0],[1,[1,1],Xe,Xe,1,0,0],[1,[143],Xe,Xe,4,0,0],[3,[16,83,18],Xe,Xe,1,0,0],[1,[3],Xe,Xe,4,0,2],[1,[3],Xe,Xe,4,0,2],void 0,void 0,[1,[1,1],Xe,Xe,2,0,0],[2,[2,2,1],Xe,Xe,1,0,0],[2,[2,2,1],Xe,Xe,1,0,0],[4,[2,1,1,2],Xe,Xe,2,0,0],[1,[2,9],Xe,Xe,2,0,0],[1,[2,9],Xe,Xe,2,0,0],[3,[2,1,1],Xe,Xe,2,0,0],[1,[2],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[1,[2],Xe,Xe,2,0,0],[1,[2],Xe,Xe,2,0,0],[2,[1,16,4],Xe,Xe,1,0,16],void 0,void 0,[2,[1,65,65,68,66],Xe,Xe,2,0,0],[2,[1,1,4],Xe,Xe,1,0,0],[0,Xe,Xe,Xe,1,16383,0],[5,[1,1,1,1,1,1,4],Xe,Xe,1,0,0],[0,Xe,Xe,Xe,512,0,2],[1,[12],Xe,Xe,512,0,2],[0,Xe,Xe,Xe,512,0,2],[1,[2,82,84],Xe,Xe,512,0,2],[1,Xe,[49],Xe,1,0,16],[1,Xe,[32],Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[3,[16,19,18],Xe,Xe,263,0,0],[2,[1,18,17,17,18,17,17,115,84,21,17],Xe,Xe,2,0,2],[0,[4],Xe,Xe,4,0,2],[0,Xe,Xe,Xe,16,0,2],[0,[2,2],Xe,Xe,4,0,2],[0,[2,2,2],Xe,Xe,4,0,2],[2,[2,23,23,23,23],Xe,Xe,2,0,2],[2,[2,1,1,2],Xe,Xe,1,0,2],[1,[2,66,65,65],Xe,Xe,1,0,2],[1,[2],Xe,Xe,3,16383,0],[0,Xe,Xe,Xe,2,0,2],[1,[1,2,1,1,1],Xe,Xe,47,0,2],[4,[1,1,1,1,1],Xe,Xe,1,0,0],[0,[4],Xe,Xe,512,0,2],void 0,void 0,[0,[1],Xe,Xe,512,0,2],[2,[48,48],Xe,Xe,32,0,16],[0,[66,96],Xe,Xe,2,0,2],[1,[2],Xe,Xe,4,0,2],[1,[17],[127],Xe,575,0,0],[1,[3],Xe,Xe,4,0,2],[1,[2],Xe,Xe,63,0,2],[1,[1,3],Xe,Xe,47,0,2],[1,[1,3,1],Xe,Xe,47,0,2],[1,[2,66,4],Xe,Xe,4,0,2],[1,[15],Xe,Xe,1,0,0],[0,[2],Xe,Xe,4,0,2],[0,[2],Xe,Xe,4,0,2],[0,[99,66],Xe,Xe,4,0,2],[3,[3,1,4],Xe,Xe,4,0,2],[3,[3,1,4],Xe,Xe,4,0,2],[2,[2,3,66],Xe,Xe,1,0,2],[1,[1,2],Xe,Xe,35,0,2],[1,Xe,[49],Xe,1,0,16],[3,[1,1,1,65,65],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[3,[1,1,1,65,65],Xe,Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[3,[1,1,4],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[4,[1,1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[3,[1,1,4],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[3,[1,32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[4,[32,32,1,1],Xe,Xe,1,0,0],[3,[32,32,1,65],Xe,Xe,1,0,0],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[2,[49,1,1],Xe,Xe,1,0,16],[2,[49,1],Xe,Xe,1,0,16],[2,[49,1],Xe,Xe,1,0,16],[2,[49,1],Xe,Xe,1,0,16],[2,[49,1],Xe,Xe,1,0,16],[2,[49,1,65],Xe,Xe,1,0,16],[1,Xe,[32],Xe,1,0,16],[2,[49,1],Xe,Xe,1,0,16],[2,[1,1],Xe,Xe,1,0,0],void 0,[3,[2,1,1,1],Xe,Xe,1,0,2],[2,[2,1,1],Xe,Xe,1,0,2],[1,Xe,[2],Xe,2,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[66,2,66,65,65,65,66,66,66],Xe,Xe,2,0,2],[1,[1,2],Xe,Xe,35,0,2],[1,[1,66,2],Xe,Xe,35,0,2],[1,[1,66,66,2],Xe,Xe,7,0,2],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[2,[1],[16],Xe,1,0,0],[2,[16,15,16],Xe,Xe,1,0,0],[2,[16,15],Xe,Xe,1,0,0],[1,[16],Xe,Xe,1,0,0],[1,[1,2],Xe,Xe,19,0,2],[1,[33],Xe,Xe,33,0,2],[4,[1,1,1,1],Xe,Xe,1,0,0],[3,[1,1,2],Xe,Xe,1,0,0],[1,[1],Xe,Xe,2,0,0],[2,[1,1],Xe,Xe,2,0,0],[1,[1,5],Xe,Xe,2,0,0],[0,[66,66,66,65],Xe,Xe,6,0,2],[0,[66,66,66,66,65],Xe,Xe,6,0,2],[1,[1,2],Xe,Xe,19,0,2],[2,[18,18],[2,79],Xe,15,0,0],[1,[2,39],Xe,Xe,39,0,0],[1,[16],Xe,Xe,2,0,0],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,[1],Xe,Xe,2,0,0],[1,[1],Xe,Xe,2,0,0],[1,[3],Xe,Xe,2,0,0],[1,[1],Xe,Xe,2,0,0],[1,[1],Xe,Xe,2,0,0],[1,[1],Xe,Xe,2,0,0],[1,[2],Xe,Xe,1,0,0],[1,[2],Xe,Xe,4,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[3,Xe,[2],Xe,2,0,0],[1,[2],[50],Xe,15,0,0],[2,[2,50,2],Xe,Xe,10,0,0],[3,[2,2,2],Xe,Xe,15,0,0],[3,[2,2,1,2],Xe,Xe,10,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[2,[95,95,95],Xe,Xe,9,0,0],[1,Xe,[127],Xe,9,0,0],[1,Xe,[127],Xe,9,0,0],[4,[95,95,95,127],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[1,[95,95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[127,127,95],Xe,Xe,9,0,0],[3,[95,127,127],Xe,Xe,9,0,0],[5,[95,95,95,95,95,95],Xe,Xe,9,0,0],[5,[95,95,95,95,95,95],Xe,Xe,9,0,0],[4,[95,95,95,95,95],Xe,Xe,9,0,0],[4,[95,95,95,95,95],Xe,Xe,9,0,0],[4,[95,95,95,95,95],Xe,Xe,9,0,0],[4,[95,95,95,95,95],Xe,Xe,9,0,0],[4,[95,95,95,95,95],Xe,Xe,9,0,0],[3,[95,95,95],Xe,Xe,9,0,0],[3,[95,95,95],Xe,Xe,9,0,0],[3,[95,95,95],Xe,Xe,9,0,0],[6,[95,95,95,95,95,95,95],Xe,Xe,9,0,0],[6,[95,95,95,95,95,95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[6,[95,95,95,95,95,95],Xe,Xe,9,0,0],[6,[95,95,95,95,95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,0,0],[2,[95,95,95],Xe,Xe,9,0,0],[3,[95,95,95,95],Xe,Xe,9,0,0],[3,[95,95,95,95],Xe,Xe,9,0,0],[3,[95,95,95,95],Xe,Xe,9,0,0],[3,[95,95,95,95],Xe,Xe,9,0,0],[3,[95,95,95,95],Xe,Xe,9,0,0],[3,[95,95,95,95],Xe,Xe,9,0,0],[5,[95,95,95,95,95,95],Xe,Xe,9,0,0],[5,[95,95,95,95,95,95],Xe,Xe,9,0,0],[7,[95,95,95,95,95,95,95,95],Xe,Xe,9,0,0],[7,[95,95,95,95,95,95,95,95],Xe,Xe,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Xe,Xe,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Xe,Xe,9,0,0],[2,[95,95],Xe,Xe,9,16383,0],[1,[95,95],Xe,Xe,9,0,0],[6,[95,95,95,95,95,95,95],Xe,Xe,9,0,0],[6,[95,95,95,95,95,95,95],Xe,Xe,9,0,0],[3,[95,95,95],Xe,Xe,9,0,0],[6,[95,95,95,95,95,95,95,95],Xe,Xe,9,0,0],[4,[95,95,95,95,95],Xe,Xe,9,0,0],[2,[95,95,127],Xe,Xe,9,0,0],[2,[95,95,127],Xe,Xe,9,0,0],[1,Xe,[127],Xe,9,0,0],[1,Xe,[127],Xe,9,0,0],[1,Xe,[127],Xe,9,0,0],[2,[95,127],Xe,Xe,9,0,0],[3,[2,2,1,2],Xe,Xe,10,0,0],[2,[2,50,2,1,2],Xe,Xe,10,0,0],[1,[2],Xe,Xe,9,0,0],[2,[47,575],Xe,Xe,303,0,0],[2,Xe,[16,15],Xe,1,0,0],[3,[16],[16,15],Xe,1,0,0],[2,[16,15,16],Xe,Xe,1,0,0],[3,[16],[16,15],Xe,1,0,0],[3,[1,1,48,17],[16],Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[2,[32,32],Xe,Xe,1,0,0],[3,[1,1,4],Xe,Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[1,Xe,[32],Xe,32,0,16],[1,Xe,[32],Xe,1,0,16],[4,[1,1,1,4],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[2,[49,1],Xe,Xe,1,0,16],[2,[49,1],Xe,Xe,1,0,16],[2,[49,1,65],Xe,Xe,1,0,16],[2,[49,1,65],Xe,Xe,1,0,16],[3,[1,1,4],Xe,Xe,1,0,0],[2,[49,1],Xe,Xe,1,0,16],[2,[49,1],Xe,Xe,1,0,16],[2,[1,16,4],Xe,Xe,1,0,16],[2,[1,16,4],Xe,Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[3,[1,1,4],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[1,Xe,[49],Xe,1,0,16],[1,Xe,[49],Xe,1,0,16],[4,[1,1,1,4],Xe,Xe,1,0,0],[2,[95,95,75,127],Xe,Xe,9,0,0],[2,[95,95,75,127],Xe,Xe,9,0,0],[2,[1,1],Xe,Xe,1,0,0],[1,[1,65],Xe,Xe,1,0,0],void 0,[4,[1,1,1,4,65,65],Xe,Xe,1,0,0],[3,[1,1,1,65,65],Xe,Xe,1,0,0],[3,[1,1,4],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[5,[1,1,1,1,4],Xe,Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[4,[1,1,1,4],Xe,Xe,1,0,0],[2,[1,4],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[4,[32,32,1,1],Xe,Xe,1,0,0],[2,[49,1,1],Xe,Xe,1,0,16],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1,65],Xe,Xe,1,0,0],[1,[1,65],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[2,[1,1],Xe,Xe,1,0,0],[1,Xe,[52],Xe,4,0,16],[3,[1,1,1],Xe,Xe,1,0,0],[2,[1,1,65],Xe,Xe,2,0,0],[2,[2,1],Xe,Xe,1,0,0],[2,[3,3],Xe,Xe,1,0,0],[3,[1,1,1,65],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,Xe,[49],Xe,1,0,16],[1,[1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[3,[1,1,1],Xe,Xe,1,0,0],[1,[1],Xe,Xe,2,0,0],[1,[2],Xe,Xe,1,0,0],[1,[1],Xe,Xe,32,0,0],[1,[2],Xe,Xe,1,0,0],[1,[1],Xe,Xe,1,0,0],[1,[2,66,66],Xe,Xe,1,0,0],[0,[50],Xe,Xe,1,16383,16],[0,[48],Xe,Xe,1,16383,16],[1,[16],Xe,Xe,2,16383,0],[1,[16],Xe,Xe,4,0,0],[2,[47,575],Xe,Xe,303,0,0],[1,[1,65,65],Xe,Xe,1,0,0],[1,[1,65,65],Xe,Xe,1,0,0],[1,[95],Xe,Xe,9,0,0],[1,[95],Xe,Xe,9,0,0],[2,[2,2],Xe,Xe,47,0,0],[1,[2],Xe,Xe,10,0,0],[1,[2],Xe,Xe,10,0,0],[3,[1,48,48,65,65,65],Xe,Xe,1,0,0],[3,[1,48,48,65,65,65,65],Xe,Xe,1,0,0],[2,[48,48,65,65],Xe,Xe,1,0,0],[3,[1,32,32],Xe,Xe,1,0,0],[3,[48,48,1,65,65,65],Xe,Xe,1,0,0],[3,[16],[16,15],Xe,1,0,0],[3,[16],[16,15],Xe,1,0,0],[3,[114,68],[114],Xe,2,0,16],[1,Xe,[114],Xe,2,0,16],[2,Xe,[44,575],Xe,831,0,0],[3,[47],[575,575],[575],831,0,0],[1,[1399],Xe,Xe,1375,0,17],[2,Xe,[113,113],Xe,1,0,17],[1,[16],Xe,Xe,48,0,21],[2,[271,2,4],Xe,Xe,303,0,21],[2,[271,2],Xe,Xe,303,0,17],[2,[48,48,111],Xe,Xe,303,0,1],[1,[160,96,96,4],Xe,Xe,32,0,1],[1,[160,4,4],Xe,Xe,32,0,1],[2,[2,256],Xe,Xe,1,0,8],[3,[2,49,1],Xe,Xe,1,0,25],[3,[2,49,1],Xe,Xe,1,0,25],[2,[2],[49],Xe,1,0,25],[2,[2,2,65,68,68],Xe,Xe,1,0,1],[1,[2,65,65],Xe,Xe,2,0,1],[2,[2,2,65,68],Xe,Xe,2,0,1],[2,[2,2,65,68],Xe,Xe,2,0,1],[2,[2,98,98,68],Xe,Xe,32,0,1],[1,[32,96,96,4],Xe,Xe,32,0,9],[2,[4,16],Xe,Xe,32,0,25],[2,[391,48,65,65],Xe,Xe,1,0,1],[3,[391,48,48,511,65,65],Xe,Xe,319,0,1],[2,[160],[160,65],Xe,32,0,1],[0,[65,65,65,65,68],Xe,Xe,32,16383,1],[1,[65,65,65,65],Xe,Xe,32,0,1],[2,[258,1,65,65,68],[65],Xe,32,0,17],[1,[48,65,65,65,65],Xe,Xe,48,0,1],[1,[48],[48],Xe,32,0,1],[1,[48],[48],Xe,32,0,1],[1,[48,33],[33],Xe,32,0,1],[1,[48,33],[33],Xe,32,0,1],[3,Xe,[319,319],[319],319,0,1],[1,Xe,[319],Xe,319,0,1],[3,[1,1,319],Xe,Xe,32,0,1],[1,Xe,[319],Xe,319,0,1],[1,[319],Xe,Xe,4,0,1],[1,[319],Xe,Xe,9,0,1],[0,Xe,Xe,Xe,319,0,1],[3,[15],[2,47],Xe,303,0,17],[1,[399,1],Xe,Xe,2,0,1],[1,[32,1],Xe,Xe,2,0,1],[0,Xe,Xe,Xe,1,0,1],[1,[2],Xe,Xe,258,0,1],[1,[287,2],Xe,Xe,288,0,17],[2,[15,2],Xe,Xe,271,0,17],[1,[1],Xe,Xe,10,0,17],[0,Xe,Xe,Xe,1,0,1],[3,[47],[2,47],Xe,47,0,17],[1,[16],Xe,Xe,2,16383,1],[1,[16],Xe,Xe,2,16383,1],[1,[16],Xe,Xe,2,16383,1],[0,[1],Xe,Xe,1,0,1],[2,[1,1],Xe,Xe,265,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,Xe,[319,319],[319],319,0,1]].map((function(e){return void 0===e?void 0:Ie.apply(void 0,e)})),Qe=Ie(0,[],[re.All],[],re.All,ne.All,ie.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot",e[e.At=25]="At",e[e.Pound=26]="Pound"}(qe||(qe={}));var ze,Ze,$e=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,".","@","#"],et=te.Number|te.String|te.Boolean|te.Blank,tt=te.Number|te.String|te.Boolean|te.Blank,rt=Ie(2,[te.Number,te.Number],[],[],te.Number,ne.None,ie.None),nt=Ie(1,[te.Number],[],[],te.Number,ne.None,ie.None),it=Ie(1,[et],[],[],et,ne.None,ie.None),at=Ie(2,[te.String,te.String],[],[],te.String,ne.None,ie.None),ot=Ie(2,[tt,tt],[],[],te.Boolean,ne.None,ie.None),ut=Ie(2,[te.Range,te.Range],[],[],te.Range,ne.AllCells,ie.None),ct=Ie(2,[te.Range,te.Range],[],[],te.Range,ne.None,ie.None),st=Ie(2,[te.Boolean,te.Boolean],[],[],te.Boolean,ne.None,ie.None),lt=[];function ft(e){var t=lt[e];return null!=t?t:Qe}function dt(e){var t=Ye[e];return null!=t?t:Qe}function ht(e,t){var r=Ye[e];null!=r&&(r.staticPrecs=t)}function vt(e){return{kind:ze.Success,value:e}}function pt(e){return{kind:ze.Failure,reason:e}}function mt(e){return null!=e&&e.kind===ze.Success}function gt(e){return{kind:Ze.JavaScriptError,error:e}}function Ct(e){return e.index===e.index2}function St(e){return e.isWellFormed}function Et(e){return 1===e.rows&&1===e.cols}function yt(e){return Ct(e.sheet)}function Rt(e){return Et(e.range)}function Ot(e,t){if(Et(e))return t(e,0,0);for(var r=e.row,n=e.rows,i=e.col,a=e.cols,o=0;o<n;o+=1)for(var u=0;u<a;u+=1)if(!t(ar(r+o,i+u),o,u))return!1;return!0}function It(e,t){return e===t||e.name===t.name&&e.path===t.path}function Tt(e,t){return It(e.document,t.document)&&e.index===t.index}function kt(e,t){return e.row===t.row&&e.col===t.col}function At(e,t){return Tt(e.sheet,t.sheet)&&kt(e.range,t.range)}function bt(e){return Et(e)?e:nr(e.row,e.col,1,1)}function Nt(e){return Rt(e)?e:sr(e.sheet,bt(e.range))}function Ft(e,t){var r=e.row,n=e.col,i=t.row,a=t.col;return nr(Math.min(r,i),Math.min(n,a),Math.abs(i-r)+1,Math.abs(a-n)+1)}function Lt(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,i=!0;i;)switch(i=!1,n.kind){case x.Array:for(var a=n.nodes,o=a.length-1;!i&&o>=0;o-=1)for(var u=a[o],c=u.length-1;!i&&c>=0;c-=1){r(l=u[c])&&(n=l,i=!0)}break;case x.App:var s=n.args;for(c=s.length-1;!i&&c>=0;c-=1){r(l=s[c])&&(n=l,i=!0)}break;case x.Paren:var l;r(l=n.node)&&(n=l,i=!0);break;case x.Bad:case x.Name:case x.CellRef:case x.Literal:break;default:T("getSubExpressionFromPosition",n)}return n}function wt(e,t){var r=-1,n=document.elementFromPoint(e,t);if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(r=i.offset);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(r=i.startOffset)}else try{var i;(i=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(n),a.setEndPoint("EndToStart",i),r=a.text.length}catch(e){return r}for(;null!=n&&"SPAN"===n.nodeName;)null!=(n=n.previousSibling)&&null!=n.textContent&&(r+=n.textContent.length);return r}lt[qe.Add]=rt,lt[qe.Sub]=rt,lt[qe.Mul]=rt,lt[qe.Div]=rt,lt[qe.Pow]=rt,lt[qe.Percent]=nt,lt[qe.Neg]=nt,lt[qe.At]=Ye[He.SINGLE],lt[qe.Pound]=Ye[He.ANCHORARRAY],lt[qe.Pos]=it,lt[qe.Concat]=at,lt[qe.Eq]=ot,lt[qe.Ne]=ot,lt[qe.Lt]=ot,lt[qe.Le]=ot,lt[qe.Gt]=ot,lt[qe.Ge]=ot,lt[qe.Range]=ut,lt[qe.Isect]=ct,lt[qe.Union]=ct,lt[qe.And]=st,lt[qe.Or]=st,lt[qe.Xor]=st,lt[qe.Min]=rt,lt[qe.Max]=rt,lt[qe.Dot]=Ye[He._FV],ht(He.ROW,ne.OwnRow),ht(He.COLUMN,ne.OwnCol),ht(He.SHEET,ne.OwnDocSheets),ht(He.SHEETS,ne.OwnDocSheets),ht(He.OFFSET,ne.AllCells),ht(He.INDIRECT,ne.AllCells),ht(He.SUMIF,ne.AllCells),ht(He.AVERAGEIF,ne.AllCells),ht(He.ADDRESS,ne.RefStyle),ht(He.FORMULATEXT,ne.RefStyle),ht(He.NOW,ne.Time),ht(He.TODAY,ne.Time),ht(He.RAND,ne.Calc),ht(He.RANDBETWEEN,ne.Calc),ht(He.RANDARRAY,ne.Calc),ht(He.SUBTOTAL,ne.CellProps),ht(He.CELL,ne.CellProps|ne.AllCells),ht(He.INFO,ne.None),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(ze||(ze={})),function(e){e.JavaScriptError="JavaScriptError"}(Ze||(Ze={}));var _t,Dt=[];function Mt(e){return 0===function(e){if(1===e.args.length){var t=e.args[0];if(t.kind===x.Literal&&Vt(t.oper)===te.Missing)return 0}return e.args.length}(e)?Dt:e.args}function Ut(e){return e.kind===x.Operator}function Gt(e){return e.kind===x.Name&&void 0===e.qualifier}function xt(e,t,r){var n=e.headTypes,i=e.restTypes,a=e.tailTypes;if(N("calc.runtime.getArgType: n",r),F("calc.runtime.getArgType: i",t,r),t<n.length)return n[t];if(0===i.length)return re.None;var o=(r-n.length)%i.length;return o>a.length?re.None:t>=r-o?a[t-(r-o)]:i[(t-n.length)%i.length]}function Pt(e,t){var r=e.minArgs,n=e.headTypes,i=e.restTypes,a=e.tailTypes;return!(t<r)&&(t<=n.length||0!==i.length&&(t-n.length)%i.length<=a.length)}function Vt(e){switch(typeof e){case"number":return te.Number;case"string":return te.String;case"boolean":return te.Boolean;default:return e.kind}}function Wt(e){return"number"==typeof e&&isFinite(e)}function Bt(e,t,r){if(typeof t!=typeof e)return!1;if("object"!=typeof t||"object"!=typeof e)return t===e;if(t.kind!==e.kind)return!1;switch(t.kind){case te.Error:return t.type===e.type;case te.Rich:return r;case te.Array:var n=e;if(t.cols!==n.cols||t.rows!==n.rows)return!1;for(var i=0;i<t.rows;i+=1)for(var a=t.opers[i],o=n.opers[i],u=0;u<t.cols;u+=1)if(!Bt(o[u],a[u],r))return!1;return!0;case te.Blank:return!0;default:return T("calc.lang.readOperEq",t)}}!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(_t||(_t={}));var Ht=V(V({},Ze),_t);function jt(e){return{kind:Ht.NotImplemented,features:e}}function Kt(e){return 0===e.length&&k("calc.lang.unavailable: expected nonempty array"),{kind:Ht.Unavailable,objects:e}}var qt,Jt=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function Xt(e){if(null!=e){var t=e.path,r=e.name;return null!=t&&"string"!=typeof t?(O.ULS.traceTag(595969803,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"Illegal document path: type is "+typeof t),$t):"string"!=typeof r?(O.ULS.traceTag(595969804,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"Illegal document name: type is "+typeof r),$t):e}}function Yt(e){return{kind:qt.Cell,range:e}}function Qt(e){return{kind:qt.Range,range:e}}function zt(e,t){switch(e){case qt.Cell:return Rt(t)?Yt(t):k("calc.lang.lexicalSourceGrid: expected cell");case qt.Range:return Qt(t)}}function Zt(e){return{kind:qt.NameManager,name:e}}(Jt.prototype=Object.create(Error.prototype)).constructor=Jt,function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect"}(qt||(qt={}));var $t=er(void 0,"");function er(e,t){return{path:e,name:t}}function tr(e,t,r){return{document:e,index:t,index2:r,length:1}}function rr(e,t){return tr(e,t,t)}function nr(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function ir(e,t,r,n){return F("calc.lang.gridRange",e,1<<20),F("calc.lang.gridRange",t,16384),L("calc.lang.gridRange",r,(1<<20)-e),L("calc.lang.gridRange",n,16384-t),nr(e,t,r,n)}function ar(e,t){return F("calc.lang.gridCell",e,1<<20),F("calc.lang.gridCell",t,16384),nr(e,t,1,1)}function or(e,t){return{sheet:e,range:t}}var ur=or,cr=or,sr=or,lr=or;function fr(e){return{document:e,index:void 0}}function dr(e,t){return void 0===t?fr(e):rr(e,t)}function hr(e,t){return{scope:e,name:t}}function vr(e,t){return{document:e,path:t}}function pr(e,t){return{wrap:e,unwrap:t}}function mr(e){return e}function gr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function Cr(e){return null!=e}function Sr(e){return null==e}function Er(e,t){return Cr(e)?e:t}function yr(e,t){return[e,t]}function Rr(e,t){return e<t?e:t}function Or(e,t){return e<t?t:e}function Ir(e){return e<0?-e:e}function Tr(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}var kr="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};function Ar(e){return 32===e||10===e}function br(e,t,r,n){F("calc.parse.parseUint",t,16);for(var i=0,a=n,o=r.length;a<o;a+=1){var u=r.charCodeAt(a);if(!e.isNumeral(u))break;var c=e.getOrdinal(u);0===i&&0!==c&&(o=Rr(o,a+t)),i=10*i+c}return a===o&&a<r.length&&e.isNumeral(r.charCodeAt(a))?[0,n]:[i,a]}var Nr=43,Fr=45;function Lr(e,t,r,n){var i=n,a=0,o="";if(v(r,e.decimalSeparator,n)||r.length>n&&e.isNumeral(r.charCodeAt(n))){for(;i<r.length;i+=1){var u=r.charCodeAt(i);if(!e.isNumeral(u))break;if(0!==e.getOrdinal(u))break}for(var c=i;i<r.length;i+=1){u=r.charCodeAt(i);if(!e.isNumeral(u))break;a+=1}o+=r.substring(c,i);var s=!1;if(v(r,e.decimalSeparator,i)&&(s=i===n,i+=e.decimalSeparator.length),0===a)for(;i<r.length;i+=1){u=r.charCodeAt(i);if(!e.isNumeral(u))break;if(0!==e.getOrdinal(u))break;a-=1}for(c=i;i<r.length;i+=1){u=r.charCodeAt(i);if(!e.isNumeral(u))break}if(o+=r.substring(c,i),!(s&&i<=n+e.decimalSeparator.length)){var l=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(n+1<t.length&&"**"===t.substring(n,n+2)))return[0,r];n+=2}var i=!1;if(n<t.length){var a=t.charCodeAt(n);((i=a===Fr)||a===Nr)&&(n+=1)}if(n>=t.length||!e.isNumeral(t.charCodeAt(n)))return!1;var o=br(e,10,t,n),u=o[0],c=o[1];return c!==n&&(!(u>2147483647)&&[i?-u:u,c])}(e,r,i);if(!1!==l)a+=l[0],i=l[1];return!1===l||Ir(a)>=309?{value:void 0,i:i}:{value:t.parse(e,!0,a,o),i:i}}}}var wr=1<<20,_r=wr.toString(10).length,Dr=16384,Mr=Dr.toString(26).length,Ur=Dr.toString(10).length;function Gr(e){return e>=97&&e<=122||e>=65&&e<=90}function xr(e){return 1+(e>=97?e-97:e-65)}function Pr(e,t,r){return function(n,i,a,o){var u=function(e,t){return"$"===e[t]?[U.Abs,t+1]:[U.Rel,t]}(a,o),c=u[0],s=u[1],l=e(n,r,a,s),f=l[0],d=l[1];if(d>s){if(f<1||f>t)return;return[$(c,(c===U.Rel?f-i:f)-1),!1,d]}return[void 0,!1,o]}}function Vr(e,t,r){return tn(e,t,r)-e}function Wr(e,t,r,n){return function(i,a,o,u){var c=t?e?"R":i.rowLetter:e?"C":i.columnLetter;if(u>=o.length||0!==i.stringCompareCI(c,o[u]))return[void 0,!1,u];var s=u+1,l=br(i,n,o,s),f=l[0],d=l[1];if(d>s){if(f<1||f>r)return;return[$(U.Abs,f-1),!1,d]}if(o[s]===i.leftBracket){if(o[s+=1]===i.rightBracket)return[$(U.Rel,Vr(a,0,r)),!0,s+1];var h=1;"+"===o[s]?s+=1:"-"===o[s]&&(h=-1,s+=1);var v=br(i,n,o,s),p=v[0],m=v[1];if(m>s&&p<r&&o[m]===i.rightBracket)return[$(U.Rel,Vr(a,p*h,r)),!0,m+1]}return[!1,!1,d]}}function Br(e,t,r,n,i,a,o){var u=n(e,t,a,o);if(null==u)return[void 0,void 0,o];var c=u[0],s=u[1],l=u[2];if(l>o){var f=i(e,r,a,l);if(null==f)return s?[c,void 0,l]:[void 0,void 0,o];var d=f[0],h=f[2];return h>l?[c,d,h]:[c,void 0,l]}var v=i(e,r,a,o);if(null==v)return[void 0,void 0,o];var p=v[0],m=v[2];return m>o?[void 0,p,m]:[void 0,void 0,o]}var Hr=Pr(br,wr,_r),jr=Pr((function(e,t,r,n){return function(e,t,r){for(var n=0,i=r,a=Math.min(t.length,r+e);i<a;i+=1){var o=t.charCodeAt(i);if(!Gr(o))break;n=26*n+xr(o)}return i===a&&Gr(t.charCodeAt(i))?[0,r]:[n,i]}(t,r,n)}),Dr,Mr),Kr=Wr(!1,!0,wr,_r),qr=Wr(!1,!1,Dr,Ur),Jr=Wr(!0,!0,wr,_r),Xr=Wr(!0,!1,Dr,Ur);function Yr(e,t,r,n,i){var a,o=r.col,u=r.row;if(t===_.A1){var c=Br(e,o,u,jr,Hr,n,i),s=c[0],l=c[1],f=c[2];if(null!=l&&null!=s||null!=l&&l.kind===U.Abs||null!=s&&s.kind===U.Abs||(null!=l||null!=s)&&(":"===n[i-1]||":"===n[f])){if(f>=n.length||!e.isIdentContinue(n.charCodeAt(f)))return{refStyle:_.A1,row:l,col:s,i:f};if("."===n[f])return}}var d=!1,h=Br(e,u,o,Kr,qr,n,i),v=h[0],p=h[1],m=h[2];if(null!=v||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(d=!0,v=(a=Br(e,u,o,Jr,Xr,n,i))[0],p=a[1],m=a[2]),null!=v||null!=p){var g=null!=v&&!1!==v||null!=p&&!1!==p;if(m>=n.length||g||!e.isIdentContinue(n.charCodeAt(m)))return{refStyle:_.R1C1,row:v,col:p,i:m,enLocale:d}}}function Qr(e,t){var r=Br(e,0,0,jr,Hr,t,0),n=r[0],i=r[1],a=r[2];return void 0!==n&&void 0!==i&&a===t.length?ar(i.index,n.index):void 0}function zr(e,t){var r=Br(e,0,0,jr,Hr,t,0),n=r[0],i=r[1],a=r[2];if(void 0!==n&&void 0!==i){if(a===t.length)return ar(i.index,n.index);if(":"===t[a]){var o=Br(e,0,0,jr,Hr,t,a+1),u=o[0],c=o[1],s=o[2];if(void 0!==u&&void 0!==c&&s===t.length){var l=Rr(i.index,c.index),f=Rr(n.index,u.index);return ir(l,f,Or(i.index,c.index)+1-l,Or(n.index,u.index)+1-f)}}}}var Zr=$(U.Abs,0),$r=$(U.Abs,1048575);function en(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r}function tn(e,t,r){return e+t&r-1}function rn(e,t,r,n){if(t.kind===U.Abs)return t.index;if(n)return tn(e,t.index,r);var i=e+t.index;return 0<=i&&i<r?i:void 0}function nn(e,t,r,n,i,a){var o=rn(r,n,i,a);if(void 0!==o){if(n.kind===U.Abs)return t+(o+1).toFixed();var u=o-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function an(e,t,r,n,i){return t===_.A1?function(e,t,r){var n=rn(e,t,1<<20,r);if(void 0!==n){var i=(n+1).toFixed();return t.kind===U.Abs?"$"+i:i}}(r,n,i):nn(e,e.rowLetter,r,n,1<<20,i)}function on(e,t,r,n,i){return t===_.A1?function(e,t,r){var n=rn(e,t,16384,r);if(void 0!==n){var i=en(n);return t.kind===U.Abs?"$"+i:i}}(r,n,i):nn(e,e.columnLetter,r,n,16384,i)}function un(e,t,r,n){if(r.kind===U.Abs)return r;var i=rn(t,r,e,n);if(void 0!==i){var a=i-t;return a===r.index?r:$(U.Rel,a)}}un.bind(void 0,1<<20),un.bind(void 0,16384);function cn(e,t,r,n,i){var a=rn(e,t,n,i),o=rn(e,r,n,i);if(void 0!==a&&void 0!==o)return a<=o?[t,r,a,o]:[r,t,o,a]}function sn(e,t,r,n,i,a,o,u,c){var s=cn(a,o,u,r,c);if(void 0!==s){var l=s[0],f=s[1],d=s[2],h=s[3];if(void 0!==t&&0===d&&h===r-1&&o.kind===u.kind)return t(n,i,c);var v=e(n,i,a,l,c);if(void 0!==v){if(i===_.R1C1&&l.kind===f.kind&&l.index===f.index)return v;var p=e(n,i,a,f,c);if(void 0!==p)return v+":"+p}}}var ln=sn.bind(void 0,an,void 0,1<<20),fn=sn.bind(void 0,on,(function(e,t,r){return ln(e,t,0,Zr,$r,r)}),16384);function dn(e,t,r,n,i,a){var o=cn(r,n,i,t,a);if(void 0!==o){var u=o[0],c=o[1],s=o[2],l=o[3];if(void 0!==e&&0===s&&l===t-1&&n.kind===i.kind)return e;var f=un(t,r,u,a),d=un(t,r,c,a);if(void 0!==f&&void 0!==d)return[!1,f,d]}}dn.bind(void 0,void 0,1<<20),dn.bind(void 0,[!0,Zr,$r],16384);function hn(e,t,r,n,i,a){var o=an(e,t,r.row,n,a),u=on(e,t,r.col,i,a);if(void 0!==o&&void 0!==u)return t===_.A1?u+o:o+u}function vn(e,t,r,n,i,a,o,u){var c=cn(r.row,n,a,1<<20,u),s=cn(r.col,i,o,16384,u);if(void 0!==c&&void 0!==s){var l=c[0],f=c[1],d=c[2],h=c[3],v=s[0],p=s[1],m=s[2],g=s[3];if(0===m&&16383===g&&i.kind===o.kind)return ln(e,t,r.row,l,f,u);if(0===d&&1048575===h&&n.kind===a.kind)return fn(e,t,r.col,v,p,u);var C=hn(e,t,r,l,v,u),S=hn(e,t,r,f,p,u);if(void 0!==C&&void 0!==S)return C+":"+S}}var pn=/'/g;function mn(e,t){if(0===t.length)return!1;if(!e.isIdentStart(t.charCodeAt(0)))return!1;for(var r=1;r<t.length;r+=1)if(!e.isIdentContinue(t.charCodeAt(r)))return!1;return!0}var gn=ar(0,0);function Cn(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=Yr(e,t,gn,r,0);if(void 0!==n){var i=n.refStyle,a=n.i;if(i!==_.A1)return!0;if(void 0===e.getWorksheetFuncId(r.substring(0,a)))return!0}return!mn(e,r)&&(!function(e,t){var r=0;if(t.substring(r,r+e.leftBracket.length)!==e.leftBracket)return!1;if((r+=e.leftBracket.length)===t.length||!e.isIdentContinue(t.charCodeAt(r)))return!1;for(r+=1;;){if(t.substring(r,r+e.rightBracket.length)===e.rightBracket){r+=e.rightBracket.length;break}if(r===t.length||!e.isIdentContinue(t.charCodeAt(r)))return!1;r+=1}var n=t.indexOf(":",r);return n<0?mn(e,t.substring(r)):mn(e,t.substring(r,n))&&mn(e,t.substring(n+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&mn(e,t.substring(r,t.length-n))))}(e,r))}function Sn(e,t,r){return Cn(e,t,r)?"'"+r.replace(pn,"''")+"'":r}function En(e,t,r){var n=1===t.cols&&1===t.rows?hn(e,_.A1,ar(0,0),$(U.Rel,t.row),$(U.Rel,t.col),!1):vn(e,_.A1,ar(0,0),$(U.Rel,t.row),$(U.Rel,t.col),$(U.Rel,t.row+t.rows-1),$(U.Rel,t.col+t.cols-1),!1);return A("calc.lang.formatGridRangeA1",void 0!==n),void 0===r?n:Sn(e,_.A1,r)+"!"+n}var yn,Rn={ULS:new d.NulLogger},On=Object(d.initStopwatchFactory)((function(e){return Rn.ULS.traceTag(595948114,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,e)}));function In(e,t){return B(this,void 0,void 0,(function(){var r;return H(this,(function(n){switch(n.label){case 0:r=On(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,t()];case 2:return[2,n.sent()];case 3:return r.stop(),[7];case 4:return[2]}}))}))}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcSupportRowReference="CalcSupportRowReference",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcLetFunction="CalcLetFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcFunFunctions="CalcFunFunctions",e.CalcWebWorker="CalcWebWorker",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcLogStopWatch="CalcLogStopWatch",e.CalcDynamicArrayOperators="CalcDynamicArrayOperators",e["OfficeVSO:3832565_CalcCGRowColRefs"]="OfficeVSO:3832565_CalcCGRowColRefs",e["OfficeVSO:3832568_CalcCGGetUsedRange"]="OfficeVSO:3832568_CalcCGGetUsedRange",e["OfficeVSO:3852168_CalcCGAVERAGEIF"]="OfficeVSO:3852168_CalcCGAVERAGEIF",e["OfficeVSO:3852168_CalcCGCOUNT"]="OfficeVSO:3852168_CalcCGCOUNT",e["OfficeVSO:3852168_CalcCGCOUNTIF"]="OfficeVSO:3852168_CalcCGCOUNTIF",e["OfficeVSO:3852168_CalcCGMEDIAN"]="OfficeVSO:3852168_CalcCGMEDIAN",e["OfficeVSO:3852168_CalcCGSUMIF"]="OfficeVSO:3852168_CalcCGSUMIF",e["OfficeVSO:3852168_CalcCGROWS"]="OfficeVSO:3852168_CalcCGROWS",e["OfficeVSO:3852168_CalcCGCOLUMNS"]="OfficeVSO:3852168_CalcCGCOLUMNS",e["OfficeVSO:3852168_CalcCGINDEX"]="OfficeVSO:3852168_CalcCGINDEX",e["OfficeVSO:3852168_CalcCGMATCH"]="OfficeVSO:3852168_CalcCGMATCH",e["OfficeVSO:3852168_CalcCGHLOOKUP"]="OfficeVSO:3852168_CalcCGHLOOKUP",e["OfficeVSO:3852168_CalcCGVLOOKUP"]="OfficeVSO:3852168_CalcCGVLOOKUP",e["OfficeVSO:3852168_CalcCGLARGE"]="OfficeVSO:3852168_CalcCGLARGE",e["OfficeVSO:3852168_CalcCGSMALL"]="OfficeVSO:3852168_CalcCGSMALL",e["OfficeVSO:3852168_CalcCGPERCENTILE"]="OfficeVSO:3852168_CalcCGPERCENTILE",e["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"]="OfficeVSO:3852168_CalcCGPERCENTILE_EXC",e["OfficeVSO:3852168_CalcCGQUARTILE"]="OfficeVSO:3852168_CalcCGQUARTILE",e["OfficeVSO:3852168_CalcCGQUARTILE_EXC"]="OfficeVSO:3852168_CalcCGQUARTILE_EXC",e["OfficeVSO:3852168_CalcCGTRIMMEAN"]="OfficeVSO:3852168_CalcCGTRIMMEAN",e["OfficeVSO:3852168_CalcCGTRUE"]="OfficeVSO:3852168_CalcCGTRUE",e["OfficeVSO:3852168_CalcCGFALSE"]="OfficeVSO:3852168_CalcCGFALSE",e["OfficeVSO:3852168_CalcCGNOT"]="OfficeVSO:3852168_CalcCGNOT",e["OfficeVSO:3852168_CalcCGNA"]="OfficeVSO:3852168_CalcCGNA",e["OfficeVSO:3852168_CalcCGAVERAGEA"]="OfficeVSO:3852168_CalcCGAVERAGEA",e["OfficeVSO:3852168_CalcCGMAXA"]="OfficeVSO:3852168_CalcCGMAXA",e["OfficeVSO:3852168_CalcCGMINA"]="OfficeVSO:3852168_CalcCGMINA",e["OfficeVSO:3852168_CalcCGXOR"]="OfficeVSO:3852168_CalcCGXOR",e["OfficeVSO:3852168_CalcCGT"]="OfficeVSO:3852168_CalcCGT",e["OfficeVSO:3852168_CalcCGN"]="OfficeVSO:3852168_CalcCGN",e["OfficeVSO:3852168_CalcCGHYPERLINK"]="OfficeVSO:3852168_CalcCGHYPERLINK",e["OfficeVSO:3852168_CalcCGAGGREGATE"]="OfficeVSO:3852168_CalcCGAGGREGATE",e["OfficeVSO:3852168_CalcCGSUBTOTAL"]="OfficeVSO:3852168_CalcCGSUBTOTAL",e["OfficeVSO:3852168_CalcCGVAR"]="OfficeVSO:3852168_CalcCGSVAR",e["OfficeVSO:3852168_CalcCGVARP"]="OfficeVSO:3852168_CalcCGVARP",e["OfficeVSO:3852168_CalcCGSTDEV"]="OfficeVSO:3852168_CalcCGSTDEV",e["OfficeVSO:3852168_CalcCGSTDEVP"]="OfficeVSO:3852168_CalcCGSTDEVP",e["OfficeVSO:3852168_CalcCGVARA"]="OfficeVSO:3852168_CalcCGSVARA",e["OfficeVSO:3852168_CalcCGVARPA"]="OfficeVSO:3852168_CalcCGVARPA",e["OfficeVSO:3852168_CalcCGSTDEVA"]="OfficeVSO:3852168_CalcCGSTDEVA",e["OfficeVSO:3852168_CalcCGSTDEVPA"]="OfficeVSO:3852168_CalcCGSTDEVPA",e["OfficeVSO:3852168_CalcCGMODE"]="OfficeVSO:3852168_CalcCGMODE",e["OfficeVSO:3852168_CalcCGMODE_MULT"]="OfficeVSO:3852168_CalcCGMODE_MULT",e["OfficeVSO:3852168_CalcCGTYPE"]="OfficeVSO:3852168_CalcCGTYPE",e["OfficeVSO:3852168_CalcCGERROR_TYPE"]="OfficeVSO:3852168_CalcCGERROR_TYPE",e["OfficeVSO:3852168_CalcCGAREAS"]="OfficeVSO:3852168_CalcCGAREAS",e["OfficeVSO:3852168_CalcCGSHEETS"]="OfficeVSO:3852168_CalcCGSHEETS",e["OfficeVSO:3852168_CalcCGROW"]="OfficeVSO:3852168_CalcCGROW",e["OfficeVSO:3852168_CalcCGCOLUMN"]="OfficeVSO:3852168_CalcCGCOLUMN",e["OfficeVSO:3852168_CalcCGSHEET"]="OfficeVSO:3852168_CalcCGSHEET",e["OfficeVSO:3852168_CalcCGOFFSET"]="OfficeVSO:3852168_CalcCGOFFSET",e["OfficeVSO:3852168_CalcCGEXACT"]="OfficeVSO:3852168_CalcCGEXACT",e["OfficeVSO:3852168_CalcCGREPT"]="OfficeVSO:3852168_CalcCGREPT",e["OfficeVSO:3852168_CalcCGTRIM"]="OfficeVSO:3852168_CalcCGTRIM",e["OfficeVSO:3852168_CalcCGCLEAN"]="OfficeVSO:3852168_CalcCGCLEAN",e["OfficeVSO:3852168_CalcCGCHAR"]="OfficeVSO:3852168_CalcCGCHAR",e["OfficeVSO:3852168_CalcCGUNICHAR"]="OfficeVSO:3852168_CalcCGUNICHAR",e["OfficeVSO:3852168_CalcCGCODE"]="OfficeVSO:3852168_CalcCGCODE",e["OfficeVSO:3852168_CalcCGUNICODE"]="OfficeVSO:3852168_CalcCGUNICODE",e["OfficeVSO:3852168_CalcCGLOWER"]="OfficeVSO:3852168_CalcCGLOWER",e["OfficeVSO:3852168_CalcCGUPPER"]="OfficeVSO:3852168_CalcCGUPPER",e["OfficeVSO:3852168_CalcCGPROPER"]="OfficeVSO:3852168_CalcCGPROPER",e["OfficeVSO:3852168_CalcCGISFORMULA"]="OfficeVSO:3852168_CalcCGISFORMULA",e["OfficeVSO:3852168_CalcCGFORMULATEXT"]="OfficeVSO:3852168_CalcCGFORMULATEXT",e["OfficeVSO:3852168_CalcCGINFO"]="OfficeVSO:3852168_CalcCGINFO",e["OfficeVSO:3852168_CalcCGDELTA"]="OfficeVSO:3852168_CalcCGDELTA",e["OfficeVSO:3852168_CalcCGGESTEP"]="OfficeVSO:3852168_CalcCGGESTEP",e["OfficeVSO:3852168_CalcCGTRANSPOSE"]="OfficeVSO:3852168_CalcCGTRANSPOSE",e["OfficeVSO:3852168_CalcCGADDRESS"]="OfficeVSO:3852168_CalcCGADDRESS",e["OfficeVSO:3852168_CalcCGINDIRECT"]="OfficeVSO:3852168_CalcCGINDIRECT",e["OfficeVSO:3852168_CalcCGTEXTJOIN"]="OfficeVSO:3852168_CalcCGTEXTJOIN",e["OfficeVSO:3852168_CalcCGCHOOSE"]="OfficeVSO:3852168_CalcCGCHOOSE",e["OfficeVSO:3852168_CalcCGSQRTPI"]="OfficeVSO:3852168_CalcCGSQRTPI",e["OfficeVSO:3852168_CalcCGFACTDOUBLE"]="OfficeVSO:3852168_CalcCGFACTDOUBLE",e["OfficeVSO:3852168_CalcCGINT"]="OfficeVSO:3852168_CalcCGINT",e["OfficeVSO:3852168_CalcCGTRUNC"]="OfficeVSO:3852168_CalcCGTRUNC",e["OfficeVSO:3852168_CalcCGODD"]="OfficeVSO:3852168_CalcCGODD",e["OfficeVSO:3852168_CalcCGMROUND"]="OfficeVSO:3852168_CalcCGMROUND",e["OfficeVSO:3852168_CalcCGQUOTIENT"]="OfficeVSO:3852168_CalcCGQUOTIENT",e["OfficeVSO:3852168_CalcCGFLOOR.MATH"]="OfficeVSO:3852168_CalcCGFLOOR.MATH",e["OfficeVSO:3852168_CalcCGFLOOR.PRECISE"]="OfficeVSO:3852168_CalcCGFLOOR.PRECISE",e["OfficeVSO:3852168_CalcCGCEILING.MATH"]="OfficeVSO:3852168_CalcCGCEILING.MATH",e["OfficeVSO:3852168_CalcCGCEILING.PRECISE"]="OfficeVSO:3852168_CalcCGCEILING.PRECISE"}(yn||(yn={}));var Tn,kn=function(e){return!1},An={};function bn(e){return void 0===An[e]&&(An[e]=kn(e)),An[e]}function Nn(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],i=e[r+1],a=n;a<i;a+=1)t(a,n,i)}!function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(Tn||(Tn={}));var Fn=function(e,t,r){var n;function i(e){n[e]|=Tn.IdentStartClass}function a(e){n[e]|=Tn.IdentContinueClass}function o(e,t){n[e]|=Tn.DigitClass,n[e]|=e-t}return function(u){if(void 0===n){var c=Or(e[e.length-1],Or(t[t.length-1],r[r.length-1]));n=new Uint8Array(c),Nn(e,i),Nn(t,a),Nn(r,o);for(var s=4969;s<4978;s+=1)o(s,4968)}var l=n[u];return void 0!==l?l:0}}([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2238,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3333,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12731,12784,12800,13312,19894,19968,40944,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42951,42999,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43880,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[46,47,48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2238,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3332,3333,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6847,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11160,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12731,12736,12772,12784,12831,12832,19894,19904,40944,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42951,42999,43052,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43880,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]);function Ln(e,t){return{key:e,value:t}}var wn=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([e,t])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],i=this.values[r];e(n,i)&&t.push([n,i])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return Ln(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return},e.prototype.setValues=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.keys.map((function(t,r){return[t,e.values[r],r]})),i=n.length;t.forEach((function(e,t){var r=e[0],a=e[1];return n.push([r,a,t+i])})),n.sort((function(t,r){var n=t[0],i=t[2],a=r[0],o=r[2],u=e.keyCompare(n,a);return 0!==u?u:i-o}));for(var a=[],o=void 0,u=0;u<n.length;u+=1){var c=n[u],s=c[0],l=c[1];void 0===o||0!==this.keyCompare(s,o)?(a.push([s,l]),o=s):a[a.length-1]=[s,l]}return this.ofSequence(a)},e.prototype.getKeyIndex=function(e){for(var t=_n;t>=0&&t<this.keys.length;){var r=this.keyCompare(e,this.keys[t]);if(0===r)return t;r<0?t=Dn(t):r>0&&(t=Mn(t))}},e.prototype.ofSequence=function(t){var r=this,n=t.slice();n.sort((function(e,t){var n=e[0],i=t[0];return r.keyCompare(n,i)}));for(var i=new Array(n.length),a=new Array(n.length),o=function(e){var t=new Array(e);return function e(t,r,n,i){if(t>=r.length)return;var a=function(e){var t=function(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}(e);if(t/2-1<=e-t)return t-1;return e-t/2}(i);r[t]=n+a,e(Dn(t),r,n,a),e(Mn(t),r,n+a+1,i-a-1)}(_n,t,0,e),t}(n.length),u=0;u<n.length;u+=1){var c=n[o[u]],s=c[0],l=c[1];i[u]=s,a[u]=l}return new e(this.keyCompare,i,a)},e}(),_n=0;function Dn(e){return 2*e+1}function Mn(e){return 2*e+2}function Un(e){return isFinite(e)?e:De}function Gn(e,t){return e<t?-1:e>t?1:0}var xn=["0","1","2","3","4","5","6","7","8","9"];function Pn(e){var t=Wn.trunc(e);return t<-2147483648||t>2147483647?-2147483648:t}var Vn=Pn,Wn={zero:0,one:1,pi:Math.PI,add:function(e,t){return Un(e+t)},sub:function(e,t){return Un(e-t)},mul:function(e,t){return Un(e*t)},div:function(e,t){return 0===t?Fe:Un(e/t)},power:function(e,t){var r=Math.pow(e,t);return isFinite(r)?r:isNaN(r)?Fe:De},percent:function(e){return e/100},neg:function(e){return-e},compare:Gn,formatGeneral:function(e,t,r){var n=e.decimalSeparator,i=String(t).replace("e","E");return"."!==n&&(i=i.replace(".",n)),i},parse:function(e,t,r,n){return Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",i=0;i<t.length;i+=1)n+=xn[r(t.charCodeAt(i))];return n}(e,n)+"E"+r)},trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)},ceil:Math.ceil.bind(Math),floor:Math.floor.bind(Math),abs:Math.abs.bind(Math),cond:function(e){return Gn(e,0)},cond2:Gn,fromNumber:mr,toNumber:mr,sqrt:function(e){return Un(Math.sqrt(e))},exp:function(e){return Un(Math.exp(e))},ln:function(e){return Un(Math.log(e))},log:function(e){return Un(Math.log(e)/Math.LN10)},sin:Math.sin.bind(Math),cos:Math.cos.bind(Math),tan:Math.tan.bind(Math),asin:function(e){return Un(Math.asin(e))},acos:function(e){return Un(Math.acos(e))},atan:function(e){return Un(Math.atan(e))},atan2:function(e,t){return Math.atan2(t,e)},round:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.substring(r.indexOf("e")+1),i=parseInt(n,10),a=Wn.trunc(t)+i+1;if(0===a){var o=parseFloat("5e"+n);if(Math.abs(e)>=o)return Un((e<0?-1:1)*parseFloat("10e"+n))}return a<1?0:a>21?e:Un(parseFloat(e.toExponential(a-1)))},roundUp:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),i="-"===r.substring(0,1)?"-":"",a=r.substring(i.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Wn.trunc(t)+u+1;return c<1?Un(parseFloat(i+"10e"+(u-c))):c>21?e:Un(parseFloat(i+function(e,t){var r=e.replace(".","");if(r.length<=t)return e;for(var n=r.substring(0,t),i=0,a=n.length-1;a>=0&&n.charCodeAt(a)-48==9;a-=1)i+=1;if(i===n.length)return"10";var o=n.substring(0,n.length-i-1)+String.fromCharCode(n.charCodeAt(n.length-i-1)+1);return o.substring(0,1)+"."+o.substring(1)}(a,c)+"e"+o))},roundDown:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),i="-"===r.substring(0,1)?"-":"",a=r.substring(i.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Wn.trunc(t)+u+1;if(c<1)return 0;if(c>21)return e;var s=a.substring(0,c+1);return Un(parseFloat(i+s+"e"+o))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=Math.abs(e);return t>=4294967296?4294967295:Math.floor(t)},lfix:Pn,sfix:Vn,viewRound:mr},Bn=Math.pow(2,-52),Hn=Math.pow(2,-1022);function jn(e){return Math.abs(e)<Hn?0:e}function Kn(e){return isFinite(e)?jn(e):De}var qn=Math.pow(2,32)-2;function Jn(e,t){var r=Math.pow(e,t);return isFinite(r)?jn(r):t<0?Fe:De}var Xn=Wn.fix,Yn=Wn.lfix;var Qn,zn={zero:0,one:1,pi:Math.PI,add:function(e,t){var r=e+t;return isFinite(r)?jn(r):De},sub:function(e,t){var r=e-t;return isFinite(r)?jn(r):De},mul:function(e,t){return Kn(e*t)},div:function(e,t){return 0===jn(t)?Fe:Kn(e/t)},power:function(e,t){return 0===t?0===e?De:1:0===e?t<0?Fe:0:e>0?Jn(e,t):function(e){if(e<-qn||e>qn)return!1;if(e===Math.floor(e))return!0;var t=Math.abs(e);return 1+-22.5*Bn<=t&&t<=1+2*Bn}(t)?Jn(e,Math.round(t)):De},percent:function(e){return jn(e/100)},neg:Wn.neg,compare:Wn.compare,formatGeneral:Wn.formatGeneral,parse:Wn.parse,trunc:Wn.trunc,ceil:Wn.ceil,floor:Wn.floor,abs:Wn.abs,cond:Wn.cond,cond2:Wn.cond2,fromNumber:mr,toNumber:mr,sqrt:function(e){return Kn(Math.sqrt(e))},exp:function(e){return Kn(Math.exp(e))},ln:function(e){return Kn(Math.log(e))},log:function(e){return Kn(Math.log(e)/Math.LN10)},sin:function(e){return Math.abs(e)<Math.pow(2,27)?Kn(Math.sin(e)):De},cos:function(e){return Math.abs(e)<Math.pow(2,27)?Kn(Math.cos(e)):De},tan:function(e){return Math.abs(e)<Math.pow(2,27)?Kn(Math.tan(e)):De},asin:function(e){return Kn(Math.asin(e))},acos:function(e){return Kn(Math.acos(e))},atan:function(e){return Kn(Math.atan(e))},atan2:function(e,t){return 0===e&&0===t?Fe:jn(Math.atan2(t,e))},round:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),i="-"===r.substring(0,1)?"-":"",a=r.substring(i.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Wn.trunc(t)+u+1;return 0===c&&a.charCodeAt(0)-48>=5?Kn(parseFloat(i+"10e"+o)):c<1?0:c>21?e:Kn(parseFloat(i+function(e,t){var r=e.replace(".","");if(r.length<=t)return e;if(r.charCodeAt(t)-48>=5){for(var n=r.substring(0,t),i=0,a=n.length-1;a>=0&&n.charCodeAt(a)-48==9;a-=1)i+=1;if(i===n.length)return"10";var o=n.substring(0,n.length-i-1)+String.fromCharCode(n.charCodeAt(n.length-i-1)+1);return o.substring(0,1)+"."+o.substring(1)}return e.substring(0,t+1)}(a,c)+"e"+o))},roundUp:Wn.roundUp,roundDown:Wn.roundDown,checkAlmostCancellation:function(e,t){return t},fix:Xn,lfix:Yn,sfix:function(e){var t=e+1048576+2146435072;return t<0?-2147483648:Xn(t)-2147483648},viewRound:mr};function Zn(){return zn}function $n(e,t,r){return void 0===t&&(t=_.A1),void 0===r&&(r=Zn()),{localeInfo:e,refStyle:t,mathpack:r}}var ei=!1,ti=void 0;function ri(e,t,r){if(ei){O.ULS.traceTag(595910878,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{var n;if(I(e),function(e){Rn.ULS=e}(e),"function"==typeof(n=t)&&(kn=n),null!=r&&!/(^https:\/\/)|(^http:\/\/)/.test(r)){var i="calc.config.initCalc: calcAbsUrl is not absolute: "+r;O.ULS.traceTag(595910879,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,i)}ti=r,ei=!0;var a="calc.config.initCalc: Calc version "+f+" (production) initialized";O.ULS.traceTag(594642132,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,a)}}function ni(){return ei}function ii(){return ti}function ai(e,t,r,n,i,a,o,u,c,s,l,f,d,h,v,p,m,g,C,S,E,y){function R(e){return 92===e||95===e||u(String.fromCharCode(e))}return oi(e,r,n,(function(e){return i(String.fromCharCode(e))}),(function(e){return a(String.fromCharCode(e))}),R,(function(e){return R(e)||46===e||63===e||i(String.fromCharCode(e))}),c,s,l,f,d,h,v,p,m,g,C,S,E,y)}function oi(e,t,r,n,i,a,o,u,c,s,l,f,d,h,v,p,m,g,C,S,E){return{parseNumber:e,getWorksheetFuncId:function(e){return t(e.toLocaleUpperCase())},getWorksheetFuncName:r,isNumeral:n,getOrdinal:i,isIdentStart:a,isIdentContinue:o,stringCompareCI:u,errorNames:c,trueName:s,falseName:l,rowLetter:f,columnLetter:d,leftBrace:h,rightBrace:v,leftBracket:p,rightBracket:m,decimalSeparator:g,listSeparator:C,columnSeparator:S,rowSeparator:E}}function ui(e){return function(t){for(var r=0;r<t.length&&Ar(t.charCodeAt(r));)r+=1;var n=!1;if(r<t.length){var i=t.charCodeAt(r);if(43===i||45===i)for(n=45===i,r+=1;r<t.length&&Ar(t.charCodeAt(r));)r+=1}var a=Lr(this,e,t,r);if(void 0!==a&&void 0!==a.value){for(r=a.i;r<t.length&&Ar(t.charCodeAt(r));)r+=1;if(r===t.length)return n?e.neg(a.value):a.value}}}function ci(e){return 0!=(Fn(e)&Tn.DigitClass)}function si(e){var t=Fn(e);return 0==(t&Tn.DigitClass)?k("calc.config.getOrdinal: expected numeral; given "+S(e)):t&Tn.Ordinal}function li(e){return 0!=(Fn(e)&Tn.IdentStartClass)}function fi(e){return 0!=(Fn(e)&Tn.IdentContinueClass)}var di=p(((Qn={})[Te.NULL]="#NULL!",Qn[Te.DIV0]="#DIV/0!",Qn[Te.VALUE]="#VALUE!",Qn[Te.REF]="#REF!",Qn[Te.NAME]="#NAME?",Qn[Te.NUM]="#NUM!",Qn[Te.NA]="#N/A",Qn[Te.GETTING_DATA]="#GETTING_DATA",Qn[Te.FIELD]="#FIELD",Qn)),hi=void 0;function vi(e){var t=mi()[e];return void 0===t?"wsf:"+e:t}var pi=/_/g;function mi(){if(null==hi)for(var e in hi=[],He){var t=Number(e);if(!isNaN(t)){var r=Je[t],n=null!=r?r:He[e].replace(pi,".");hi[t]=n}}return hi}function gi(e,t){var r=function(e,t){var r,n=[];return t.forEach((function(e,t){null!=e&&n.push([e,t])})),(r=wn.create(e)).setValues.apply(r,n)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?k("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}var Ci=void 0;function Si(){var e,t,r,n,i;return null==Ci&&(e=mi(),t=Tr("en-US"),r=gi(t,e),n=r.getWorksheetFuncId,i=r.getWorksheetFuncName,Ci=oi(ui(Zn()),n,i,ci,si,li,fi,t,di,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")),Ci}var Ei,yi=M,Ri=D,Oi=Y,Ii=ar,Ti=rr,ki=tr,Ai=ur,bi=fr,Ni=hr,Fi=Ft,Li=mt,wi=Ht,_i=jt;function Di(e){return{kind:Ei.NoOriginSheet,origin:e}}function Mi(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case wi.NotImplemented:case wi.Unavailable:case Ei.NoOriginSheet:return!0}return!1}function Ui(e,t,r){return function(n,i){return void 0===i?t(n):Mi(i)?r(i,n):e(i)}}function Gi(e){return function(t){if(Mi(t))return t;if(!Array.isArray(t)){var r=e(t);return void 0===r?void 0:[t,r]}for(var n=0;n<t.length;n+=1){var i=t[n],a=e(i);if(void 0!==a)return[i,a]}}}function xi(e,t,r){var n=rn(e.row,t.row,1<<20,r),i=rn(e.col,t.col,16384,r);return void 0!==n&&void 0!==i?Ii(n,i):void 0}function Pi(e,t){var r=e.originGridCell;if(!Li(r))return r.reason;var n=r.value,i=e.wrapCellReferences;switch(t.kind){case yi.Error:return;case yi.Single:return xi(n,t,i);case yi.Range:var a=xi(n,t.ref1,i),o=xi(n,t.ref2,i);return void 0!==a&&void 0!==o?Fi(a,o):void 0;case yi.Row:if(bn(yn["OfficeVSO:3832565_CalcCGRowColRefs"])){var u=rn(n.row,t.row1,1<<20,i),c=rn(n.row,t.row2,1<<20,i);return void 0!==u&&void 0!==c?Fi(Ii(u,0),Ii(c,16383)):void 0}return _i(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case yi.Col:if(bn(yn["OfficeVSO:3832565_CalcCGRowColRefs"])){var s=rn(n.col,t.col1,16384,i),l=rn(n.col,t.col2,16384,i);return void 0!==s&&void 0!==l?Fi(Ii(0,s),Ii(1048575,l)):void 0}return _i(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return T("calc.runtime.resolverService.resolveGridRef",t)}}function Vi(e){function t(t,r){if(!Cr(r)){var n=t.originSheet;return Li(n)?n.value.document:n.reason}var i=e.getDocumentLoc(r.path,r.document);return Cr(i)?i:void 0}function r(r,n){var i=t(r,n.document);if(!Mi(i)){var a=e.getSheetIndex(i,n.sheet);return Li(a)?Cr(a.value)?Ti(i,a.value):void 0:a.reason}}return{resolveName:function(n,i,a){var o;if(Sr(i)||i.kind===Ri.Relative){var u=n.originSheet;if(!Li(u))return u.reason;var c=u.value;if(void 0===c.index)return Di(c);if(void 0===e.getNameLoc){var s=a.toLocaleUpperCase();return[Ni(c,s),Ni(bi(c.document),s)]}var l=e.getNameLoc(c,a);if(l.kind===ze.Failure)return l.reason;if(!Sr(l.value))return l.value;o=bi(c.document)}else{var f=function(n,i){switch(i.kind){case Ri.Document:var a=t(n,i);return Mi(a)?a:bi(a);case Ri.Sheet:return r(n,i);case Ri.Ident:var o=t(n,void 0);if(Mi(o))return o;var u=e.getSheetIndex(o,i.name);if(!Li(u))return u.reason;if(Cr(u.value))return Ti(o,u.value);var c=t(n,Oi(i.name));return Mi(c)?c:bi(c);default:return T("calc.runtime.resolverService.resolveNameQualifier",i)}}(n,i);if(Mi(f))return f;o=f}if(void 0===e.getNameLoc){s=a.toLocaleUpperCase();return Ni(o,s)}var d=e.getNameLoc(o,a);return d.kind===ze.Failure?d.reason:Sr(d.value)?void 0:d.value},resolveGridRef:Pi,resolveCellRef:function(n,i,a){var o,u=Pi(n,a);if(Mi(u))return u;if(Sr(i)||i.kind===Ri.Relative){var c=n.originSheet;if(!Li(c))return c.reason;var s=c.value;if(void 0===s.index)return Di(s);o=s}else{var l=function(n,i){switch(i.kind){case Ri.Error:return;case Ri.Sheet:return r(n,i);case Ri.SheetRange:var a=t(n,i.document);if(Mi(a))return;var o=e.getSheetIndex(a,i.sheet1);if(!Li(o))return o.reason;var u=e.getSheetIndex(a,i.sheet2);if(!Li(u))return u.reason;var c=o.value,s=u.value;if(Sr(c)||Sr(s))return;return ki(a,c,s);default:return T("calc.runtime.resolverService.resolveCellRefQualifier",i)}}(n,i);if(Mi(l))return l;o=l}return Ai(o,u)},resolveUserDefinedFunc:function(r,n,i){var a;if(Sr(n)){var o=r.originSheet;if(!Li(o))return o.reason;a=o.value.document}else{var u=function(e,r){switch(r.kind){case Ri.Document:return t(e,r);case Ri.Ident:return t(e,Oi(r.name));default:return T("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,n);if(Mi(u))return u;a=u}if(void 0===e.getUserDefinedFuncLoc)return _i(["getUserDefinedFuncLoc"]);var c=e.getUserDefinedFuncLoc(a,i);return c.kind===ze.Failure?c.reason:0!==c.value.length?c.value:void 0}}}!function(e){e.NoOriginSheet="NoOriginSheet"}(Ei||(Ei={}));function Wi(e,t,r){return void 0===r&&(r=100),t.maxDepth=r,t.level=0,Bi(e,t)}function Bi(e,t){if(t.level===t.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+t.level;var r;switch(t.level+=1,e.kind){case x.Literal:r=function(e,t){if("boolean"==typeof e)return t.visitBoolean(e);if("number"==typeof e)return t.visitNumber(e);if("string"==typeof e)return t.visitString(e);if(e.kind===te.Missing)return t.visitMissing(e);if(e.kind===te.Error)return t.visitError(e);throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,t.operVisitor);break;case x.Array:r=t.visitArray(e);break;case x.App:r=t.visitApp(e);break;case x.Paren:r=t.visitParen(e);break;case x.Name:r=t.visitName(e);break;case x.CellRef:r=t.visitCellRef(e);break;case x.Bad:r=t.visitBad(e);break;case x.Operator:r=t.visitOperator(e);break;case M.Error:r=t.visitRefError(e);break;case M.Single:r=t.visitSingle(e);break;case M.Range:r=t.visitRange(e);break;case M.Row:r=t.visitRow(e);break;case M.Col:r=t.visitCol(e);break;case D.Error:r=t.visitNameError(e);break;case D.Relative:r=t.visitRelative(e);break;case D.Document:r=t.visitDocument(e);break;case D.Sheet:r=t.visitSheet(e);break;case D.Ident:r=t.visitIdent(e);break;case D.SheetRange:r=t.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return t.level-=1,r}function Hi(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitError:e}}function ji(e,t,r){return{level:0,operVisitor:e,visitArray:Er(r.vArray,t),visitApp:Er(r.vApp,t),visitParen:Er(r.vParen,t),visitName:Er(r.vName,t),visitCellRef:Er(r.vCellRef,t),visitBad:Er(r.vBad,t),visitOperator:Er(r.vOperator,t),visitRefError:Er(r.vRefError,t),visitSingle:Er(r.vSingle,t),visitRange:Er(r.vRange,t),visitRow:Er(r.vRow,t),visitCol:Er(r.vCol,t),visitNameError:Er(r.vNameError,t),visitRelative:Er(r.vRelative,t),visitDocument:Er(r.vDocument,t),visitSheet:Er(r.vSheet,t),visitIdent:Er(r.vIdent,t),visitSheetRange:Er(r.vSheetRange,t)}}var Ki,qi=/"/g,Ji=/'/g,Xi=sr(rr(er(void 0,"Book1"),0),ar(0,0)),Yi=function(){function e(e,t,r,n,i){var a,o,u,c,s,l;this.spans=r,this.annotations=n,this.anonymize=i,this.level=0,this.operVisitor=this,this.locals=t,this.localeInfo=null!=(u=null===(o=null===(a=t)||void 0===a?void 0:a.config)||void 0===o?void 0:o.localeInfo)?u:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!=(l=null===(s=null===(c=t)||void 0===c?void 0:c.config)||void 0===s?void 0:s.refStyle)?l:e.config.refStyle}return e.prototype.anon=function(e){return this.anonymize?Ca(e):e},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.pre)?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.post)?n:t},e.prototype.visitString=function(e){return'"'+this.anon(e).replace(qi,'""')+'"'},e.prototype.visitBoolean=function(e){return e?this.localeInfo.trueName:this.localeInfo.falseName},e.prototype.visitNumber=function(e){return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,20))},e.prototype.visitMissing=function(e){return""},e.prototype.visitError=function(e){var t=this.localeInfo.errorNames[e.type];if(void 0===t)throw"No locale data for error oper";return t},e.prototype.visitArray=function(e){var t=this,r=[];return e.nodes.forEach((function(e){var n=[];e.forEach((function(e){n.push(Bi(e,t))})),r.push(n.join(t.localeInfo.columnSeparator))})),this.localeInfo.leftBrace+r.join(this.localeInfo.rowSeparator)+(e.isClosed?this.localeInfo.rightBrace:"")},e.prototype.visitApp=function(e){var t=this;if(Ut(e.head)){var r=Bi(e.head,this);if(1===e.args.length){var n=Bi(e.args[0],this);switch(e.head.id){case qe.Percent:return n+this.pre(e.head,"")+r;case qe.Pound:return n+r;default:return r+this.post(e.head,"")+n}}if(2===e.args.length){var i=Bi(e.args[0],this),a=Bi(e.args[1],this);return i+this.pre(e.head," ")+r+this.post(e.head,e.head.id===qe.Isect?"":" ")+a}throw"Tried to pretty print operator with 0 or more than 2 operators"}var o=e.args.map((function(e,r){return t.pre(e,0===r||function(e){return e.kind===x.Literal&&"object"==typeof e.oper&&e.oper.kind===te.Missing}(e)?"":" ")+Bi(e,t)}));return this.visitAppFormulaHead(e.head)+"("+o.join(this.localeInfo.listSeparator)+(0===e.args.length?"":this.post(e.args[e.args.length-1],""))+(e.isClosed?")":"")},e.prototype.visitParen=function(e){return"("+this.pre(e.node,"")+Bi(e.node,this)+this.post(e.node,"")+(e.isClosed?")":"")},e.prototype.visitName=function(e){var t="";return void 0!==e.qualifier&&(t=Bi(e.qualifier,this)+"!"),t+this.anon(e.whole)},e.prototype.visitCellRef=function(e){var t="";return void 0!==e.qualifier&&(t=Bi(e.qualifier,this)+"!"),t+Bi(e.ref,this)},e.prototype.visitBad=function(e){var t=this;if(e.type===P.Sequence){var r=[];return e.contents.forEach((function(e){r.push(t.pre(e,"")+Bi(e,t)+t.post(e,""))})),r.join("")}return this.pre(e,"")+this.anon(e.contents)+this.post(e,"")},e.prototype.visitOperator=function(e){switch(e.id){case qe.Isect:return"";case qe.Union:return this.localeInfo.listSeparator;default:var t=$e[e.id];if(void 0===t)throw"Invalid operator";return t}},e.prototype.visitRefError=function(){var e=this.localeInfo.errorNames[Te.REF];if(void 0===e)throw"No locale data for #REF";return e},e.prototype.visitSingle=function(e){var t=hn(this.localeInfo,this.refStyle,this.locals.origin.range,e.row,e.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRange=function(e){var t=vn(this.localeInfo,this.refStyle,this.locals.origin.range,e.ref1.row,e.ref1.col,e.ref2.row,e.ref2.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRow=function(e){var t=ln(this.localeInfo,this.refStyle,this.locals.origin.range.row,e.row1,e.row2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitCol=function(e){var t=fn(this.localeInfo,this.refStyle,this.locals.origin.range.col,e.col1,e.col2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitNameError=function(e){var t=this.localeInfo.errorNames[Te.REF];if(void 0===t)throw"No locale data for #REF";return t.replace("!","")},e.prototype.visitRelative=function(e){return""},e.prototype.visitDocument=function(e){return Sn(this.localeInfo,this.refStyle,this.anon(void 0!==e.path?e.path+"/"+e.document:e.document))},e.prototype.visitSheet=function(e){return Sn(this.localeInfo,this.refStyle,this.anon((void 0!==e.document?this.visitSheetDocument(e.document):"")+e.sheet))},e.prototype.visitIdent=function(e){return Sn(this.localeInfo,this.refStyle,this.anon(e.name))},e.prototype.visitSheetRange=function(e){var t=this.anon((void 0!==e.document?this.visitSheetDocument(e.document):"")+e.sheet1),r=this.anon(e.sheet2),n=t+":"+r;return Cn(this.localeInfo,this.refStyle,t)||Cn(this.localeInfo,this.refStyle,r)?"'"+n.replace(Ji,"''")+"'":n},e.prototype.visitAppFormulaHead=function(e){var t,r,n=null===(t=this.annotations)||void 0===t?void 0:t[e.label];return(null===(r=n)||void 0===r?void 0:r.kind)===G.WorksheetFuncName?this.localeInfo.getWorksheetFuncName(n.id):Bi(e,this)},e.prototype.visitSheetDocument=function(e){return(void 0!==e.path?e.path:"")+this.localeInfo.leftBracket+e.document+this.localeInfo.rightBracket},e}();function Qi(e){return{kind:Ki.VisitorFailure,message:e}}function zi(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,origin:t,wrapCellReferences:!1}}function Zi(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,origin:t,wrapCellReferences:!0}}function $i(e,t,r,n){void 0===n&&(n=!1);try{var i=new Yi(e,t,r.spans,r.annotations,n);return vt("="+i.pre(r.node,"")+Wi(r.node,i))}catch(e){if(O.ULS.traceTag(595964180,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.lang.printFormula: Format failed: "+e),"string"==typeof e)return pt(Qi(e));throw e}}!function(e){e.VisitorFailure="VisitorFailure"}(Ki||(Ki={}));var ea={config:$n(Si(),_.A1)};function ta(e,t){try{var r=t.kind===qt.Cell||t.kind===qt.Range?zi(t,t.range):t.kind===qt.NameManager?Zi(t,Xi):T("calc.lang.anonymizeFormula",t),n=$i(ea,r,e,!0);if(n.kind===ze.Success)return n.value}catch(e){}return S(e)}var ra,na,ia,aa,oa,ua,ca,sa,la,fa,da,ha,va,pa=new RegExp("[^=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),ma=/[0-9]/g,ga=/d/g;function Ca(e){return e.toLowerCase().replace(ga,"w").replace(ma,"d").replace(pa,"w")}(na=ra||(ra={})).LexicalKind=qt,na.sheetRows=1<<20,na.sheetCols=16384,na.lexicalSourceCell=Yt,na.lexicalSourceRange=Qt,na.lexicalSourceName=Zt,na.documentLoc=er,na.sheetIndex=rr,na.sheetRange=tr,na.gridCell=ar,na.gridRange=ir,na.sheetGridCell=sr,na.sheetGridRange=cr,na.sheetGridCube=ur,na.originCell=lr,na.documentScope=fr,na.nameLoc=hr,na.nameScope=dr,na.userDefinedFuncLoc=vr,(aa=ia||(ia={})).SpecialPrecs=ne,aa.PrecsBound=oe,aa.OperKind=te,aa.ErrorType=Te,aa.ErrorTypeBounds=ke,aa.precedents=Ae,aa.errorOper=be,aa.nullErrorOper=Ne,aa.div0ErrorOper=Fe,aa.valueErrorOper=Le,aa.refErrorOper=we,aa.nameErrorOper=_e,aa.numErrorOper=De,aa.naErrorOper=Me,aa.gettingDataErrorOper=Ue,aa.fieldErrorOper=Ge,aa.arrayOper=Ve,aa.rangeSeqOper=We,aa.range3DOper=Be,aa.missingOper=je,aa.blankOper=Ke,(ua=oa||(oa={})).RefStyle=_,ua.QualifierKind=D,ua.CellRefKind=M,ua.PosKind=U,ua.NodeKind=x,ua.BadType=P,ua.errorQualifierLabeled=K,ua.relativeQualifierLabeled=q,ua.errorQualifier=J,ua.relativeQualifier=X,ua.documentQualifier=Y,ua.sheetQualifier=Q,ua.identQualifier=z,ua.sheetRangeQualifier=Z,ua.pos=$,ua.cellRefErrorLabeled=ee,ua.cellRefError=ue,ua.cellRefSingle=ce,ua.cellRefRange=se,ua.cellRefRow=le,ua.cellRefCol=fe,ua.formula=de,ua.formulaSpan=he,ua.literalNode=me,ua.arrayNode=ge,ua.appNode=Ce,ua.operatorNode=Se,ua.parenNode=Ee,ua.nameNode=ye,ua.cellRefNode=Re,ua.badNode=Oe,ua.AnnotationKind=G,ua.worksheetFuncNameAnnotation=ve,ua.localNameAnnotation=pe,(sa=ca||(ca={})).SignatureType=re,sa.FunctionFlags=ie,sa.OperatorId=qe,sa.WorksheetFuncId=He,sa.SpecialPrecs=ne,sa.functionType=Ie,sa.unknownFunctionType=Qe,sa.getOperatorType=ft,sa.getWorksheetFuncType=dt,(fa=la||(la={})).isSheetIndex=Ct,fa.isSheetGridRange=yt,fa.isGridCell=Et,fa.isSheetGridCell=Rt,fa.isDocumentLocEqual=It,fa.isSheetIndexEqual=Tt,fa.isGridCellEqual=kt,fa.isSheetGridCellEqual=At,fa.isWellFormed=St,fa.isUnqualifiedNameNode=Gt,fa.isOperatorNode=Ut,fa.gridRangeAnchor=bt,fa.sheetGridRangeAnchor=Nt,fa.gridCellRange=Ft,fa.getArguments=Mt,fa.getArgType=xt,fa.isValidArgsLength=Pt,fa.operKind=Vt,fa.ResultKind=ze,fa.success=vt,fa.failure=pt,fa.FailureError=Jt,fa.isSuccess=mt,fa.ReasonKind=Ht,fa.notImplemented=jt,fa.unavailable=Kt,fa.javaScriptError=gt,fa.columnName=en,fa.formatRow=an,fa.formatCol=on,fa.formatRowRange=ln,fa.formatColRange=fn,fa.formatCellPos=hn,fa.formatGridRangeA1=En,fa.parseGridCellA1=Qr,fa.parseGridRangeA1=zr,fa.getSubExpressionFromPosition=Lt,fa.getFormulaCharIndexFromPoint=wt,fa.ResolveReasonKind=Ei,fa.noOriginSheet=Di,fa.createResolver=Vi,fa.createResolutionHandler=Ui,fa.createNameFinder=Gi,fa.defaultLiteralVisitor=Hi,fa.defaultFormulaVisitor=ji,fa.dispatch=Bi,fa.startVisit=Wi,fa.printFormula=$i,fa.visitorFailure=Qi,fa.printLocalsGrid=zi,fa.printLocalsName=Zi,(ha=da||(da={})).LogCategory=d.LogCategory,ha.TraceLevel=d.TraceLevel,ha.localeInfo=ai,ha.localeInfo2=oi,ha.calcConfig=$n,ha.initCalc=ri,ha.createSimpleLocaleInfo=Si,ha.getEnglishLocaleInfo=Si,ha.createWorksheetFuncNameCallbacks=gi,ha.isCalcInit=ni,ha.getCalcAbsUrl=ii,(va||(va={})).ieeeMathpack=Wn;var Sa,Ea=la.ReasonKind,ya=la.notImplemented;function Ra(e){return{config:e}}function Oa(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,origin:t}}!function(e){e.BadFormulaString="BadFormulaString"}(Sa||(Sa={}));var Ia=V(V({},Ea),Sa),Ta=zi,ka=Zi;function Aa(e){return{kind:Ia.BadFormulaString,message:e}}function ba(e,t){var r=t-1;return function(t){if(t<=r){var n=e+": internal error: no progress made at index "+t;return O.ULS.assertTag(595980821,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=t}}function Na(e,t,r){for(var n=t;n<e.length&&r(e[n]);n+=1);return[e.substring(t,n),n]}function Fa(e,t,r,n,i){var a=e[t];return r(a)?1:a===n&&t+1<e.length&&i(e[t+1])?2:0}function La(e,t,r,n,i){for(var a=[],o=t,u=t;u<e.length;){var c=Fa(e,u,r,n,i);if(0===c)break;2===c&&(o!==u&&a.push(e.substring(o,u)),o=u+1),u+=c}return o!==u&&a.push(e.substring(o,u)),[a.join(""),u]}var wa,_a,Da,Ma,Ua=ca.OperatorId;function Ga(e,t,r){return{kind:e,start:t,chars:r}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(wa||(wa={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(_a||(_a={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(Da||(Da={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Ma||(Ma={}));var xa=function(e){return Ga(wa.End,e,"")},Pa=function(e,t){return Ga(wa.Spaces,e,t)};function Va(e,t,r){return void 0===r&&(r=!1),{kind:wa.Unexpected,start:e,chars:t,isQualPart:r}}var Wa=function(e,t){return Ga(wa.Ident,e,t)};function Ba(e,t,r,n){return{kind:e,start:t,chars:r,value:n}}var Ha=function(e,t){return Ba(wa.Left,e,t,_a.Bracket)},ja=function(e,t){return Ba(wa.Left,e,t,_a.Brace)},Ka=function(e){return Ba(wa.Right,e,")",_a.Paren)},qa=function(e,t){return Ba(wa.Right,e,t,_a.Bracket)},Ja=function(e,t){return Ba(wa.Right,e,t,_a.Brace)},Xa=function(e){return Ba(wa.Right,e,"'",_a.SQuote)},Ya=function(e,t){return Ba(wa.Sep,e,t,Da.List)},Qa=function(e,t){return Ba(wa.Sep,e,t,Da.Col)},za=function(e,t){return Ba(wa.Sep,e,t,Da.Row)},Za=function(e){return Ba(wa.Sep,e,"!",Da.Qual)},$a={"#ALL":function(e,t){return Ba(wa.SpecialRef,e,t,Ma.All)},"#DATA":function(e,t){return Ba(wa.SpecialRef,e,t,Ma.Data)},"#HEADERS":function(e,t){return Ba(wa.SpecialRef,e,t,Ma.Headers)},"#TOTALS":function(e,t){return Ba(wa.SpecialRef,e,t,Ma.Totals)},"#THIS ROW":function(e,t){return Ba(wa.SpecialRef,e,t,Ma.ThisRow)}};function eo(e,t,r,n,i,a,o,u,c){return{kind:wa.CellRef,start:e,chars:t,row:r,col:n,refStyle:i,isName:a,isNumber:o,isQualPart:u,isBadLocale:c}}function to(e){for(var t=0;t<e.length;t+=1)if("+"===e[t]||"-"===e[t]||"*"===e[t]||" "===e[t]||"/"===e[t])return!1;return!0}function ro(e,t,r,n){void 0===n&&(n=!0);var i="number"==typeof r&&to(t);return{kind:wa.Literal,start:e,chars:t,oper:r,hasRight:n,isQualPart:i}}function no(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?ro(t,r,!1):0===e.stringCompareCI(e.trueName,r)?ro(t,r,!0):Wa(t,r)}function io(e){var t=$e[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return function(r){return{kind:wa.Operator,start:r,chars:t,value:e}}}var ao=io(Ua.Add),oo=io(Ua.Sub),uo=io(Ua.Mul),co=io(Ua.Div),so=io(Ua.Pow),lo=io(Ua.Percent),fo=io(Ua.Concat),ho=io(Ua.Eq),vo=io(Ua.Lt),po=io(Ua.Gt),mo=io(Ua.Ne),go=io(Ua.Le),Co=io(Ua.Ge),So=io(Ua.Range),Eo=(io(Ua.And),io(Ua.Or),io(Ua.Xor),io(Ua.Dot),io(Ua.At)),yo=io(Ua.Pound);function Ro(e,t,r){return r.push(t),t.start+e}var Oo=oa.RefStyle,Io="+-*/^%&=<>:",To=!1;function ko(e){return!To&&bn(yn.CalcDynamicArrayOperators)&&(Io+="@#",To=!0),Io.indexOf(e)>=0}var Ao={"+":ao,"-":oo,"*":uo,"/":co,"^":so,"%":lo,"&":fo,"=":ho,"<":vo,">":po,":":So,"@":Eo,"#":yo},bo={"<>":mo,"<=":go,">=":Co};function No(e,t,r){if(t<e.length-1){var n=bo[e.substr(t,2)];if(null!=n)return Ro(2,n(t),r)}var i=Ao[e[t]];if(null!=i)return Ro(1,i(t),r);return O.ULS.assertTag(595980822,d.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function Fo(e,t,r,n,i){var a=Lr(e,t,r,n);if(void 0!==a){var o=a.value,u=a.i;if(void 0!==o)return Ro(u-n,ro(n,r.substring(n,u),o,!0),i),u;if(e.isNumeral(r.charCodeAt(n))){var c=r.substring(n,u);return Ro(u-n,Va(n,c,to(c)),i),u}}}function Lo(e,t,r){var n=La(e,t+1,(function(e){return'"'!==e}),'"',(function(e){return'"'===e})),i=n[0],a=n[1],o=e.substring(t,a+1);return a<e.length?Ro(a+1-t,ro(t,o,i,!0),r):Ro(a-t,ro(t,o,i,!1),r)}function wo(e,t,r,n){for(var i=1;i<e.errorNames.length;i+=1){var a=e.errorNames[i];if(void 0!==a){var o=t.substr(r,a.length);if(0===e.stringCompareCI(a,o))return Ro(a.length,ro(r,o,be(i)),n)}}}var _o=Object.getOwnPropertyNames($a);function Do(e,t,r,n){for(var i=0;i<_o.length;i+=1){var a=_o[i],o=t.substr(r,a.length);if(0===e.stringCompareCI(a,o))return Ro(a.length,$a[a](r,o),n)}}function Mo(e,t){return"'"!==t&&"#"!==t&&t!==e.leftBracket&&t!==e.rightBracket}function Uo(e,t,r,n){var i=Ro(1,Ha(r,t[r]),n);"#"===t[i]&&(null!=(s=Do(e,t,i,n))&&(i=s));for(var a=function(t){return Mo(e,t)},o=function(t){return!Mo(e,t)},u=ba("calc.parse.tokenizeBracketedColRef",i);i<t.length;){u(i);var c=t[i];if(c===e.rightBracket)return Ro(1,qa(i,c),n);if(Fa(t,i,a,"'",o)>0){var s,l=La(t,i,a,"'",o),f=l[0];i=Ro((s=l[1])-i,Wa(i,f),n)}else i=Ro(1,Va(i,c),n)}return i}function Go(e,t){return!Ar(t.charCodeAt(0))&&"'"!==t&&"#"!==t&&":"!==t&&t!==e.listSeparator&&t!==e.leftBracket&&t!==e.rightBracket}function xo(e,t,r,n){var i=Ro(1,Ha(r,t[r]),n);"#"===t[i]&&(null!=(f=Do(e,t,i,n))&&(i=f));for(var a=function(t){return Go(e,t)},o=function(t){return!Go(e,t)},u=ba("calc.parse.tokenizeBracketedRef",i);i<t.length;){u(i);var c=t[i];if(c===e.rightBracket)return Ro(1,qa(i,c),n);if(Fa(t,i,a,"'",o)>0){var s=La(t,i,a,"'",o),l=s[0];i=Ro((f=s[1])-i,Wa(i,l),n)}else if(Ar(c.charCodeAt(0))){var f,d=Na(t,i,(function(e){return Ar(e.charCodeAt(0))}));l=d[0];i=Ro((f=d[1])-i,Pa(i,l),n)}else i=":"!==c?c!==e.listSeparator?c!==e.leftBracket?Ro(1,Va(i,c),n):Uo(e,t,i,n):Ro(1,Ya(i,c),n):Ro(1,So(i),n)}return i}var Po;function Vo(e,t,r,n){for(var i,a=Ro(1,(i=r,Ba(wa.Left,i,"'",_a.SQuote)),n),o=function(t){return function(e,t){return"':*?".indexOf(t)<0&&t!==e.leftBracket&&t!==e.rightBracket}(e,t)},u=function(e){return"'"===e},c=ba("calc.parse.tokenizeQuotedQualifier",a);a<t.length;){c(a);var s=t[a];if("'"===s&&"'"!==t[a+1])return Ro(1,Xa(a),n);if(":"!==s)if(s!==e.leftBracket)if(Fa(t,a,o,"'",u)>0){var l=La(t,a,o,"'",u),f=l[0];a=Ro(l[1]-a,Wa(a,f),n)}else a=Ro(1,Va(a,s),n);else a=xo(e,t,a,n);else a=Ro(1,So(a),n)}return a}function Wo(e,t,r,n,i,a){var o,u,c,s,l,f,d,h=Yr(e,t,r,n,i);if(null!=h){var v=h.i,p=n.substring(v,i);return Ro(v-i,h.refStyle===Oo.A1?(o=i,u=p,c=h.row,s=h.col,l=null==c&&null!=s&&s.kind===oa.PosKind.Rel,f=null==s&&null!=c&&c.kind===oa.PosKind.Rel,d=!(null!=c&&c.kind!==oa.PosKind.Rel||null!=s&&s.kind!==oa.PosKind.Rel),eo(o,u,c,s,oa.RefStyle.A1,l,f,d,!1)):function(e,t,r,n,i){void 0===i&&(i=!1);var a=!(!1!==r&&null!=r&&r.kind!==oa.PosKind.Abs||!1!==n&&null!=n&&n.kind!==oa.PosKind.Abs);return eo(e,t,!1===r?oa.pos(oa.PosKind.Rel,0):r,!1===n?oa.pos(oa.PosKind.Rel,0):n,oa.RefStyle.R1C1,!1,!1,a,i)}(i,p,h.row,h.col,h.enLocale),a)}}function Bo(e,t,r,n){for(var i=e[t],a=t+1;a<e.length;a+=1){var o=e[a];if(o.kind!==r)break;i=n(i,o)}return[i,a]}function Ho(e,t,r,n,i,a){for(var o=function(e,t,r,n,i,a){for(var o,u=[],c=[],s=Po.Decimal,l=a,f=ba("calc.parse.tokenize",l);l<i.length;){f(l);var h=Wo(e,r,n,i,l,u);if(null==h){var v=i[l];if(s===Po.Decimal&&v===e.decimalSeparator||e.isNumeral(v.charCodeAt(0))){var p=Fo(e,t,i,l,u);if(null!=p){l=p,s=Po.FieldAccess;continue}if(v!==e.decimalSeparator){var m="calc.parse.tokenize: failed to tokenize numeral at "+l;return O.ULS.assertTag(595980823,d.LogCategory.msoulscat_ES_EWAJS,!1,m)}}if('"'!==v)if(e.isIdentStart(v.charCodeAt(0))){var g=Na(i,l,(function(t){return e.isIdentContinue(t.charCodeAt(0))})),C=g[0];l=Ro(g[1]-l,no(e,l,C),u),s=Po.FieldAccess}else if("#"!==v)if(ko(v))l=No(i,l,u),s=Po.Decimal;else if(Ar(v.charCodeAt(0))){var S=Na(i,l,(function(e){return Ar(e.charCodeAt(0))}));C=S[0];l=Ro(S[1]-l,Pa(l,C),u),s=Po.Decimal}else if("("!==v)if(")"!==v)if(v!==e.leftBrace)if(v!==e.rightBrace)if(v!==e.leftBracket)if(v!==e.rightBracket){if(c.length>0&&c[c.length-1]===_a.Brace){if(v===e.columnSeparator){l=Ro(1,Qa(l,v),u),s=Po.Decimal;continue}if(v===e.rowSeparator){l=Ro(1,za(l,v),u),s=Po.Decimal;continue}}v!==e.listSeparator?"!"!==v?"'"!==v?(l=Ro(1,Va(l,v),u),s=Po.Decimal):(l=Vo(e,i,l,u),s=Po.Decimal):(l=Ro(1,Za(l),u),s=Po.Decimal):(l=Ro(1,Ya(l,v),u),s=Po.Decimal)}else l=Ro(1,qa(l,v),u),s=Po.FieldAccess;else l=xo(e,i,l,u),s=Po.FieldAccess;else c.length>0&&c[c.length-1]===_a.Brace&&c.pop(),l=Ro(1,Ja(l,v),u),s=Po.FieldAccess;else c.push(_a.Brace),l=Ro(1,ja(l,v),u),s=Po.Decimal;else c.length>0&&c[c.length-1]===_a.Paren&&c.pop(),l=Ro(1,Ka(l),u),s=Po.FieldAccess;else c.push(_a.Paren),l=Ro(1,(o=l,Ba(wa.Left,o,"(",_a.Paren)),u),s=Po.Decimal;else{var E=wo(e,i,l,u);if(null!=E){l=E,s=Po.FieldAccess;continue}bn(yn.CalcDynamicArrayOperators)?(l=No(i,l,u),s=Po.Decimal):(l=Ro(1,Va(l,v),u),s=Po.Decimal)}else l=Lo(i,l,u),s=Po.FieldAccess}else l=h,s=Po.FieldAccess}return u}(e,t,r,n,i,a),u=[],c=0;c<o.length;){var s=o[c];if(s.kind!==wa.Unexpected)u.push(s),c+=1;else{var l=Bo(o,c,wa.Unexpected,(function(e,t){var r=e,n=t;return Va(r.start,r.chars+n.chars,r.isQualPart&&n.isQualPart)})),f=l[0],h=l[1];u.push(f),c=h}}return u.push(xa(i.length)),u}function jo(e,t,r,n){var i=void 0;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,n,(function(e,t){i=[e,t]}),(function(){i=!1}))),null==i){var a="calc.parse.runParser: internal error: parser did not call resolve or reject on "+S(t);return O.ULS.assertTag(595980827,d.LogCategory.msoulscat_ES_EWAJS,!1,a)}return i}function Ko(){var e={impl:function(e,t,r,n,i){return O.ULS.assertTag(595980828,d.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(t,r,n,i,a){return function(){return e.impl(t,r,n,i,a)}}};return e}function qo(e){return function(t,r,n,i,a){return i(e,r)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(Po||(Po={}));var Jo,Xo=function(e,t,r,n,i){return i};function Yo(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,n){return t(i,e)(r,n,i,a,o)}),o)}}function Qo(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(function(){return t(r,n,i,a,o)}))}}function zo(e){return 0===e.length?Xo:e.reduce(Qo)}function Zo(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(function(){return a(t,n)}))}}function $o(e,t){return function(r,n,i,a,o){var u=r[n];if(null==u)return o;var c=e(i,u);return null==c?o:a(c,n+t)}}function eu(e){return $o(e,1)}function tu(e){return $o(e,0)}function ru(e){return function(t,r,n,i,a){var o=t[r],u=t[r+1];if(null==o||null==u)return a;var c=e(n,o,u);return null==c?a:i(c,r+1)}}function nu(e,t,r){return function(n,i,a,o,u){var c=r,s=i;function l(){return e(n,s,a,f,h)}function f(e,r){if(r<=s){var i=S(n),o="calc.parse.reduce: internal error: no progress made at index "+s+" on "+i;return O.ULS.assertTag(595980829,d.LogCategory.msoulscat_ES_EWAJS,!1,o)}return c=t(a,e,c),s=r,l}function h(){return o(c,s)}return l}}function iu(e,t){return nu(e,(function(e,t,r){return r.push(t),r}),t)}function au(e){return function(t,r,n,i,a){return iu(e,[])(t,r,n,i,a)}}function ou(e,t){return Yo(e,(function(e,r){return iu(t,[r])}))}function uu(e){var t=e.length;return function(r,n,i,a,o){var u=n,c=[];function s(){return e[c.length](r,u,i,l,o)}function l(e,r){return u=r,c.push(e),c.length<t?s:a(c,u)}return s}}function cu(e,t){return uu([e,t])}function su(e,t,r,n,i){return uu([e,t,r,n,i])}function lu(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,r){return a(t(i,e),r)}),o)}}function fu(e,t,r){return lu(uu([e,t]),(function(e,t){return r(e,t[0],t[1])}))}function du(e,t,r,n){return lu(uu([e,t,r]),(function(e,t){return n(e,t[0],t[1],t[2])}))}function hu(e,t,r,n,i){return lu(uu([e,t,r,n]),(function(e,t){return i(e,t[0],t[1],t[2],t[3])}))}function vu(e,t,r,n,i,a){return lu(uu([e,t,r,n,i]),(function(e,t){return a(e,t[0],t[1],t[2],t[3],t[4])}))}function pu(e,t){return fu(e,t,(function(e,t,r){return t}))}function mu(e,t){return fu(e,t,(function(e,t,r){return r}))}function gu(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+S(t);return O.ULS.assertTag(595980824,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function Cu(e,t,r,n,i){var a=e.label;return e.label+=1,e.spans[a]=oa.formulaSpan(t,r,n,i),a}function Su(e,t,r,n){var i=gu(e,r);return i.pre=t,i.post=n,r}function Eu(e,t,r){return function(n,i,a,o,u){var c=a.leftDelim,s=a.listSep;return a.leftDelim=e,a.listSep=t,r(n,i,a,(function(e,t){return a.leftDelim=c,a.listSep=s,o(e,t)}),(function(){return a.leftDelim=c,a.listSep=s,u}))}}function yu(e,t){return t.kind===wa.Spaces||t.kind===wa.End?t.start:gu(e,t).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(Jo||(Jo={}));var Ru=Zo(eu((function(e,t){return t.kind===wa.Spaces?t.chars:void 0})),""),Ou=function(e,t,r,n,i){var a=e[t];if(null==a){var o="calc.parse.pStart: internal error: expected term at "+t+" in "+S(e);return O.ULS.assertTag(595980864,d.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(yu(r,a),t)};function Iu(e){return du(Ru,eu(e),Ru,Su)}function Tu(e){return fu(Ru,eu(e),(function(e,t,r){return Su(e,t,r,"")}))}function ku(e){return fu(eu(e),Ru,(function(e,t,r){return Su(e,"",t,r)}))}var Au=Iu((function(e,t){return t.kind!==oa.NodeKind.Operator||t.id!==ca.OperatorId.Add&&t.id!==ca.OperatorId.Sub?void 0:t})),bu=ku((function(e,t){if(t.kind===oa.NodeKind.Operator){if(t.id===ca.OperatorId.Add)return oa.operatorNode(ca.OperatorId.Pos,t.label);if(t.id===ca.OperatorId.Sub)return oa.operatorNode(ca.OperatorId.Neg,t.label)}}));function Nu(e,t){if(t.kind===oa.NodeKind.Operator&&t.id===ca.OperatorId.At)return oa.operatorNode(ca.OperatorId.At,t.label)}var Fu=ku(Nu),Lu=Tu((function(e,t){return t.kind===oa.NodeKind.Operator&&t.id===ca.OperatorId.Pound?t:void 0})),wu=Iu((function(e,t){return t.kind!==oa.NodeKind.Operator||t.id!==ca.OperatorId.Mul&&t.id!==ca.OperatorId.Div?void 0:t})),_u=Iu((function(e,t){return t.kind===oa.NodeKind.Operator&&t.id===ca.OperatorId.Pow?t:void 0})),Du=Tu((function(e,t){return t.kind===oa.NodeKind.Operator&&t.id===ca.OperatorId.Percent?t:void 0})),Mu=Iu((function(e,t){return t.kind===oa.NodeKind.Operator&&t.id===ca.OperatorId.Concat?t:void 0})),Uu=Iu((function(e,t){return t.kind===oa.NodeKind.Operator&&t.id>=ca.OperatorId.Eq&&t.id<=ca.OperatorId.Ge?t:void 0})),Gu=Iu((function(e,t){return t.kind===oa.NodeKind.Operator&&t.id===ca.OperatorId.Range?t:void 0})),xu=Iu((function(e,t){return t.kind===oa.NodeKind.Operator&&t.id===ca.OperatorId.Union?t:void 0})),Pu=ru((function(e,t,r){if(t.kind===wa.Spaces&&r.kind!==wa.End&&(r.kind!==oa.NodeKind.Operator||r.id===ca.OperatorId.At)){var n=Cu(e,t.start,yu(e,r),t.chars,"");return oa.operatorNode(ca.OperatorId.Isect,n)}}));function Vu(e,t,r,n){return void 0===n&&(n=e),fu(n,au(cu(t,e)),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function Wu(e,t,r){return fu(au(t),e,(function(e,t,n){return 0===t.length?n:t.reduceRight(r(e),n)}))}function Bu(e,t,r){return fu(e,au(t),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function Hu(e){return function(t,r){var n=r[0],i=r[1],a=gu(e,t).start,o=gu(e,i).end,u=Cu(e,a,o,"","");return oa.appNode(n,[t,i],!0,u)}}function ju(e){return function(t,r){var n=gu(e,t).start,i=gu(e,r).end,a=Cu(e,n,i,"","");return oa.appNode(r,[t],!0,a)}}function Ku(e){var t=!0;return function(r,n){var i=gu(e,n).start,a=gu(e,r).end,o=Cu(e,i,a,"","");if(t&&(t=!1,r.kind===oa.NodeKind.Literal&&"number"==typeof r.oper&&""===gu(e,n).post)){var u=n.id===ca.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return oa.literalNode(u,!0,o)}return oa.appNode(n,[r],!0,o)}}function qu(e){return function(t,r){var n=gu(e,r).start,i=gu(e,t).end,a=Cu(e,n,i,"","");return oa.appNode(r,[t],!0,a)}}var Ju,Xu,Yu,Qu,zu,Zu,$u,ec,tc,rc,nc,ic,ac,oc,uc=eu((function(e,t){return t.kind!==oa.NodeKind.Operator&&t.kind!==wa.Spaces&&t.kind!==wa.End?t:void 0}));function cc(e,t){var r=Cu(e,gu(e,t[0]).start,gu(e,t[t.length-1]).end,"","");return oa.badNode(oa.BadType.Sequence,t,r)}var sc=!1;function lc(e,t){!function(){if(!sc){if(bn(yn.CalcDynamicArrayOperators)){Ju=fu(Ou,au(uc),(function(e,t,r){return 0===r.length?oa.literalNode(ia.missingOper,!0,Cu(e,t,t,"","")):1===r.length?r[0]:cc(e,r)})),Xu=Bu(Ju,Lu,ju);var e=Ko(),t=mu(tu(Nu),e.parser);Yu=Vu(Qo(t,Xu),Gu,Hu,Xu),Qu=Vu(Qo(t,Yu),Pu,Hu,Yu),zu=Wu(Qu,Fu,qu),e.impl=zu,Zu=Vu(zu,xu,Hu),$u=Wu(Zu,bu,Ku),ec=Bu($u,Du,ju),tc=Vu(ec,_u,Hu),rc=Vu(tc,wu,Hu),nc=Vu(rc,Au,Hu),ic=Vu(nc,Mu,Hu),ac=Vu(ic,Uu,Hu)}else Yu=fu(Ou,au(uc),(function(e,t,r){return 0===r.length?oa.literalNode(ia.missingOper,!0,Cu(e,t,t,"","")):1===r.length?r[0]:cc(e,r)})),Qu=Vu(Yu,Gu,Hu),zu=Vu(Qu,Pu,Hu),Zu=Vu(zu,xu,Hu),$u=Wu(Zu,bu,Ku),ec=Bu($u,Du,ju),tc=Vu(ec,_u,Hu),rc=Vu(tc,wu,Hu),nc=Vu(rc,Au,Hu),ic=Vu(nc,Mu,Hu),ac=Vu(ic,Uu,Hu);oc=fu(ac,au(mu(tu((function(e,t){return t.kind===wa.End?void 0:t})),ac)),(function(e,t,r){return 0===r.length?t:cc(e,[t].concat(r))})),sc=!0}}();var r=e.length-1;if(r<0){var n="calc.parse.parseTerms: internal error: expected at least 1 term";return O.ULS.assertTag(595980865,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[0].kind===wa.Spaces){n="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+S(e);return O.ULS.assertTag(595980866,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&e[r-1].kind===wa.Spaces){n="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+S(e);return O.ULS.assertTag(595980867,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[r].kind!==wa.End){n="calc.parse.parseTerms: internal error: array[n].kind !== End in "+S(e);return O.ULS.assertTag(595980868,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i=jo(oc,e,0,t);if(!1===i){n="calc.parse.parseTerms: internal error: failed to parse "+S(e);return O.ULS.assertTag(595980869,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=i[0],o=i[1];if(o<r){n="calc.parse.parseTerms: internal error: consumed "+o+" out of "+r+" in "+S(e);return O.ULS.assertTag(595980870,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}return a}var fc=Zo(eu((function(e,t){return t.kind===wa.Spaces?t.chars:void 0})),""),dc=function(e,t,r,n,i){var a=e[t];if(null==a){var o="calc.parse.pStart: internal error: expected token at "+t+" in "+S(e);return O.ULS.assertTag(595980830,d.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(a.start,t)};function hc(e){return eu((function(t,r){return r.kind===wa.Sep&&r.value===e||void 0}))}function vc(e){return eu((function(t,r){return r.kind===wa.Left&&r.value===e?r.start:void 0}))}function pc(e){return eu((function(t,r){return r.kind===wa.Right&&r.value===e||void 0}))}var mc=hc(Da.List),gc=hc(Da.Row),Cc=hc(Da.Col),Sc=hc(Da.Qual),Ec=vc(_a.Paren),yc=pc(_a.Paren),Rc=vc(_a.Brace),Oc=pc(_a.Brace),Ic=vc(_a.SQuote),Tc=pc(_a.SQuote),kc=eu((function(e,t){return t.kind===wa.Operator&&t.value===ca.OperatorId.Range||void 0})),Ac=Ko(),bc=du(fc,Ac.parser,fc,Su),Nc=hu(Ec,Eu(_a.Paren,Jo.Union,bc),Zo(yc,!1),dc,(function(e,t,r,n,i){var a=Cu(e,t,i,"","");return oa.parenNode(r,n,a)})),Fc=ou(bc,mu(Cc,bc)),Lc=ou(Fc,mu(gc,Fc)),wc=hu(Rc,Eu(_a.Brace,Jo.Union,Lc),Zo(Oc,!1),dc,(function(e,t,r,n,i){var a=Cu(e,t,i,"","");return oa.arrayNode(r,n,a)})),_c=function(e){return e.kind===wa.Ident||e.kind===wa.CellRef&&e.isQualPart||e.kind===wa.Literal&&e.isQualPart||e.kind===wa.Unexpected&&e.isQualPart||e.kind===wa.Operator&&e.value===ca.OperatorId.Dot},Dc=ou(eu((function(e,t){return _c(t)&&t.chars.length>0&&46!==t.chars.charCodeAt(0)?t.chars:void 0})),eu((function(e,t){return _c(t)?t.chars:void 0}))),Mc=eu((function(e,t){return t.kind===wa.Ident?t.chars:void 0}));function Uc(e){return e.kind===wa.Literal&&"object"==typeof e.oper&&e.oper.kind===ia.OperKind.Error&&e.oper.type===ia.ErrorType.REF}function Gc(e,t,r,n){return null==t?[oa.identQualifier(e,r,n),r?"'"+e.replace(/'/g,"")+"'":e]:[oa.sheetRangeQualifier(e,t,void 0,r,n),r?"'"+e.replace(/'/g,"")+":"+t.replace(/'/g,"")+"'":e+":"+t]}var xc=hu(dc,Dc,Zo(mu(kc,Dc),void 0),dc,(function(e,t,r,n,i){var a=Cu(e,t,i,"","");return Gc(r.join(""),null!=n?n.join(""):void 0,!1,a)})),Pc=vu(Ic,Mc,Zo(mu(kc,Mc),void 0),Tc,dc,(function(e,t,r,n,i,a){return Gc(r,n,!0,Cu(e,t,a,"",""))})),Vc=hu(Ic,au(eu((function(e,t){return t.kind===wa.End||t.kind===wa.Right&&t.value===_a.SQuote?void 0:t.chars}))),Zo(cu(Tc,Zo(pu(Sc,fc),!1)),[!1,!1]),dc,(function(e,t,r,n,i){var a=n[0],o=n[1],u="'"+r.join("")+(a?"'":"")+(o?"!":""),c=Cu(e,t,i,"","");return[oa.badNode(oa.BadType.Qualifier,u,c),u]})),Wc=ru((function(e,t,r){if(Uc(t)){var n=Cu(e,t.start,r.start,"","");return[oa.errorQualifierLabeled(n),t.chars]}})),Bc=fu(zo([xc,Pc,tu((function(e,t){var r=Cu(e,t.start,t.start,"","");return[oa.relativeQualifierLabeled(r),""]}))]),pu(Sc,fc),(function(e,t,r){return[t[0],t[1]+"!"]})),Hc=zo([Wc,Bc,Vc]);function jc(e,t){return t.kind===wa.CellRef&&e.refStyle===t.refStyle&&!t.isBadLocale}var Kc=ru((function(e,t,r){return jc(e,t)?[t,r.start]:void 0}));function qc(e,t){if(null!=e.row&&null!=e.col)return oa.cellRefSingle(e.row,e.col,t);if(null!=e.row)return oa.cellRefRow(e.row,e.row,t);if(null!=e.col)return oa.cellRefCol(e.col,e.col,t);var r="calc.parse.cellRefToken2cellRef: bad token "+S(e);return O.ULS.assertTag(595980831,d.LogCategory.msoulscat_ES_EWAJS,!1,r)}var Jc=ru((function(e,t,r){if(jc(e,t)&&(t.refStyle!==oa.RefStyle.A1||null!=t.row&&null!=t.col))return qc(t,n=Cu(e,t.start,r.start,"",""));if(Uc(t)){var n=Cu(e,t.start,r.start,"","");return oa.cellRefErrorLabeled(n)}})),Xc=Qo(Yo(su(Kc,fc,kc,fc,Kc),(function(e,t){var r=t[0],n=r[0],i=r[1],a=t[1],o=(t[2],t[3]),u=t[4],c=u[0],s=u[1],l=Cu(e,n.start,i,"",a),f=Cu(e,c.start,s,o,""),d=qc(n,l),h=qc(c,f),v=void 0;if(d.kind===oa.CellRefKind.Single&&h.kind===oa.CellRefKind.Single){var p=Cu(e,n.start,s,"","");v=oa.cellRefRange(d,h,p)}else if(0===a.length&&0===o.length)if(d.kind===oa.CellRefKind.Row&&h.kind===oa.CellRefKind.Row){p=Cu(e,n.start,s,"","");v=oa.cellRefRow(d.row1,h.row1,p)}else if(d.kind===oa.CellRefKind.Col&&h.kind===oa.CellRefKind.Col){p=Cu(e,n.start,s,"","");v=oa.cellRefCol(d.col1,h.col1,p)}return null==v?Xo:n.isQualPart&&c.isQualPart?tu((function(e,t){return t.kind===wa.Sep&&t.value===Da.Qual?void 0:v})):qo(v)})),Jc),Yc=eu((function(e,t){return t.kind===wa.Ident||t.kind===wa.CellRef&&t.isName?t.chars:void 0})),Qc=Yo(su(dc,Hc,dc,Zo(Qo(Xc,Yc),void 0),dc),(function(e,t){var r=t[0],n=t[1],i=n[0],a=n[1],o=t[2],u=t[3],c=t[4];if(null==u)return i.kind!==oa.QualifierKind.SheetRange||i.isQuoted?i.kind===oa.QualifierKind.Error?qo(oa.literalNode(ia.refErrorOper,!0,i.label)):qo(i.kind===oa.NodeKind.Bad?i:oa.badNode(oa.BadType.Qualifier,a,i.label)):Xo;if("string"==typeof u){if(i.kind===oa.QualifierKind.SheetRange&&!i.isQuoted)return Xo;var s=Cu(e,r,c,"","");if(i.kind===oa.NodeKind.Bad||i.kind===oa.QualifierKind.Error||i.kind===oa.QualifierKind.SheetRange){var l=i.kind===oa.NodeKind.Bad?i:oa.badNode(oa.BadType.Qualifier,a,i.label),f=oa.nameNode(u,void 0,Cu(e,o,c,"",""));return qo(oa.badNode(oa.BadType.Sequence,[l,f],s))}return qo(oa.nameNode(u,i,s))}var d=Cu(e,r,c,"","");if(i.kind===oa.NodeKind.Bad||i.kind===oa.QualifierKind.Document){var h=i.kind===oa.NodeKind.Bad?i:oa.badNode(oa.BadType.Qualifier,a,i.label);f=oa.cellRefNode(u,void 0,Cu(e,o,c,"",""));return qo(oa.badNode(oa.BadType.Sequence,[h,f],d))}var v=i.kind===oa.QualifierKind.Ident?oa.sheetQualifier(i.name,void 0,i.isQuoted,i.label):i;return qo(oa.cellRefNode(u,v,d))})),zc=du(dc,Qo(Xc,Yc),dc,(function(e,t,r,n){var i=Cu(e,t,n,"","");return"string"==typeof r?oa.nameNode(r,void 0,i):r.kind===oa.CellRefKind.Error?oa.literalNode(ia.refErrorOper,!0,i):oa.cellRefNode(r,void 0,i)})),Zc=ru((function(e,t,r){if(t.kind===wa.Literal)return oa.literalNode(t.oper,t.hasRight,Cu(e,t.start,r.start,"",""));if(t.kind===wa.CellRef&&t.isNumber&&"object"==typeof t.row){var n=t.row.index+e.origin.row+1;return oa.literalNode(e.mathpack.fromNumber(n),!0,Cu(e,t.start,r.start,"",""))}}));function $c(e){return ru((function(t,r,n){if(e(r)){var i=Cu(t,r.start,n.start,"","");return oa.badNode(oa.BadType.Unexpected,r.chars,i)}}))}var es=$c((function(e){return e.kind===wa.Left&&e.value===_a.Bracket})),ts=$c((function(e){return e.kind===wa.Right&&e.value===_a.Bracket})),rs=vu(dc,es,Eu(_a.Bracket,Jo.Union,bc),Zo(ts,void 0),dc,(function(e,t,r,n,i,a){var o=[r,n];null!=i&&o.push(i);var u=Cu(e,t,a,"","");return oa.badNode(oa.BadType.Sequence,o,u)})),ns=ru((function(e,t,r){switch(t.kind){case wa.End:case wa.Operator:case wa.Spaces:return;case wa.Sep:if(t.value!==Da.Qual&&(e.leftDelim===_a.Brace||t.value!==Da.Col&&t.value!==Da.Row))return;break;case wa.Right:if(t.value===e.leftDelim)return}var n=t.kind===wa.CellRef?oa.BadType.CellRef:oa.BadType.Unexpected,i=Cu(e,t.start,r.start,"","");return oa.badNode(n,t.chars,i)})),is=ru((function(e,t,r){if((t.kind===wa.Ident||t.kind===wa.CellRef||t.kind===wa.Literal&&"boolean"==typeof t.oper)&&r.kind===wa.Left&&r.value===_a.Paren&&null!=e.localeInfo.getWorksheetFuncId(t.chars)){var n=Cu(e,t.start,r.start,"","");return oa.nameNode(t.chars,void 0,n)}})),as=hu(Ec,Eu(_a.Paren,Jo.Arg,ou(bc,mu(mc,bc))),Zo(yc,!1),dc,(function(e,t,r,n,i){return[r,n,i]})),os=fu(is,as,(function(e,t,r){var n=r[0],i=r[1],a=r[2],o=Cu(e,gu(e,t).start,a,"","");return oa.appNode(t,n,i,o)})),us=fu(zo([os,Qc,zc,Zc,Nc,wc,rs,ns]),au(as),(function(e,t,r){var n=gu(e,t).start;return r.reduce((function(t,r){var i=r[0],a=r[1],o=r[2],u=Cu(e,n,o,"","");return oa.appNode(t,i,a,u)}),t)})),cs=ru((function(e,t,r){var n=void 0;if(t.kind===wa.Operator&&(n=t.value),t.kind===wa.Sep&&t.value===Da.List&&e.listSep===Jo.Union&&(n=ca.OperatorId.Union),null!=n){var i=Cu(e,t.start,r.start,"","");return oa.operatorNode(n,i)}})),ss=eu((function(e,t){return t.kind===wa.Spaces?t:void 0})),ls=Qo(us,cs),fs=Yo(ls,(function(e,t){return nu(cu(Zo(ss,void 0),ls),(function(e,t,r){var n=t[0],i=t[1];return null!=n&&r.push(n),r.push(i),r}),[t])})),ds=fu(Zo(fs,void 0),dc,(function(e,t,r){if(null==t){var n=Cu(e,r,r,"","");return oa.literalNode(ia.missingOper,!0,n)}if(1===t.length){var i=t[0];if(i.kind!==oa.NodeKind.Operator&&i.kind!==wa.Spaces)return i}return t.push(xa(r)),lc(t,e)}));function hs(e,t,r,n,i,a){var o=a.length-1;if(o<0){var u="calc.parse.parseTokens: internal error: expected at least 1 token";return O.ULS.assertTag(595980832,d.LogCategory.msoulscat_ES_EWAJS,!1,u)}if(a[o].kind!==wa.End){u="calc.parse.parseTokens: internal error: array[n] !== End in "+S(a);return O.ULS.assertTag(595980833,d.LogCategory.msoulscat_ES_EWAJS,!1,u)}var c=function(e,t,r,n,i){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:i,leftDelim:void 0,listSep:Jo.Union,label:1,spans:[]}}(e,t,r,n,i),s=jo(bc,a,0,c);if(!1===s){u="calc.parse.parseTokens: internal error: failed to parse "+S(a);return O.ULS.assertTag(595980834,d.LogCategory.msoulscat_ES_EWAJS,!1,u)}var l=s[0],f=s[1];if(f<o){u="calc.parse.parseTokens: internal error: consumed "+f+" out of "+o+" in "+S(a);return O.ULS.assertTag(595980835,d.LogCategory.msoulscat_ES_EWAJS,!1,u)}return oa.formula(l,c.spans)}Ac.impl=ds;var vs={"=":1,"+":0,"-":0,"@":-1};function ps(e,t,r){var n,i,a,o,u=r[0],c=null!=u?vs[u]:void 0;if(null==c)return la.failure(Aa("first character is not '=', '+', '-' or '@'"));if(c<0)return la.failure(ya(["Lotus 1-2-3 syntax"]));var s=null!=(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?i:e.config.localeInfo,l=null!=(o=null===(a=t.config)||void 0===a?void 0:a.refStyle)?o:e.config.refStyle,f=e.config.mathpack,d=Ho(s,f,l,t.origin,r,c),h=hs(s,f,l,t.lexicalKind,t.origin,d);return la.success(h)}function ms(e){return{parseFormula:function(t,r,n,i){if("number"==typeof t){if(null==r){return O.ULS.assertTag(595980825,d.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: expected range to be defined")}var a=t,o=r;return ps(e,Oa(n,la.gridRangeAnchor(function(e){return void 0===e.range}(o)?o:o.range),{refStyle:a}),i)}return ps(e,t,r)},formatFormula:function(t,r){return la.printFormula(e,t,r)}}}var gs=oa.QualifierKind,Cs=oa.CellRefKind,Ss=oa.NodeKind,Es=la.ResultKind;function ys(e){return e.kind===Es.Success}function Rs(e,t){var r=e[t];return null==r?k("ParseResultHelper.getFormulaSpan: expected span for label "+t+" to be defined"):r}function Os(e,t,r){return!!ys(e)&&(function(e,t,r){if(null==e||null==r)return;var n={};null!=t?t.forEach((function(e){n[e]=!0})):n["*"]=!0;var i=[];i.push(e.node);for(;i.length>0;){var a=i.pop();if(null!=a)switch(a.kind){case Ss.Literal:c("literal")&&r("literal",{label:a.label,value:a});break;case Ss.Array:a.nodes.map((function(e){return e.map((function(e){i.push(e)}))}));break;case Ss.App:if("object"!=typeof a.head)c("literal")&&r("literal",{label:a.label,value:a.head});else{var o=a.head;switch(o.kind){case Ss.Operator:c("operator")&&r("operator",{label:a.label,value:o.id});break;case Ss.Name:c("function")&&r("function",{label:a.label,name:o.whole,isClosed:a.isClosed,args:a.args});break;default:i.push(o)}}a.args.map((function(e){i.push(e)}));break;case Ss.Paren:i.push(a.node);break;case Ss.Name:if(c("namedRange")){var u=a.whole.split(".");r("namedRange",{label:a.label,name:u[0],names:u.slice(1),qualifier:s(a)})}break;case Ss.CellRef:c("range")&&l(a);break;case Ss.Bad:break;default:return T("calc.parse.traverseFormula",a)}}function c(e){return n[e]||n["*"]}function s(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case gs.Sheet:var r=e.qualifier;t.type=gs.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case gs.SheetRange:var n=e.qualifier;t.type=gs.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case gs.Ident:var i=e.qualifier;t.type=gs.Ident,t.name=i.name;break;case gs.Document:var a=e.qualifier;t.document=a.document,null!=a.path&&(t.documentPath=a.path)}return t}}function l(t){if(null!=e&&null!=r)switch(t.ref.kind){case Cs.Error:break;case Cs.Col:var n=t.ref;r("range",{label:t.label,type:"col",startIndex:n.col1,endIndex:n.col2,span:Rs(e.spans,n.label),qualifier:s(t)});break;case Cs.Row:var i=t.ref;r("range",{label:t.label,type:"row",startIndex:i.row1,endIndex:i.row2,span:Rs(e.spans,i.label),qualifier:s(t)});break;case Cs.Single:var a=t.ref;r("range",{label:t.label,type:"cell",row:a.row,col:a.col,span:Rs(e.spans,a.label),qualifier:s(t)});break;case Cs.Range:var o=t.ref;r("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:Rs(e.spans,o.ref1.label),bottomRightSpan:Rs(e.spans,o.ref2.label),qualifier:s(t)})}}}(e.value,t,r),!0)}var Is,Ts,ks={isSuccess:ys,traverse:Os,extractReferences:function(e){if(ys(e)){var t=[];return Os(e,["range","namedRange"],(function(r,n){var i={kind:r,ref:n,span:Rs(e.value.spans,n.label)};t.push(i)})),t.sort((function(e,t){return e.span.start-t.span.start})),t}}};!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_binder="Invalid_binder",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unsupported_struct_ref="Unsupported_struct_ref",e.Unsupported_doc_qual="Unsupported_doc_qual"}(Is||(Is={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(Ts||(Ts={}));var As,bs,Ns=la.ReasonKind,Fs=la.FailureError;!function(e){e[e.General=0]="General",e[e.CurrencyDec=11]="CurrencyDec",e[e.CoCurrencyDec=12]="CoCurrencyDec",e[e.Percentage0=13]="Percentage0",e[e.Percentage=14]="Percentage",e[e.MMDDYY=19]="MMDDYY",e[e.HHMMAP=23]="HHMMAP",e[e.MDYHMS=27]="MDYHMS",e[e.AbsHMMSS=31]="AbsHMMSS"}(As||(As={})),function(e){e.BadOperation="BadOperation",e.BadFormula="BadFormula"}(bs||(bs={}));var Ls,ws,_s=V(V({},Ns),bs),Ds=Fs;function Ms(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r;t[e]=(null!=(r=t[e])?r:0)+1}))})),t}}function Us(e,t,r,n,i){return{config:e,getDocumentLoc:t,getSheetIndex:r,getCellFormat:n,getKnownFormat:i}}function Gs(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,origin:t,allowRelativeQualifier:!1}}function xs(e,t){return{config:null!=t?t:void 0,lexicalKind:qt.NameManager,origin:e,allowRelativeQualifier:!0}}function Ps(e,t){var r=Nt(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:vt(r.range),originSheet:vt(r.sheet),wrapCellReferences:!1}}!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(Ls||(Ls={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(ws||(ws={}));var Vs=Ls.Red,Ws=Ls.Black,Bs=ws.DoubleBlack,Hs={c:Ws,l:void 0,r:void 0},js={c:Bs,l:void 0,r:void 0};function Ks(e){return void 0===e.l}function qs(e){return e.c===Vs}function Js(e){return e.c===Ws&&void 0!==e.l}function Xs(e){return e.c===Ws&&void 0===e.l}var Ys=Hs;function Qs(e,t,r,n,i){return{c:e,l:t,key:r,value:n,r:i}}function zs(e,t){return Qs(e,t.l,t.key,t.value,t.r)}function Zs(e){return Ks(e)?Hs:zs(Ws,e)}function $s(e,t,r){if(!Ks(r)){var n=e.keyCompare(t,r.key);return n<0?$s(e,t,r.l):n>0?$s(e,t,r.r):r}}function el(e,t){return!!Ks(t)||!!el(e,t.l)&&(!!e(t.key,t.value)&&el(e,t.r))}function tl(e,t,r,n,i){if(e===Ws){if(qs(t)&&qs(t.l))return Qs(Vs,zs(Ws,t.l),t.key,t.value,Qs(Ws,t.r,r,n,i));if(qs(i)&&qs(i.r))return Qs(Vs,Qs(Ws,t,r,n,i.l),i.key,i.value,zs(Ws,i.r));if(qs(t)&&qs(t.r))return Qs(Vs,Qs(Ws,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,Qs(Ws,t.r.r,r,n,i));if(qs(i)&&qs(i.l))return Qs(Vs,Qs(Ws,t,r,n,i.l.l),i.l.key,i.l.value,Qs(Ws,i.l.r,i.key,i.value,i.r))}if(e===Bs){if(qs(i)&&qs(i.l))return Qs(Ws,Qs(Ws,t,r,n,i.l.l),i.l.key,i.l.value,Qs(Ws,i.l.r,i.key,i.value,i.r));if(qs(t)&&qs(t.r))return Qs(Ws,Qs(Ws,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,Qs(Ws,t.r.r,r,n,i))}return Qs(e,t,r,n,i)}function rl(e,t,r,n,i){return e===Vs&&t.c===Bs&&Js(i)?tl(Ws,Qs(Vs,Zs(t),r,n,i.l),i.key,i.value,i.r):e===Vs&&Js(t)&&i.c===Bs?tl(Ws,t.l,t.key,t.value,Qs(Vs,t.r,r,n,Zs(i))):e===Ws&&t.c===Bs&&Js(i)?tl(Bs,Qs(Vs,Zs(t),r,n,i.l),i.key,i.value,i.r):e===Ws&&Js(t)&&i.c===Bs?tl(Bs,t.l,t.key,t.value,Qs(Vs,t.r,r,n,Zs(i))):e===Ws&&t.c===Bs&&qs(i)&&Js(i.l)?Qs(Ws,tl(Ws,Qs(Vs,Zs(t),r,n,i.l.l),i.l.key,i.l.value,i.l.r),i.key,i.value,i.r):e===Ws&&qs(t)&&Js(t.r)&&i.c===Bs?Qs(Ws,t.l,t.key,t.value,tl(Ws,t.r.l,t.r.key,t.r.value,Qs(Vs,t.r.r,r,n,Zs(i)))):(A("calc.common.rbTree.rotate: expected R|B",t.c!==Bs&&i.c!==Bs),Qs(e,t,r,n,i))}function nl(e,t,r,n){return function(e){return!qs(e)||e.l.c!==Vs&&e.r.c!==Vs?e:zs(Ws,e)}(function e(t,r,n,i){if(Ks(i))return Qs(Vs,Hs,r,n,Hs);var a=t.keyCompare(r,i.key);return a<0?tl(i.c,e(t,r,n,i.l),i.key,i.value,i.r):a>0?tl(i.c,i.l,i.key,i.value,e(t,r,n,i.r)):Qs(i.c,i.l,r,n,i.r)}(e,t,r,n))}function il(e,t,r){if(Ks(r))return r;if(r.c===Vs&&Xs(r.l)&&Xs(r.r))return 0===e.keyCompare(t,r.key)?Hs:r;if(r.c===Ws&&Xs(r.l)&&Xs(r.r))return 0===e.keyCompare(t,r.key)?js:r;if(r.c===Ws&&qs(r.l)&&Xs(r.l.l)&&Xs(r.l.r)&&Xs(r.r)){var n=e.keyCompare(t,r.key);return n<0?Qs(Ws,il(e,t,r.l),r.key,r.value,Hs):n>0?r:Qs(Ws,Hs,r.l.key,r.l.value,Hs)}var i=e.keyCompare(t,r.key);if(i<0)return rl(r.c,il(e,t,r.l),r.key,r.value,r.r);if(i>0)return rl(r.c,r.l,r.key,r.value,il(e,t,r.r));A("calc.common.rbTree.rem: expected node",!Ks(r.r));var a=function e(t){if(t.c===Vs&&Xs(t.l)&&Xs(t.r))return[t.key,t.value,Hs];if(t.c===Ws&&Xs(t.l)&&Xs(t.r))return[t.key,t.value,js];if(t.c===Ws&&Xs(t.l)&&qs(t.r))return[t.key,t.value,zs(Ws,t.r)];A("calc.common.rbTree.remMin: expected node",!Ks(t.l));var r=e(t.l),n=r[0],i=r[1],a=r[2];return[n,i,rl(t.c,a,t.key,t.value,t.r)]}(r.r),o=a[0],u=a[1],c=a[2];return rl(r.c,r.l,o,u,c)}function al(e,t,r){var n=il(e,t,function(e){return Js(e)&&e.l.c===Ws&&e.r.c===Ws?zs(Vs,e):e}(r));return A("calc.common.rbTree.remove: expected R|B",n.c===Vs||n.c===Ws),n}var ol=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(Ys,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t;return null===(t=$s(this,e,this.root))||void 0===t?void 0:t.value},e.prototype.getEntry=function(e){return $s(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){el(e,this.root)},e.prototype.setValue=function(t,r){return new e(nl(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e(al(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var n=this.getValue(t);if(void 0!==n)return[this,n];var i=r();return[new e(nl(this,t,i,this.root),this.count+1,this.keyCompare),i]},e.prototype.filter=function(t){var r=this,n=Ys,i=0;return this.forEach((function(e,a){return t(e,a)&&(n=nl(r,e,a,n),i+=1),!1})),new e(n,i,this.keyCompare)},e}(),ul=oa.NodeKind,cl=oa.QualifierKind,sl=oa.BadType,ll=ia.OperKind,fl=ia.ErrorType,dl=ca.SignatureType,hl=ca.SpecialPrecs,vl=ca.getOperatorType,pl=ca.WorksheetFuncId,ml=ca.getWorksheetFuncType,gl=la.operKind,Cl=la.getArguments,Sl=la.getArgType,El=la.defaultLiteralVisitor,yl=la.defaultFormulaVisitor,Rl=la.dispatch,Ol=la.startVisit,Il=la.isUnqualifiedNameNode,Tl={};function kl(e,t){return{context:e,result:t}}function Al(e){return function(t){return t.kind===ul.Literal&&e(t.oper)}}var bl=Al((function(e){return gl(e)===ll.Missing})),Nl=Al((function(e){return gl(e)===ll.Error&&e.type===fl.REF})),Fl=Al((function(e){return 0!=(gl(e)&(ll.String|ll.Error|ll.Boolean))}));function Ll(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function wl(e,t){return t!==ll.Range||0!=(e&ll.Range)}function _l(e,t){switch(t.type){case sl.Sequence:if(a=e.localeInfo,2===(o=t.contents).length&&Il(o[0])&&jl(a,o[1]))return Ll(e,t,Is.Unsupported_struct_ref);if(null!=function(e,t){if(2!==t.length)return;var r=t[0],n=t[1];if(jl(e,r))return function(e){return e.kind===ul.Name&&null!=e.qualifier&&e.qualifier.kind===cl.Ident}(n)?ul.Name:function(e){return e.kind===ul.CellRef&&null!=e.qualifier&&e.qualifier.kind===cl.Sheet&&null==e.qualifier.document}(n)?ul.CellRef:void 0;if(function(e,t){return t.kind===ul.Bad&&t.type===sl.Qualifier&&t.contents.indexOf(e.leftBracket)>=0}(e,r))return Il(n)?ul.Name:function(e){return e.kind===ul.CellRef&&null==e.qualifier}(n)?ul.CellRef:void 0;return}(e.localeInfo,t.contents))return Ll(e,t,Is.Unsupported_doc_qual);for(var r=0,n=t.contents;r<n.length;r++){var i=n[r];if(i.kind===ul.Bad)return _l(e,i)}return Ll(e,t,Is.Bad_node);case sl.Unexpected:switch(t.contents){case")":return Ll(e,t,Is.Unexpected_closing_paren);case e.localeInfo.rightBrace:return Ll(e,t,Is.Unexpected_closing_brace);case e.localeInfo.rightBracket:return Ll(e,t,Is.Unexpected_closing_bracket);default:return Ll(e,t,Is.Bad_node)}case sl.CellRef:case sl.Qualifier:return Ll(e,t,Is.Bad_node)}var a,o}function Dl(e,t){if(t.kind===ul.Literal)switch(Ll(e,t,Is.Unclosed_literal,t.isClosed),gl(t.oper)){case ll.Number:case ll.Boolean:case ll.String:case ll.Error:return;default:return void Ll(e,t,Is.Illegal_array_literal_element)}Ll(e,t,Is.Illegal_array_literal_element)}function Ml(e,t,r){Ll(e,t,Ts.Types_not_related,wl(ll.Array,r)),Ll(e,t,Is.Unclosed_array,t.isClosed);var n=t.nodes.length>0;if(Ll(e,t,Is.Empty_array_literal,n),!n)return kl(e,r);for(var i=t.nodes[0].length,a=0;a<t.nodes.length;a+=1){var o=t.nodes[a],u=o.length;Ll(e,t,Is.Irregular_array_shape,u===i);for(var c=0;c<u;c+=1)Dl(e,o[c])}return kl(e,r)}function Ul(e,t,r){if(e.earlyExit&&!e.isOk())throw Tl;switch(t.kind){case ul.Array:return Ml(e,t,r);case ul.Paren:return Ll(e,t,Is.Unclosed_paren,t.isClosed),Ll(e,t,Is.Empty_parenthesis,!bl(t.node)),Ul(e,t.node,r);case ul.Bad:case ul.Name:case ul.CellRef:case ul.App:case ul.Literal:var n=Vl(e,t);return Ll(e,t,Ts.Types_not_related,wl(n.result,r)),n.result=r,n;default:return T("calc.analyze.checker.check: unhandled formula case",t)}}function Gl(e,t,r){return Il(r)?(Ll(e,r,Is.Invalid_binder,!t.contains(r.whole)),t.setValue(r.whole,!0)):(Ll(e,r,Is.Invalid_binder),t)}function xl(e,t,r){var n,i=ml(t),a=i.minArgs,o=i.headTypes,u=i.restTypes,c=i.tailTypes,s=r.args,l=s.length,f=Cl(r),d=f.length;d<a&&Ll(e,void 0===(n=s[l-1])?r:n,Ts.Insufficient_function_arguments);0===u.length&&d>o.length&&Ll(e,void 0===(n=s[l-1])?r:n,Ts.Excess_function_arguments);u.length>1&&d>o.length&&((d-o.length)%u.length>c.length&&Ll(e,void 0===(n=s[l-1])?r:n,Ts.Insufficient_function_arguments));for(var h=0;h<d;h+=1)Ul(e,f[h],Sl(i,h,d));return e.specialDependencies|=i.staticPrecs,function(e,t,r){switch(t){case pl.LET:case pl.LETREC:if(!bn(t===pl.LET?yn.CalcLetFunction:yn.CalcLetRecFunction))return;r.length>=3&&r.length%2!=1&&Ll(e,r[r.length-1],Ts.Insufficient_function_arguments);for(var n=e.localeInfo,i=ol.create(n.stringCompareCI),a=0;a+1<r.length;a+=2)i=Gl(e,i,r[a]);return;case pl.FUN:if(!bn(yn.CalcFunFunctions))return;for(n=e.localeInfo,i=ol.create(n.stringCompareCI),a=0;a<r.length-1;a+=1)i=Gl(e,i,r[a])}}(e,t,s),kl(e,i.returnType)}function Pl(e,t){Ll(e,t,Is.Unclosed_application,t.isClosed);var r=t.args;if(Ut(t.head))return function(e,t,r){var n=vl(t.id),i=r.length,a=i===n.minArgs;Ll(e,t,Ts.Incorrect_number_of_operator_arguments,a);for(var o=0;o<i;o+=1){var u=r[o];bl(u)&&(a=!1,Ll(e,u,Is.Missing_operation_argument)),Ul(e,u,Sl(n,o,i))}return a?(e.specialDependencies|=n.staticPrecs,kl(e,n.returnType)):kl(e,dl.All)}(e,t.head,r);if(Il(t.head)){var n=e.localeInfo.getWorksheetFuncId(t.head.whole);if(void 0!==n)return xl(e,n,t)}for(var i=0;i<r.length;i+=1)Ul(e,r[i],dl.All);var a=t.head,o=Vl(e,a);return wl(o.result,ll.Range)||o.result===ll.Error&&function(e){for(var t=e;t.kind===ul.Paren;)t=t.node;return Nl(t)}(a)||0!=(o.result&(ll.Array|ll.Rich))||Ll(e,a,Fl(a)||a.kind===ul.Array?Ts.Unexpected_application_head:Ts.Unexpected_application_head_with_fix),kl(e,dl.All)}function Vl(e,t){if(e.earlyExit&&!e.isOk())throw Tl;switch(t.kind){case ul.App:return Pl(e,t);case ul.Array:return Ml(e,t,ll.Array);case ul.Bad:return _l(e,t),kl(e,dl.All);case ul.CellRef:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==cl.Relative?kl(e,ll.Range):(Ll(e,t,Is.Invalid_rel_sheet_qualifier_in_cell),kl(e,dl.All));case ul.Literal:return Ll(e,t,Is.Unclosed_literal,t.isClosed),kl(e,gl(t.oper));case ul.Name:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==cl.Relative||Ll(e,t,Is.Invalid_rel_sheet_qualifier_in_name),kl(e,dl.All);case ul.Paren:return Ll(e,t,Is.Unclosed_paren,t.isClosed),Ll(e,t,Is.Empty_parenthesis,!bl(t.node)),Vl(e,t.node);default:return T("calc.analyze.checker.infer: unhandled formula case",t)}}var Wl={ok:!0,isOk:mr,collect:function(e,t,r){return!1}};function Bl(e,t,r,n){var i,a;void 0===n&&(n=!0);var o={globals:e,locals:t,localeInfo:(a=null===(i=t.config)||void 0===i?void 0:i.localeInfo,null!=a?a:e.config.localeInfo),reportError:r.collect,isOk:function(){return r.isOk(o.errorData)},earlyExit:n,specialDependencies:hl.None,errorData:r.ok};return o}function Hl(e,t){try{return Ll(e,t.node,Is.Empty_formula,!bl(t.node)),Ul(e,t.node,dl.All)}catch(t){return t!==Tl&&O.ULS.traceTag(595952020,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.analyze.check.runChecker: Exception "+S(t)),kl(e,dl.All)}}function jl(e,t){if(t.kind!==ul.Bad||t.type!==sl.Sequence||3!==t.contents.length)return!1;var r=t.contents[0],n=t.contents[2];return r.kind===ul.Bad&&r.type===sl.Unexpected&&r.contents===e.leftBracket&&(n.kind===ul.Bad&&n.type===sl.Unexpected&&n.contents===e.rightBracket)}function Kl(e){if(e.kind===ul.Literal&&e.isClosed)switch(gl(e.oper)){case ll.Number:case ll.Boolean:case ll.String:case ll.Error:return!0;default:return!1}return!1}function ql(e,t,r){var n,i,a=r.head,o=a.kind!==ul.Operator;if(!r.isClosed||r.args.some((function(r){return!Jl(e,t,r,o)})))return!1;if(a.kind===ul.Operator)return(c=vl(a.id)).minArgs===r.args.length;if(!Jl(e,t,a,!1))return!1;if(Il(a)){var u=(null!=(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?i:e.config.localeInfo).getWorksheetFuncId(a.whole);if(void 0!==u){var c,s=(c=ml(u)).minArgs,l=c.headTypes,f=c.restTypes,d=c.tailTypes,h=Cl(r).length;if(h<s)return!1;if(0===f.length&&h>l.length)return!1;if(f.length>1&&h>l.length)if((h-l.length)%f.length>d.length)return!1;return function(e,t){switch(e){case pl.LET:case pl.LETREC:if(!bn(e===pl.LET?yn.CalcLetFunction:yn.CalcLetRecFunction))return!0;if(t.length%2!=1)return!1;for(var r=0;r+1<t.length;r+=2)if(!Il(t[r]))return!1;return!0;case pl.FUN:return!bn(yn.CalcFunFunctions)||t.slice(0,t.length-1).every(Il);default:return!0}}(u,r.args)}}return!0}function Jl(e,t,r,n){switch(r.kind){case ul.Literal:return r.isClosed&&(!!n||gl(r.oper)!==ll.Missing);case ul.Name:case ul.CellRef:return t.allowRelativeQualifier||!(void 0!==r.qualifier&&r.qualifier.kind===cl.Relative);case ul.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every((function(e){return t=e,n=r.nodes[0].length,t.length===n&&t.every(Kl);var t,n}));case ul.App:return ql(e,t,r);case ul.Paren:return r.isClosed&&Jl(e,t,r.node,!1);case ul.Bad:return!1;default:return T("calc.analyze.isWF",r)}}var Xl=yl(El((function(e){return 1})),(function(e){return 1}),{vArray:function(e){var t=-1;return e.nodes.forEach((function(e){e.forEach((function(e){var r=Rl(e,Xl);t=Math.max(t,r)}))})),1+t},vRange:function(e){var t=Rl(e.ref1,Xl),r=Rl(e.ref2,Xl);return 1+Math.max(t,r)},vBad:function(e){if(e.type===sl.Sequence){var t=-1;return e.contents.forEach((function(e){var r=Rl(e,Xl);t=Math.max(t,r)})),1+t}return 1},vCellRef:function(e){var t=-1;if(void 0!==e.qualifier){var r=Rl(e.qualifier,Xl);t=Math.max(t,r)}return 1+Math.max(t,Rl(e.ref,Xl))},vParen:function(e){return 1+Rl(e.node,Xl)},vApp:function(e){var t=-1;return e.args.forEach((function(e){var r=Rl(e,Xl);t=Math.max(t,r)})),1+t}});var Yl,Ql=[];function zl(e,t,r,n){if(bn(yn.CalcStrictFormulaChecking))if(Ql.length<10){var i=(a=r.node,Ol(a,Xl,-1));Ql.push(i)}else O.ULS.traceTag(595957962,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+Ql.join("; ")),Ql=[];var a,o=function(e,t,r){var n=Hl(Bl(e,t,Wl),r).context.errorData;return V(V({},r),{isWellFormed:n})}(e,t,r);if(!bn(yn.CalcStrictFormulaChecking)){var u=Jl(e,t,r.node,!1);if(o.isWellFormed!==u){var c=sr(rr(er(void 0,"Book1"),0),ar(0,0));O.ULS.traceTag(592995977,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.analyze.checkFormula: old isWellFormed = "+u+", new isWellFormed = "+o.isWellFormed+"; operation: "+n+"; anonymize: "+ta(r,Yt(c)))}}return o}var Zl=oa.NodeKind,$l=ia.OperKind,ef=ca.OperatorId,tf=ca.getWorksheetFuncType,rf=ca.WorksheetFuncId,nf=la.success,af=la.failure,of=la.operKind,uf=la.isSuccess,cf=la.getArguments,sf=la.unavailable,lf=la.sheetGridRangeAnchor,ff=la.createResolutionHandler,df=la.createResolver,hf=la.ResolveReasonKind,vf=la.isSheetGridRange,pf=la.isValidArgsLength,mf={kind:_s.BadOperation},gf={kind:_s.BadFormula},Cf=function(){},Sf=function(){return af(sf(["defaultInferenceGlobals getSheetIndex"]))},Ef=function(){return af(sf(["defaultInferenceGlobals getNameLoc"]))},yf=function(){return af(sf(["defaultInferenceGlobals getCellFormat"]))},Rf=function(){return af(sf(["defaultInferenceGlobals getKnownFormat"]))};function Of(e,t,r){return Sr(t)?r:t.bind(e)}function If(e){return{getDocumentLoc:Of(e,e.getDocumentLoc,Cf),getSheetIndex:Of(e,e.getSheetIndex,Sf),getNameLoc:Of(e,e.getNameLoc,Ef)}}function Tf(e){return{getDocumentLoc:Of(e,e.getDocumentLoc,Cf),getSheetIndex:Of(e,e.getSheetIndex,Sf),getNameLoc:Of(e,e.getNameLoc,Ef),getCellFormat:Of(e,e.getCellFormat,yf),getKnownFormat:Of(e,e.getKnownFormat,Rf)}}function kf(e,t,r,n){return{strongFormat:e,category:t,iformat:r,decimals:n}}var Af,bf={Number:1,Currency:2,Accounting:2,Percentage:3,Date:4,Time:5,Fraction:6,Scientific:7,Text:8,Custom:9,Special:9,General:0};!function(e){e[e.Propagate=-1]="Propagate",e[e.Ignore=-2]="Ignore"}(Af||(Af={}));var Nf=((Yl={})[rf.INT]=Af.Propagate,Yl[rf.MOD]=Af.Propagate,Yl[rf.ROUND]=Af.Propagate,Yl[rf.SUM]=Af.Propagate,Yl[rf.TRUNC]=Af.Propagate,Yl[rf.AVERAGE]=Af.Propagate,Yl[rf.MAX]=Af.Propagate,Yl[rf.MEDIAN]=Af.Propagate,Yl[rf.MIN]=Af.Propagate,Yl[rf.ROUNDUP]=Af.Propagate,Yl[rf.ROUNDDOWN]=Af.Propagate,Yl[rf.NPV]=As.CoCurrencyDec,Yl[rf.PV]=As.CoCurrencyDec,Yl[rf.FV]=As.CoCurrencyDec,Yl[rf.PMT]=As.CoCurrencyDec,Yl[rf.RATE]=As.Percentage0,Yl[rf.MIRR]=As.Percentage0,Yl[rf.IRR]=As.Percentage0,Yl[rf.DATE]=As.MMDDYY,Yl[rf.TIME]=As.HHMMAP,Yl[rf.NOW]=As.MDYHMS,Yl[rf.SLN]=As.CoCurrencyDec,Yl[rf.SYD]=As.CoCurrencyDec,Yl[rf.DDB]=As.CoCurrencyDec,Yl[rf.IPMT]=As.CoCurrencyDec,Yl[rf.PPMT]=As.CoCurrencyDec,Yl[rf.TODAY]=As.MMDDYY,Yl[rf.VDB]=As.CoCurrencyDec,Yl[rf.DB]=As.CoCurrencyDec,Yl);var Ff=[["General","Number","Currency","Percentage","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Percentage","Date","Time","Number","Scientific","Text","Custom"],["General","General","Currency","General","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","General","General","Percentage","Percentage","Text","Custom"],["General","General","General","General","General","Date","General","General","Text","Custom"],["General","General","General","General","General","Time","General","General","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]],Lf=[["General","Number","Currency","General","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Number","Date","Time","Fraction","Scientific","Text","Custom"],["General","General","General","Currency","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","Date","Time","Percentage","Scientific","Text","Custom"],["General","General","General","General","General","General","Date","Date","Text","Custom"],["General","General","General","General","General","General","Time","Time","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]];function wf(e,t,r){if(2===t.length)return r(e,Vf(e,t[0]),Vf(e,t[1]));throw new Ds(gf)}function _f(e,t,r,n){var i=r.iformat,a=n.iformat,o=r.category,u=n.category,c=bf[o],s=bf[u],l=c<=s?t[c][s]:t[s][c],f=bf[l],d=n.decimals>r.decimals?n.decimals:r.decimals;switch(f){case c:return kf(!0,o,i,d);case s:return kf(!0,u,a,d);default:return e.unitlessFormat}}function Df(e,t,r){return _f(e,Lf,t,r)}function Mf(e,t,r){var n=t.iformat,i=r.iformat,a=t.category,o=r.category;if(n===i&&a===o&&"Time"===a)return kf(!0,a,n,0);if("Date"===a&&"Time"===o||"Time"===a&&"Date"===o){var u=e.globals.getKnownFormat(As.MDYHMS);if(!uf(u))throw new Ds(u.reason);return kf(!0,u.value.category,u.value.iformat,u.value.decimals)}return _f(e,Ff,t,r)}var Uf=function(e){return e.unitlessFormat};function Gf(e,t,r){var n=t.iformat;return n===r.iformat?kf(!0,t.category,n,t.decimals):e.unitlessFormat}function xf(e,t){return bf[t]===bf[e.defaultFormat.category]}var Pf=ff(nf,(function(e){return af(sf([e]))}),(function(e,t){return e.kind===hf.NoOriginSheet?af(sf([t])):af(e)}));function Vf(e,t){switch(t.kind){case Zl.App:var r=t.head;if(Ut(r))return function(e,t,r){switch(t){case ef.Mul:case ef.Div:return e.multOrDivTainted=!0,wf(e,r.args,Df);case ef.Pow:return wf(e,r.args,Df);case ef.Add:case ef.Sub:return wf(e,r.args,Mf);case ef.Percent:if(1===r.args.length){var n=r.args[0];if(n.kind!==Zl.Literal||"number"!=typeof n.oper)return e.defaultFormat;var i=Vf(e,n);return kf(i.strongFormat,"Percentage",As.Percentage,i.decimals)}throw new Ds(gf);case ef.Pound:case ef.At:return e.defaultFormat;case ef.Neg:case ef.Pos:if(1===r.args.length)return Vf(e,r.args[0]);throw new Ds(gf);case ef.Lt:case ef.Le:case ef.Eq:case ef.Ge:case ef.Gt:case ef.Ne:return wf(e,r.args,Uf);case ef.Isect:case ef.Union:case ef.Range:case ef.Concat:return wf(e,r.args,Gf);case ef.And:case ef.Or:case ef.Xor:case ef.Min:case ef.Max:case ef.Dot:throw new Ds(mf);default:return T("calc.analyzer.inferFormat: unexpected operator id",t)}}(e,r.id,t);if(Gt(r)){var n=e.localeInfo.getWorksheetFuncId(r.whole);if(void 0!==n){var i=Er(Nf[n],Af.Ignore),a=tf(n),o=cf(t);if(!pf(a,o.length))throw new Ds(gf);if(n===rf.HYPERLINK&&(e.hyperlinkTainted=!0),i===Af.Ignore)return e.defaultFormat;if(i===Af.Propagate){if(0===o.length)return e.defaultFormat;var u=Vf(e,o[0]),c=u.iformat,s=u.category,l=u.decimals,f=!xf(e,s);if(!u.strongFormat&&f)return e.unitlessFormat;for(var d=f,h=1;h<o.length;h+=1){var v=Vf(e,o[h]),p=!xf(e,v.category);if(!v.strongFormat&&p)return e.unitlessFormat;d||(c=v.iformat,s=v.category,l=v.decimals,d=p)}return kf(!0,s,c,l)}var m=e.globals.getKnownFormat(i);if(!uf(m))throw new Ds(m.reason);return kf(!0,m.value.category,i,m.value.decimals)}}return Vf(e,r);case Zl.Array:return e.defaultFormat;case Zl.CellRef:var g=e.resolver.resolveCellRef(e.locals,t.qualifier,t.ref),C=Pf(t.ref,g);if(!uf(C))throw new Ds(C.reason);var S=C.value;if(!vf(S))return e.unitlessFormat;var E=lf(S),y=e.globals.getCellFormat(E);if(!uf(y))throw new Ds(y.reason);var R=y.value.iformat,O=y.value.category;return kf(!0,O,R,"Date"!==O&&"Time"!==O&&"Text"!==O&&"Custom"!==O&&"Special"!==O?y.value.decimals:0);case Zl.Literal:var I=of(t.oper);switch(I){case $l.String:case $l.Boolean:case $l.Error:case $l.Missing:return e.defaultFormat;case $l.Number:var k=e.mathpack.formatGeneral(e.localeInfo,t.oper,21),A=k.indexOf(".");l=A>=0?k.length-A-1:0;return kf(!1,e.defaultFormat.category,e.defaultFormat.iformat,l);default:return T("calc.analyze.inferFormat: unexpected literal oper",I)}case Zl.Name:return e.defaultFormat;case Zl.Paren:return Vf(e,t.node);case Zl.Bad:throw new Ds(gf);default:return T("calc.analyzer.inferFormat",t)}}function Wf(e,t,r){try{var n=function(e,t){var r,n;return{globals:Tf(e),locals:t,config:e.config,localeInfo:(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo,null!=n?n:e.config.localeInfo),mathpack:e.config.mathpack,defaultFormat:kf(!1,"General",As.General,0),unitlessFormat:kf(!0,"General",As.General,0),resolver:df(If(e)),multOrDivTainted:!1,hyperlinkTainted:!1}}(e,t),i=Vf(n,r);return O.ULS.traceTag(595948253,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Verbose,"calc.analyze.inferFormat: inferred format info = "+i),nf(V(V({},i),{multOrDivTainted:n.multOrDivTainted,hyperlinkTainted:n.hyperlinkTainted}))}catch(e){return e instanceof Ds?(O.ULS.traceTag(595948254,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.analyze.inferFormat: inference failed = "+S(e.reason)),e.reason):(O.ULS.traceTag(595948255,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.analyze.inferFormat: caught exception = "+S(e)),af(gt(e)))}}var Bf=ia.SpecialPrecs,Hf=ia.PrecsBound,jf=ia.precedents;function Kf(e){return{checkFormula:function(t,r,n){return zl(e,t,r,null!=n?n:"undefined")},checkFormulaWithDiagnostics:function(t,r,n){return function(e,t,r,n){var i=Hl(Bl(e,t,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,i=null!=r?r:[];return(n=i[e.label],null!=n?n:i[e.label]=[]).push(t),i}},!1),r).context.errorData;if(!bn(yn.CalcStrictFormulaChecking)){var a=void 0===i,o=Jl(e,t,r.node,!1);if(a!==o){var u=sr(rr(er(void 0,"Book1"),0),ar(0,0));O.ULS.traceTag(592995976,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.analyze.checkFormula: old isWellFormed = "+o+", new isWellFormed = "+a+", new diagnostics = "+JSON.stringify(i)+"; operation: "+n+"; anonymize: "+ta(r,Yt(u)))}}return[V(V({},r),{isWellFormed:void 0===i}),i]}(e,t,r,null!=n?n:"undefined")},findStaticPrecedents:function(e,t){return jf([],[],Bf.All,Hf.Upper)},findBestFormat:function(t,r){return Wf(e,t,r.node)}}}var qf=function(){function e(e,t,r){b("calc.common.StrictArray2D",e),b("calc.common.StrictArray2D",t);var n=r.length;n<e&&k("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var i=0;i<n;i+=1){var a=r[i].length;a<t&&k("calc.common.StrictArray2D: expected elements["+i+"].length >= "+e+"; given "+a)}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return F("calc.common.StrictArray2D.get",e,this.rows),F("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new Xf(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();var Jf=function(){function e(e,t,r,n,i,a){b("calc.common.StrictSparseArray2D",e),b("calc.common.StrictSparseArray2D",t),F("calc.common.StrictSparseArray2D",r,e+1),F("calc.common.StrictSparseArray2D",n,t+1);var o=i.length;o<r&&k("calc.common.StrictSparseArray2D: expected elements.length >= "+r+"; given "+o);for(var u=0;u<o;u+=1){var c=i[u].length;c<n&&k("calc.common.StrictSparseArray2D: expected elements["+u+"].length >= "+n+"; given "+c)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseElements=i,this.sparseElement=a}return e.prototype.get=function(e,t){return F("calc.common.StrictSparseArray2D.get",e,this.rows),F("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new Yf(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),Xf=function(){function e(e,t,r){b("calc.common.NonstrictArray2D",e),b("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return F("calc.common.NonstrictArray2D.get",e,this.rows),F("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=Qf(this.rows,this.cols,this.func);return new qf(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),Yf=function(){function e(e,t,r,n,i,a){b("calc.common.NonstrictSparseArray2D",e),b("calc.common.NonstrictSparseArray2D",t),F("calc.common.NonstrictSparseArray2D",r,e+1),F("calc.common.NonstrictSparseArray2D",n,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseFunc=i,this.sparseFunc=a}return e.prototype.get=function(e,t){return F("calc.common.NonstrictSparseArray2D.get",e,this.rows),F("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=Qf(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new Jf(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function Qf(e,t,r){for(var n=[],i=0;i<e;i+=1){for(var a=[],o=0;o<t;o+=1)a[o]=r(i,o);n[i]=a}return n}function zf(e,t,r){for(var n=[],i=[],a=0;a<t;a+=1)i[a]=r;for(var o=0;o<e;o+=1)n[o]=i;return n}function Zf(e,t,r){return new Xf(e,t,(function(e,t){return r}))}var $f,ed=ra.LexicalKind,td=la.ResultKind,rd=la.isGridCell,nd=la.ReasonKind,id=la.notImplemented,ad=la.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}($f||($f={}));var od=V(V({},nd),$f);function ud(e){return{config:e}}function cd(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,origin:t}}var sd,ld,fd,dd=function(e,t){return N("calc.runtime.interval: end",t),F("calc.runtime.interval: start",e,t),{start:e,end:t}};function hd(e,t){return{kind:od.IllFormedFormula,message:e,diagnostics:t}}function vd(e){return{kind:sd.FinalValue,oper:e}}function pd(e){return{kind:sd.PendingValue,anchor:e}}function md(e,t,r){return t!==ed.Cell||rd(e.range)||k("calc.runtime.cellFormula: expected single-cell range; given "+S(e)),{kind:sd.Formula,range:e,source:t,formula:r}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(sd||(sd={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(ld||(ld={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(fd||(fd={}));var gd={kind:od.Stopped};function Cd(e,t){return{arity:e,func:t}}function Sd(e,t,r,n,i,a,o,u,c,s,l,f,d,h,v,p,m,g,C,S,E){return{config:e,getDocumentLoc:r,getSheetIndex:n,getSheetRangeIndexes:null!=C?C:void 0,getNameLoc:null!=g?g:void 0,getCellValue:i,getCellValues:a,getFirstOrderFunc:o,getNameFormula:u,getCellFormula:c,getUsedRange:function(e){return pt(id(["getUsedRange"]))},interruptToken:[ld.Continue],getHiddenRows:null!=S?S:void 0,isInFilterMode:null!=E?E:void 0,schedulerInfo:null!=v?v:{},limits:null!=p?p:{},setCellValue:s,setCellValues:l,setCellFailure:f,setDynamicPrecs:d,loadObjects:h}}var Ed=function(e,t,r,n,i,a,o,u,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:i,reflectionSheet:a,implicitIntersect:o,wrapCellReferences:u,followHyperlinks:c}};function yd(e){return{kind:od.NameCycle,names:e}}function Rd(e){return{kind:od.CellCycle,cells:e}}function Od(e){return{kind:od.PreviousFailure,range:e}}function Id(e){return{kind:od.LimitExceeded,limit:e}}function Td(e){return{kind:td.Paused,reason:od.Timeout,resume:e}}function kd(e){if(e.kind===td.Failure)return e.reason.kind}var Ad,bd=ra.gridCell,Nd=ia.arrayOper,Fd=ia.naErrorOper,Ld=ia.OperKind,wd=Ld.Number|Ld.String|Ld.Boolean|Ld.Error|Ld.Rich|Ld.Array,_d=Ld.Number|Ld.String|Ld.Boolean|Ld.Error|Ld.Blank|Ld.Rich,Dd=_d|Ld.Array;function Md(e,t,r){var n=e+": generated Excel error, type "+t+"; "+r;O.ULS.traceTag(596120270,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Verbose,n)}function Ud(e){return"object"==typeof e&&e.kind===Ld.Error}function Gd(e){return"object"==typeof e&&e.kind===Ld.Blank}function xd(e){return"object"==typeof e&&e.kind===Ld.Array}function Pd(e){return"object"==typeof e&&e.kind===Ld.Missing}function Vd(e){return"object"==typeof e&&e.kind===Ld.Range}function Wd(e){return"object"==typeof e&&e.kind===Ld.Rich}function Bd(e){return e.kind===ze.Success?e.value:void 0}function Hd(e,t){switch(e.kind){case ze.Success:return vt(vd(e.value));case ze.Failure:return pt(Od(t))}}function jd(e,t,r){var n=xd(r)?function(e,t,r,n,i,a){if(e===r&&t===n)return i;if(1===e&&1===t)return zf(r,n,void 0===i[0]?a:i[0][0]);var o,u=[];o=1===e?function(e,r){return r<t?i[0][r]:a}:1===t?function(t,r){return t<e?i[t][0]:a}:function(r,n){return r<e&&n<t?i[r][n]:a};for(var c=0;c<r;c+=1){u.push([]);for(var s=0;s<n;s+=1)u[c][s]=o(c,s)}return u}(r.rows,r.cols,e,t,r.opers,Fd):zf(e,t,r);return Nd(e,t,n)}function Kd(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols,l=Rr(r,o),f=Rr(n,u);return nr(l,f,Or(r+i,o+c)-l,Or(n+a,u+s)-f)}function qd(e){return 0===e.length&&k("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(Kd)}function Jd(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols,l=Or(r,o),f=Or(n,u),d=Rr(r+i,o+c)-l,h=Rr(n+a,u+s)-f;if(!(d<=0||h<=0))return nr(l,f,d,h)}function Xd(e){return e.rows*e.cols}function Yd(e,t,r){if(!Vd(t))return t;if(!Ct(t.sheets))return Le;if(!r)return 1===t.ranges.length&&Et(t.ranges[0])?e.dereferenceOper(t,re.All&~Ld.Range):e.dereferenceOper(t,Ld.Array);var n=e.dereferenceOper(t,re.All&~(Ld.Range|Ld.Array));return xd(n)?Fd:n}function Qd(e,t,r){return{kind:e,machine:t,receiver:r}}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine"}(Ad||(Ad={}));var zd=Qd(Ad.Next,void 0,void 0);function Zd(e,t){return Qd(Ad.CallMachine,e,t)}var $d={receiveResult:function(e){return mt(e)?zd:e}};function eh(){return $d}var th,rh=function(e){function t(t,r){var n=this.constructor,i=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;i.machine=t,i.stackDepth=r;var a=n.prototype;return Object.getPrototypeOf(i)!==a&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(i,a):i.__proto__=a),i}return function(e,t){function r(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t}(Error),nh=function(){function e(e){this.numSteps=0,this.stack=[],this.pushFrame(Zd(e,{receiveResult:function(e){return e}})),this.transition=zd}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(n.isRunning)throw e.numCycles+=1,new rh(n,r);n.isRunning=!0,this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case Ad.Next:return void(this.transition=this.stack[this.stack.length-1].machine.next());case Ad.CallMachine:return this.pushFrame(e),void(this.transition=e.machine.next());default:var t=this.stack.pop();return t?(t.machine.isRunning=!1,void(this.transition=t.receiver.receiveResult(e))):e}}catch(e){return void(this.transition=pt(gt(e)))}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r)return this.result=r;if(t())return void(e.numPauses+=1)}}catch(e){return this.result=pt(gt(e))}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),ih=function(){function e(e){this.machines=e,this.isRunning=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?Zd(this.machines[this.values.length],this):vt(this.values)},e.prototype.receiveResult=function(e){return mt(e)?(this.values.push(e.value),this.next()):e},e}();function ah(e){return{kind:th.MachineCall,machine:e}}function oh(e){return"object"==typeof e&&e.kind===th.MachineCall}!function(e){e.MachineCall="MachineCall"}(th||(th={}));var uh,ch,sh,lh,fh=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.isRunning=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.context.coerceOper(Yd(this.context,this.toDeref,!0),Dd);A("calc.runtime.ArrayMachine.next",!Pd(t)&&!Vd(t)),xd(t)&&(t=t.opers[0][0]),this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return vt(Ve(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return oh(r)?Zd(r.machine,this):(this.toDeref=r,zd)}catch(t){return null!=(e=this.context.handleEvaluationError(t))?e:pt(gt(t))}},e.prototype.receiveResult=function(e){return mt(e)?(this.toDeref=e.value,this.next()):e},e}();function dh(e){return{kind:uh.RangeValues,arrays:e}}!function(e){e.RangeValues="RangeValues"}(uh||(uh={})),function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.ReadClosure=-2147483640]="ReadClosure",e[e.Conditional=-2147483639]="Conditional",e[e.CallLambda=-2147483638]="CallLambda"}(lh||(lh={}));var hh,vh=(ch=pr(mr,mr)).wrap,ph=ch.unwrap,mh=(sh=pr((function(e){return-e}),(function(e){return-e}))).wrap,gh=sh.unwrap;function Ch(e){return e>0}function Sh(e){return{kind:e,data:void 0,children:void 0}}function Eh(e,t,r){var n=Sh(lh.Array);return n.children=r,n.data={rows:e,cols:t},n}function yh(e,t,r,n){var i=Sh(lh.Fun);return i.children=n,i.data={arity:e,closureId:t,closedIdents:r},i}function Rh(e,t,r){var n=Sh(lh.Let);return n.children=j(e,[r]),n.data={rec:t},n}function Oh(e,t,r,n){var i=Sh(lh.App);return i.children=n,i.data={funName:e,funType:t,isFormulaRoot:r},i}function Ih(e,t,r){var n=Sh(lh.Name);return n.data={name:e,qualifier:t},n.children=r,n}function Th(e,t,r){var n=Sh(lh.Udf);return n.data={name:e,qualifier:t},n.children=r,n}function kh(e){var t=Sh(lh.ReadStack);return t.data=e,t}function Ah(e,t,r,n,i){var a=Sh(lh.Conditional);return a.children=j([n],i),a.data={funName:e,funType:t,isFormulaRoot:r},a}function bh(e){return"object"!=typeof e||e.kind>0}function Nh(e,t){for(var r,n=0;n<e.length;n+=1){var i=e[n],a=t(i);void 0===r?a!==i&&(r=e.slice(0,n)).push(a):r.push(a)}return void 0!==r?r:e}function Fh(e,t){return Nh(e,function(e){return function(t){return Nh(t,e)}}(t))}function Lh(e,t){return t(function(e,t){if(bh(e))return e;switch(e.kind){case lh.Let:var r=Nh(e.children,t);return r===e.children?e:Rh(r.slice(0,r.length-1),e.data.rec,r[r.length-1]);case lh.App:var n=Nh(e.children,t);return n===e.children?e:Oh(e.data.funName,e.data.funType,e.data.isFormulaRoot,n);case lh.Conditional:var i=e.children,a=i[0],o=i.slice(1),u=t(a),c=Nh(o,t);return a===u&&o===c?e:Ah(e.data.funName,e.data.funType,e.data.isFormulaRoot,u,c);case lh.Fun:var s=t(e.children);return s===e.children?e:yh(e.data.arity,e.data.closureId,e.data.closedIdents,s);case lh.Array:var l=Fh(e.children,t);return l===e.children?e:Eh(e.data.rows,e.data.cols,l);case lh.Name:return(f=void 0===e.children?void 0:t(e.children))===e.children?e:Ih(e.data.name,e.data.qualifier,f);case lh.Udf:var f;return(f=void 0===e.children?void 0:t(e.children))===e.children?e:Th(e.data.name,e.data.qualifier,f);case lh.CellRef:case lh.ReadStack:case lh.ReadClosure:return e}}(e,(function(e){return Lh(e,t)})))}var wh=V,_h=oa.NodeKind,Dh=la.getArguments,Mh=ia.arrayOper,Uh=ca.WorksheetFuncId,Gh=ca.OperatorId,xh=la.success,Ph=Ie(1,[te.Number|te.String|te.Boolean|te.Rich|te.Error|te.Blank],[te.Number|te.String|te.Boolean|te.Rich|te.Error|te.Blank|te.Missing|te.Array|te.Range],[],re.All,ne.None,ie.Allow3dRef);function Vh(e){var t=function(e){return e&~(te.Array|te.Range)};return Ie(e.minArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)}var Wh=Vh(dt(Uh.IF)),Bh=Vh(dt(Uh.CHOOSE));function Hh(e){return"object"!=typeof e||bh(e)&&("object"!=typeof(t=e)||t.kind===Ld.Error||t.kind===Ld.Array||t.kind===Ld.Rich);var t}var jh=function(){function e(e){this.id=e,this.slots=[],this.idToSlot={}}return e.prototype.mapStackId=function(e){var t=this.idToSlot[e];return null!=t?t:this.idToSlot[e]=this.slots.push(e)-1},e}(),Kh=ol.create((function(e,t){return e-t}));function qh(e,t,r,n,i,a,o){switch(void 0===a&&(a=!1),void 0===o&&(o=!1),i.kind){case _h.Array:var u=i.nodes.map((function(i){return i.map((function(i){return qh(e,t,r,n,i)}))}));return N=(b=u).length,F=void 0===b[0]?0:b[0].length,b.every((function(e){return e.every(Hh)}))?Mh(N,F,b):Eh(N,F,b);case _h.App:var c=i.head;if(Ut(c)){var s=Dh(i).map((function(i){return qh(e,t,r,n,i)})),l=ca.getOperatorType(c.id);return Oh(vh(c.id),l,o,s)}if(Gt(c))if(null!=(C=e.localeInfo.getWorksheetFuncId(c.whole))){var f=void 0;switch(C){case Uh.LET:case Uh.LETREC:if(!bn(C===Uh.LET?yn.CalcLetFunction:yn.CalcLetRecFunction))break;f=function(e,t,r,n,i,a){if(i.args.length>=3&&i.args.length%2==1&&i.args.every((function(e,t,r){return t===r.length-1||t%2==1||Gt(e)}))){for(var o=t,u=i.args.length>>1,c=[],s=0;s+1<i.args.length;s+=2){var l=i.args[s].whole;e.annotations[i.args[s].label]=pe(l)}if(a){for(s=0;s+1<i.args.length;s+=2){l=i.args[s].whole;var f=r+s/2;o=o.setValue(l,[n.getCount(),f])}for(s=0;s+1<i.args.length;s+=2)c.push(qh(e,o,r+u,n,i.args[s+1]))}else for(s=0;s+1<i.args.length;s+=2){l=i.args[s].whole,f=r+s/2;c.push(qh(e,o,f,n,i.args[s+1])),o=o.setValue(l,[n.getCount(),f])}return Rh(c,a,qh(e,o,r+u,n,i.args[i.args.length-1]))}}(e,t,r,n,i,C===Uh.LETREC);break;case Uh.FUN:if(!bn(yn.CalcFunFunctions))break;f=function(e,t,r,n,i){var a=i.args.slice(0,i.args.length-1);if(i.args.length>0&&a.every(Gt)){var o=new jh(n.getCount()+1),u=n.setValue(o.id,o),c=a.reduceRight((function(t,n,i){var a=n.whole;return e.annotations[n.label]=pe(a),t.setValue(a,[u.getCount(),r+i])}),t),s=qh(e,c,r+a.length,u,i.args[i.args.length-1]),l=o.slots.map((function(e){return r-e-1}));return yh(a.length,o.id,l,s)}}(e,t,r,n,i);break;case Uh.IF:f=function(e,t,r,n,i){var a=i.args;return 3===a.length?Ah(mh(Uh.IF),Wh,!1,qh(e,t,r,n,a[0]),[qh(e,t,r,n,a[1]),qh(e,t,r,n,a[2])]):2===a.length?Ah(mh(Uh.IF),Wh,!1,qh(e,t,r,n,a[0]),[qh(e,t,r,n,a[1]),!1]):void 0}(e,t,r,n,i);break;case Uh.CHOOSE:if(bn(yn.CalcWorksheetFunctions)&&bn(yn["OfficeVSO:3852168_CalcCGCHOOSE"]))f=function(e,t,r,n,i){var a=i.args;if(a.length>=1)return Ah(mh(Uh.CHOOSE),Bh,!1,qh(e,t,r,n,a[0]),a.slice(1).map((function(i){return qh(e,t,r,n,i)})))}(e,t,r,n,i);else{var h=Dh(i).map((function(i){return qh(e,t,r,n,i)})),v=ca.getWorksheetFuncType(C);f=Oh(mh(C),v,!1,h)}break;case Uh.IFERROR:case Uh.IFNA:f=function(e,t,r,n,i,a){var o=i.args;if(2===o.length){var u=kh(0),c=Ah(mh(Uh.IF),Wh,!1,Oh(mh(a),ca.getWorksheetFuncType(a),!1,[u]),[qh(e,t,r+1,n,o[1]),u]);return Rh([qh(e,t,r,n,o[0])],!1,c)}}(e,t,r,n,i,C===Uh.IFERROR?Uh.ISERROR:Uh.ISNA);break;default:s=Dh(i).map((function(i){return qh(e,t,r,n,i)})),l=ca.getWorksheetFuncType(C);f=Oh(mh(C),l,!1,s)}if(void 0!==f)return e.annotations[c.label]=ve(C),f}return function(e,t,r,n,i){var a=Dh(i).map((function(i){return qh(e,t,r,n,i)}));return Oh(mh(Uh._UDF),Ph,!1,[qh(e,t,r,n,i.head,!0)].concat(a))}(e,t,r,n,i);case _h.Paren:return qh(e,t,r,n,i.node);case _h.Name:if(null==i.qualifier){var p=t.getEntry(i.whole);if(void 0!==p){e.annotations[i.label]=pe(p.key);var m=p.value,g=m[0],C=m[1];if(g===n.getCount())return kh(r-C-1);var E=n.getValue(g+1);return A("calc.runtime.formulaToTermIR: closure",void 0!==E),function(e,t){var r=Sh(lh.ReadClosure);return r.data=[e,t],r}(E.id,E.mapStackId(C))}}return function(e,t,r){return!t||void 0!==e.qualifier&&e.qualifier.kind!==D.Document&&e.qualifier.kind!==D.Ident||(r=Th(e.whole,e.qualifier,r)),Ih(e.whole,e.qualifier,r)}(i,a,void 0);case _h.CellRef:return R=i.ref,I=i.qualifier,(k=Sh(lh.CellRef)).data={ref:R,qualifier:I},k;case _h.Literal:return i.oper;case _h.Bad:var y="calc.runtime.compile: unexpected bad node "+S(i);return O.ULS.assertTag(595980820,d.LogCategory.msoulscat_ES_EWAJS,!1,y);default:return T("calc.runtime.compile",i)}var R,I,k,b,N,F}var Jh=((hh={})[Gh.At]=Uh.SINGLE,hh[Gh.Pound]=Uh.ANCHORARRAY,hh[Gh.Dot]=Uh._FV,hh);var Xh=function(e){if(!bh(e)&&e.kind===lh.App&&Ch(e.data.funName)){var t=Jh[ph(e.data.funName)];if(void 0!==t)return Oh(mh(t),ca.getWorksheetFuncType(t),e.data.isFormulaRoot,e.children)}return e};var Yh;function Qh(e,t){return function(e){return"__compiledFormulaBrand__"===e.kind}(t)?t.term:T(e+": expected known compiled formula type; given "+S(t),t)}function zh(e,t,r){var n,i,a=null!=(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?i:e.config.localeInfo,o=ol.create(a.stringCompareCI),u=wh([],r.annotations),c=qh({globals:e,locals:t,localeInfo:a,annotations:u},o,0,Kh,r.node,void 0,!0),s=Lh(c,Xh);return xh(function(e,t,r){return V(V({kind:"__compiledFormulaBrand__"},e),{annotations:t,term:r})}(r,u,s))}function Zh(e){return{compileFormula:function(t,r){return zh(e,t,r)}}}function $h(e){return 0===e.length&&k("calc.runtime.unevaluated: expected nonempty array"),{kind:Yh.Unevaluated,anchors:e}}!function(e){e.Unevaluated="Unevaluated"}(Yh||(Yh={}));var ev=Jt;function tv(e){throw new ev(e)}function rv(e,t,r){var n;switch(r.kind){case Yh.Unevaluated:if(t.map.getCount()+1>(null!=(n=e.globals.limits.maxCellChain)?n:1/0))return pt(Id(fd.CellChain));var i=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,t,r,!0)}));return Zd(new ih(i),eh());default:return pt(r)}}function nv(){return Ae([],[],ne.None,oe.Lower)}function iv(e){var t=Nt(e.range),r=vt(t.range),n=vt(t.sheet);return Ed(e,r,n,e.kind===qt.Range,r,n,e.kind===qt.Cell,!1,vt(!1))}function av(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function ov(e,t){return e<t?-1:e===t?0:1}function uv(e,t){return"string"==typeof e?"string"!=typeof t?1:ov(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function cv(e,t){var r;return 0!==(r=ov(e.name,t.name))?r:av(e.path,t.path,ov)}function sv(e,t){return{current:e,map:t}}var lv=sv(void 0,ol.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=uv(e.sheet.index,t.sheet.index))?r:cv(e.sheet.document,t.sheet.document)})));function fv(e,t){return{current:e,map:t}}var dv=fv(void 0,ol.create((function(e,t){var r;return 0!==(r=ov(e.name,t.name))||0!==(r=av(e.scope.index,t.scope.index,uv))?r:cv(e.scope.document,t.scope.document)})));var hv=function(){function e(e,t,r,n){this.context=e,this.previousVisitedCells=t,this.cell=r,this.isPrecedent=n,this.isRunning=!1,this.locals=void 0}return e.prototype.getRealReason=function(e){var t;if(e.kind!==od.PreviousFailure)return e;var r=Nt(e.range);return null!=(t=this.context.realReasonMap[this.realReasonKey(r)])?t:e},e.prototype.realReasonKey=function(e){var t=e.sheet,r=t.index,n=t.document,i=e.range,a=i.row,o=i.col,u=rr(er(null!=n.path?n.path:void 0,n.name),r);return JSON.stringify({sheet:u,row:a,col:o})},e.prototype.visitAnchor=function(e){var t=Nt(e.range),r=this.previousVisitedCells.map.getValue(t);if(null!=r){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+S(t)+"; given "+S(r));return O.ULS.assertTag(595980812,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i=zt(e.source,e.range);return this.locals={cell:t,cycle:void 0,previous:this.previousVisitedCells.current,source:i,precedents:nv()},this.locals},e.prototype.unVisitAnchor=function(e){var t=this.locals;if(this.locals=void 0,void 0!==t&&void 0!==e){var r=Nt(t.source.range);this.context.realReasonMap[this.realReasonKey(r)]=e.reason}return t},e.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===ze.Failure)return pt(this.getRealReason(e.reason));var t=e.value;if(t.kind===sd.FinalValue)return vt(t.oper);var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===ze.Failure){var n="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return O.ULS.assertTag(595980813,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i=r.value;if(null==i){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+S(t.anchor)+") != null");return O.ULS.assertTag(595980814,d.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a,o,u=this.visitAnchor(i);return Zd(this.context.createFormulaEvaluationMachine(this.context,iv(u.source),u.precedents,(a=this.previousVisitedCells,A("calc.runtime.appendVisitedCell",(o=u).previous===a.current),sv(o,a.map.setValue(o.cell,o))),i.formula),this)},e.prototype.receiveResult=function(e){return mt(e)?this.receiveSuccess(e):this.receiveFailure(e)},e.prototype.receiveSuccess=function(e){var t=e.value;if("object"==typeof t&&(t.kind===te.Range||t.kind===te.Missing)){var r="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+S(t));return O.ULS.assertTag(595980815,d.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=this.unVisitAnchor(void 0);if(null==n){r="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return O.ULS.assertTag(595980816,d.LogCategory.msoulscat_ES_EWAJS,!1,r)}return this.writeResult(n.source,e,n.precedents),e},e.prototype.receiveFailure=function(e){var t=e.reason;if(t.kind===Yh.Unevaluated){var r="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+S(t));return O.ULS.assertTag(595980817,d.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=this.getRealReason(t),i=n===t?e:pt(n),a=this.unVisitAnchor(i);if(null==a){r="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return O.ULS.assertTag(595980818,d.LogCategory.msoulscat_ES_EWAJS,!1,r)}var o=t.kind===od.PreviousFailure&&void 0!==a.cycle?pt(a.cycle):e;return this.writeResult(a.source,o,a.precedents),this.isPrecedent?pt(Od(a.source.range)):i},e.prototype.writeResult=function(e,t,r){switch(t.kind){case ze.Success:this.setCellValue(e,t.value,r);break;case ze.Failure:this.context.globals.setCellFailure(e.range,t.reason,r)}this.context.globals.setDynamicPrecs(e.range,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,i=Gd(t)?n:t;if(e.kind===qt.Cell){if(xd(i)){var a=void 0===i.opers[0]?Me:i.opers[0][0],o=Gd(a)?n:a;return this.context.globals.setCellValue(e.range,o,r)}return this.context.globals.setCellValue(e.range,i,r)}var u=e.range.range,c=jd(u.rows,u.cols,i).opers,s=function(e){return Gd(e)?n:e},l=c.map((function(e){return e.map(s)}));return this.context.globals.setCellValues(e.range,l,r)},e}();function vv(e,t,r,n){return new hv(e,t,r,n)}function pv(e,t){for(var r=Sv(e),n=[],i=0;i<t.length;i+=1)n.push(vv(r.machineContext,lv,t[i],!1));return new yv(r,n)}function mv(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:kr()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function gv(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=kr()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:Math.min(e.endTimeMs,t)}}var Cv={kind:od.Timeout};function Sv(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&kr()>=e}},machineContext:Ev(e)}}function Ev(e){return{globals:e,realReasonMap:gr(),resolver:Vi(e),parser:ms(e),analyzer:Kf(e),createCellEvaluationMachine:vv,createFormulaEvaluationMachine:kp,createLambdaEvaluationMachine:Ap}}var yv=function(){function e(e,t){N("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new nh(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===ld.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(gv(e));return r instanceof Array?Promise.resolve(r):new Promise((function(r){return e.scheduleFunction((function(){return r(t.evaluateAsync(e))}))}))}catch(e){return Promise.reject(pt(e))}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===ld.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var i=t.evaluate(n);return i instanceof Array?i:Td((function(t){return r(void 0!==t?t:gv(e))}))};return r(gv(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var n=this.machineRuntimes[this.results.length].run(r);if(!n)return Cv;this.pushResult(n)}return this.results}catch(e){var i="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+e.message;return O.ULS.assertTag(595980807,d.LogCategory.msoulscat_ES_EWAJS,!1,i)}},e.prototype.pushResult=function(e){return this.results.push(e),zd},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push(pt(gd))},e}(),Rv=ra.sheetIndex,Ov=ia.OperKind,Iv=ia.rangeSeqOper,Tv=ia.ErrorType,kv=ia.valueErrorOper,Av=ia.nullErrorOper,bv=ca.OperatorId,Nv=la.operKind,Fv=la.isSheetIndex,Lv=la.isDocumentLocEqual;function wv(e,t){switch(e){case bv.Eq:return 0===t;case bv.Ne:return 0!==t;case bv.Lt:return t<0;case bv.Gt:return t>0;case bv.Le:return t<=0;case bv.Ge:return t>=0}}function _v(e,t,r){return wv(e,t-r)}function Dv(e,t,r,n){return wv(t,e.stringCompareCI(r,n))}function Mv(e,t,r,n){return wv(t,e.compare(r,n))}function Uv(e,t,r){if(Fv(t.sheets))if(Fv(r.sheets))if(Lv(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return Rv(t.sheets.document,t.sheets.index);n="different sheet, range1 = "+S(t)+", range2 = "+S(r);Md(e,Tv.VALUE,n)}else{var n="different document, range1 = "+S(t)+", range2 = "+S(r);Md(e,Tv.VALUE,n)}else Md(e,Tv.VALUE,"3D reference, range2 = "+S(r));else Md(e,Tv.VALUE,"3D reference, range1 = "+S(t))}function Gv(e,t,r,n){void 0===n&&(n=!1);var i,a,o,u=e.config.mathpack;if(1===r.length){var c=r[0];switch(t){case bv.Percent:return u.percent(c);case bv.Neg:return u.neg(c);case bv.Pos:return c;default:var s="calc.runtime.applyOperator: "+("bad application of "+t+" to 1 argument");return O.ULS.assertTag(593372496,d.LogCategory.msoulscat_ES_EWAJS,!1,s)}}if(2===r.length){c=r[0];var l=r[1];switch(t){case bv.Add:var f=u.add(c,l);return n&&"number"==typeof f?u.checkAlmostCancellation(c,f):f;case bv.Sub:f=u.sub(c,l);return n&&"number"==typeof f?u.checkAlmostCancellation(c,f):f;case bv.Mul:return u.mul(c,l);case bv.Div:return u.div(c,l);case bv.Pow:return u.power(c,l);case bv.Concat:return(c+l).substring(0,32767);case bv.Eq:case bv.Ne:case bv.Lt:case bv.Le:case bv.Gt:case bv.Ge:return function(e,t,r,n){var i=e.config,a=i.localeInfo,o=i.mathpack,u=Nv(r),c=Nv(n);if(u!==c){if(u===Ov.Blank)switch(c){case Ov.Number:return Mv(o,t,o.zero,n);case Ov.String:return Dv(a,t,"",n);case Ov.Boolean:return _v(t,!1,n)}if(c===Ov.Blank)switch(u){case Ov.Number:return Mv(o,t,r,o.zero);case Ov.String:return Dv(a,t,r,"");case Ov.Boolean:return _v(t,r,!1)}return wv(t,u-c)}switch(u){case Ov.Number:return Mv(o,t,r,n);case Ov.String:return Dv(a,t,r,n);case Ov.Boolean:return _v(t,r,n);case Ov.Blank:return wv(t,0);default:return!1}}(e,t,c,l);case bv.Range:return function(e,t){var r=Uv("calc.runtime.applyRangeOp",e,t);if(null==r)return kv;var n=[Kd(qd(e.ranges),qd(t.ranges))];return Iv(r,n)}(c,l);case bv.Isect:return function(e,t){var r=Uv("calc.runtime.applyIsectOp",e,t);if(null==r)return kv;for(var n=[],i=0;i<e.ranges.length;i+=1)for(var a=0;a<t.ranges.length;a+=1){var o=Jd(e.ranges[i],t.ranges[a]);null!=o&&n.push(o)}if(0===n.length){var u="empty intersection, range1 = "+S(e)+", range2 = "+S(t);return Md("calc.runtime.applyIsectOp",Tv.NULL,u),Av}return Iv(r,n)}(c,l);case bv.Union:return null==(o=Uv("calc.runtime.applyUnionOp",i=c,a=l))?kv:Iv(o,i.ranges.concat(a.ranges));case bv.And:return c&&l;case bv.Or:return c||l;case bv.Xor:return c!==l;case bv.Min:return u.cond2(c,l)<=0?c:l;case bv.Max:return u.cond2(c,l)>=0?c:l;default:var h="calc.runtime.applyOperator: "+("bad application of "+t+" to 2 arguments");return O.ULS.assertTag(593372497,d.LogCategory.msoulscat_ES_EWAJS,!1,h)}}var v="calc.runtime.applyOperator: "+("bad application of "+t+" to "+r.length+" arguments");return O.ULS.assertTag(593372498,d.LogCategory.msoulscat_ES_EWAJS,!1,v)}function xv(e,t,r,n){if(r.kind===U.Abs)return r;var i=tn(e,r.index,n)-t;return i===r.index?r:$(U.Rel,i)}function Pv(e,t,r){var n=xv(e.row,t.row,r.row,1<<20),i=xv(e.col,t.col,r.col,16384);return n===r.row&&i===r.col?r:ce(n,i,r.label)}function Vv(e,t,r){switch(r.kind){case M.Error:return r;case M.Single:return Pv(e,t,r);case M.Range:var n=Pv(e,t,r.ref1),i=Pv(e,t,r.ref2);return n===r.ref1&&i===r.ref2?r:se(n,i,r.label);case M.Row:var a=xv(e.row,t.row,r.row1,1<<20),o=xv(e.row,t.row,r.row2,1<<20);return a===r.row1&&o===r.row2?r:le(a,o,r.label);case M.Col:var u=xv(e.col,t.col,r.col1,16384),c=xv(e.col,t.col,r.col2,16384);return u===r.col1&&c===r.col2?r:fe(u,c,r.label)}}function Wv(e,t,r){if(kt(e,t))return r;var n,i,a=(n=r.node,i=Vv.bind(void 0,e,t),function e(t){switch(t.kind){case x.Name:case x.Literal:case x.Bad:return t;case x.Array:return ge(r=t.nodes.map((function(t){return t.map(e)})),t.isClosed,t.label);case x.App:return Ce(t.head.kind===x.Operator?t.head:e(t.head),t.args.map(e),t.isClosed,t.label);case x.Paren:return(r=e(t.node))===t.node?t:Ee(r,t.isClosed,t.label);case x.CellRef:var r;return(r=i(t.ref))===t.ref?t:Re(r,t.qualifier,t.label)}}(n));return a===r.node?r:V(V({},r),{node:a})}var Bv=ra.sheetGridCell,Hv=ra.sheetGridRange,jv=ia.OperKind,Kv=ia.ErrorType,qv=ia.refErrorOper,Jv=ia.valueErrorOper,Xv=ia.arrayOper,Yv=la.ResultKind,Qv=la.isGridCell,zv=la.isSheetIndex,Zv=la.getArgType;function $v(e,t){var r=t.map.getValue(e);if(void 0!==r)return tv(function(e,t){for(var r=[],n=Rd(r),i=t;r.push(i.cell),i.cycle=n,i!==e;i=i.previous);return r.reverse(),n}(r,t.current))}function ep(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===Yv.Failure)return tv(n.reason);var i=n.value;if(i.kind===sd.FinalValue)return i.oper;$v(i.anchor,e.visitedCells),r.push(i.anchor)}function tp(e,t,r,n){var i;if(e.precedents.cells.push(t),!n||Xd(t.range)<=16||!bn(yn["OfficeVSO:3832568_CalcCGGetUsedRange"]))i=t;else{var a=e.globals.getUsedRange(t.sheet),o=void 0;mt(a)?o=null==a.value?void 0:a.value.range:a.reason.kind===Ht.NotImplemented?o=t.range:tv(a.reason);var u=void 0===o?void 0:Jd(t.range,ir(0,0,o.row+o.rows,o.col+o.cols));if(void 0===u)return new Jf(t.range.rows,t.range.cols,0,0,[],Ke);i=Hv(t.sheet,u)}var c=e.globals.getCellValues(i);if(c.kind===Yv.Failure)return tv(c.reason);var s=r.length,l=function(e,t,r,n,i){var a=[],o=n.length,u=0;A("calc.runtime.deference: readIntoArray2D number of rows",o===r.rows);for(var c=0;c<o;c+=1){a.push([]);var s=n[c].length;A("calc.runtime.deference: readIntoArray2D number of cols",s===r.cols),u=0===c?s:Rr(s,u);for(var l=0;l<s;l+=1){var f=n[c][l];sd.FinalValue===f.kind?a[c][l]=f.oper:($v(f.anchor,e.visitedCells),A("calc.runtime.deference: readIntoArray2D correct sheet",Tt(f.anchor.sheet,t.sheet)),i.push(f.anchor),a[c][l]=qv)}}return new Jf(t.range.rows,t.range.cols,o,u,a,Ke)}(e,t,i.range,c.value,r);return s===r.length?l:void 0}function rp(e,t,r){var n,i=tp(e,t,r,!1);if(null!=i)return Xv(i.rows,i.cols,i.rows===i.denseRows&&i.cols===i.denseCols?i.denseElements:Qf((n=i).rows,n.cols,n.get.bind(n)))}function np(e,t,r,n){if(0!=(r&jv.Range))return t;if("object"!=typeof t||t.kind!==jv.Range)return t;var i=t.sheets;if(!zv(i))return Md("calc.runtime.dereference",Kv.REF,"3D range, oper = "+S(t)),qv;if(1!==t.ranges.length)return Md("calc.runtime.dereference",Kv.VALUE,"union range, oper = "+S(t)),Jv;var a=t.ranges[0];if(0!=(r&_d)){if(Qv(a))return ep(e,Bv(i,a),n);if(e.locals.implicitIntersect&&!bn(yn.CalcSupportDynamicArrays)&&!bn(yn.CalcPreventSpillingHack)){var o=e.locals.originGridCell;if(!mt(o))return tv(o.reason);var u=function(e,t){var r=e.row,n=e.col,i=t.row,a=t.col,o=t.rows,u=t.cols,c=i<=r&&r<i+o,s=a<=n&&n<a+u;return c&&s?bd(r,n):c&&1===u?bd(r,a):s&&1===o?bd(i,n):void 0}(o.value,a);return null==u?(Md("calc.runtime.dereference",Kv.VALUE,"empty intersection, oper = "+S(t)),Jv):ep(e,Bv(i,u),n)}return rp(e,Hv(i,a),n)}return 0!=(r&jv.Array)?rp(e,Hv(i,a),n):(Md("calc.runtime.dereference",Kv.VALUE,"bad target type "+r),Jv)}function ip(e,t,r){var n=[],i=np(e,t,r,n);if(null==i){if(n.length>0)return tv($h(n));var a="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+S(t);return O.ULS.assertTag(595980819,d.LogCategory.msoulscat_ES_EWAJS,!1,a)}return i}function ap(e,t,r){for(var n=[],i=0;i<t.length;i+=1){var a=np(e,t[i],Zv(r,i,t.length),n);null!=a&&(t[i]=a)}if(n.length>0)return tv($h(n))}var op=ia.OperKind,up=ia.valueErrorOper,cp=ia.arrayOper,sp=la.operKind,lp=la.notImplemented;function fp(e,t){return 0!=(t&op.Number)?e.zero:0!=(t&op.String)?"":0==(t&op.Boolean)&&up}function dp(e,t,r){var n=function e(t,r,n){var i=t.config,a=i.localeInfo,o=i.mathpack;if("number"==typeof r){if(0!=(n&op.Number))return r;if(0!=(n&op.String)){return o.formatGeneral(a,r,20)}return 0!=(n&op.Boolean)?0!==o.cond(r):0!=(n&op.Array)?cp(1,1,[[r]]):up}if("string"==typeof r){if(0!=(n&op.String))return r;if(0!=(n&op.Number)){if(0===r.length)return up;var u=a.parseNumber(r);if(Wt(u))return u;throw new ev(lp(["string -> number coercion: "+Ca(r)]))}return 0!=(n&op.Boolean)?0===a.stringCompareCI(r,a.trueName)||0!==a.stringCompareCI(r,a.falseName)&&up:0!=(n&op.Array)?cp(1,1,[[r]]):up}if("boolean"==typeof r)return 0!=(n&op.Boolean)?r:0!=(n&op.Number)?r?o.one:o.zero:0!=(n&op.String)?r?a.trueName:a.falseName:0!=(n&op.Array)?cp(1,1,[[r]]):up;if(0!=(n&r.kind))return r;switch(r.kind){case op.Error:return r;case op.Missing:return 0!=(n&op.Blank)?ia.blankOper:fp(o,n);case op.Blank:return fp(o,n);case op.Rich:return e(t,r.getFallback(),n);default:return up}}(e,t,r);return Ud(n)&&!Ud(t)&&Md("calc.runtime.coerceOper",n.type,"kind = "+sp(t)),n}var hp,vp=function(){function e(e,t){void 0===t&&(t=Le),this._fields=e,this._fallback=t,this.kind=te.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}(),pp=function(){function e(e,t,r,n){this.arity=e,this.kind=te.Rich,this.locals=t,this.env=r,this.term=n}return e.prototype.getFallback=function(){return Le},e.prototype.getField=function(e){},e}();function mp(e,t){return A("calc.runtime.lambdaCall",t.length===e.arity),{kind:hp.LambdaCall,lambda:e,args:t}}function gp(e){return"object"==typeof e&&e.kind===hp.LambdaCall}!function(e){e.LambdaCall="LambdaCall"}(hp||(hp={}));var Cp=function(){function e(e){this.kind=te.Rich,this.arity=e.arity,this.func=e.func}return e.prototype.getFallback=function(){return k("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return k("calc.runtime.UdfOper.getField")},e}(),Sp=function(){function e(e,t,r,n,i,a){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=i,this.usage=a;var o=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return r.special|=ne.RefStyle,o},mathpack:e.globals.config.mathpack},this.mathpack=this.config.mathpack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return mt(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return mt(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return mt(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return mt(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return mt(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=dt(e),n=t.some((function(e){return"object"==typeof e&&e.kind===te.Range}))?t.slice(0):t;return ap(this,n,r),this.handleLambda(this.dispatchFunction(mh(e),r,!1,n))},e.prototype.applyLambda=function(e,t){return this.handleLambda(mp(e,t))},e.prototype.handleEvaluationError=function(e){if(e instanceof ev)return rv(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if(Ch(e))return Gv(this.globals,ph(e),t,r);var n=gh(e);if(n===He._UDF){if(t[0]instanceof pp){var i=t[0];return t.length-1!==i.arity?Me:mp(i,t.slice(1))}if(t[0]instanceof Cp){var a=t[0];if(t.length-1!==a.arity)return Le;var o=a.func(this,t.slice(1));if("object"==typeof o&&o.kind===te.Error){var u="UDF function return value";Md("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",o.type,u)}return o}return t.length>0&&Ud(t[0])?t[0]:we}var c=this.globals.getFirstOrderFunc(n);if(c.kind===ze.Failure)return tv(c.reason);var s=c.value;if(null==s){u="nonexistent worksheet function "+n;return Md("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",Te.NAME,u),_e}var l=s(this,t);if("object"==typeof l&&l.kind===te.Error){u="worksheet function "+n+" return value";Md("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",l.type,u)}return l},e.prototype.arrayLift=function(e,t,r){for(var n=this,i=0,a=0,o=0;o<r.length;o+=1){var u=r[o];xd(u)&&0==(xt(e,o,r.length)&te.Array)?(i=Or(i,u.rows),a=Or(a,u.cols)):(i=Or(i,1),a=Or(a,1))}var c=r.map((function(t,r,o){return n.broadcastOper(i,a,t,xt(e,r,o.length))}));return ah(new fh(this,i,a,(function(e,r){return t(c.map((function(t){return t.get(e,r)})))})))},e.prototype.handleLambda=function(e){return gp(e)?ah(this.context.createLambdaEvaluationMachine(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e.lambda,e.args)):e},e.prototype.dispatchFunction=function(e,t,r,n){var i=this;if(!Pt(t,n.length)){var a=JSON.stringify(t),o="calc.runtime.FunctionDispatcher.dispatchFunction: "+(m="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+a);return O.ULS.assertTag(593372499,d.LogCategory.msoulscat_ES_EWAJS,!1,o)}for(var u=n.length,c=re.None,s=0;s<u;s+=1){var l=n[s],f=Vt(l);0==(f&xt(t,s,u))&&(c|=f),Vd(l)&&0==(t.flags&ie.Allow3dRef)&&!Ct(l.sheets)&&(c|=f)}if(c===re.None)return this.applyOperatorOrFunction(e,n,r);if(0!=(c&te.Array)){return this.arrayLift(t,(function(r){return i.handleLambda(i.dispatchFunction(e,t,!1,r))}),n)}c&=~te.Array;var h=[];for(s=0;s<u;s+=1){var v=n[s];if(0!=(c&Vt(v))){var p=xt(t,s,u);if(Vt(v=this.coerceOper(v,p))===te.Error&&0==(p&te.Error))return v;if(Vd(v)&&0==(t.flags&ie.Allow3dRef)&&!Ct(v.sheets)){var m="3D reference, oper = "+S(v);return Md("calc.runtime.FunctionDispatcher.dispatchFunction",Te.VALUE,m),Le}}h[s]=v}return this.applyOperatorOrFunction(e,h,r)},e.prototype.getAvailableFormula=function(e){if(!bn(yn.CalcWebWorker))return tv(id(["getCellFormula on non-anchor"]));var t=this.globals.getCellFormula(e);return mt(t)?Sr(t.value)?void 0:t.value:tv(t.reason)},e.prototype.getNameFormula=function(e,t){var r=this,n=Ui(mr,(function(e){}),(function(e,t){return e.kind===Ei.NoOriginSheet?void 0:tv(e)}))(e,Gi((function(e){r.precedents.names.push(e);var t=r.globals.getNameFormula(e);return mt(t)?t.value:tv(t.reason)}))(this.context.resolver.resolveName(this.locals,e,t)));if(null!=n){var i=n[0],a=n[1];if(null!=a)return[i,a.node]}},e.prototype.getCellRef=function(e,t,r,n){var i={originGridCell:vt(r.range),originSheet:vt(r.sheet),wrapCellReferences:n};return Ui((function(e){return Be(e.sheet,e.range)}),(function(e){}),(function(e,t){return e.kind===Ei.NoOriginSheet?void 0:tv(e)}))(e,this.context.resolver.resolveCellRef(i,e,t))},e.prototype.dereferenceOper=function(e,t){return ip(this,e,t)},e.prototype.dereferenceOpers=function(e,t){ap(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return mt(t)?this.getAvailableFormula(e):tv(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return mt(r)?(this.precedents.special|=ne.OwnDocSheets,null==r.value?void 0:rr(e,r.value)):tv(r.reason)},e.prototype.getSheetRangePosition=function(e){if(this.precedents.special|=ne.OwnDocSheets,null==this.globals.getSheetRangeIndexes)return tv(id(["getSheetRangeIndexes: position"]));var t=this.globals.getSheetRangeIndexes(e);return mt(t)?t.value.position:tv(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];if(this.precedents.special|=ne.OwnDocSheets,null!=this.globals.getSheetRangeIndexes){var t=this.globals.getSheetRangeIndexes(e);return mt(t)?t.value.sheets:tv(t.reason)}if(void 0===e.index)return tv(id(["getSheetRangeIndexes: all sheets"]));if("number"!=typeof e.index||"number"!=typeof e.index2)return tv(id(["getSheetRangeIndexes: string ID"]));for(var r=Rr(e.index,e.index2),n=Or(e.index,e.index2),i=[],a=r;a<=n;a+=1)i.push(a);return i},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var i=[],a=[],o=function(o){var c=e[o];if(!Vd(c))return a.push(c),"continue";for(var s=[],l=function(e){var r=tp(n,e,i,!0);void 0!==r&&s.push(t(r,e))},f=u.getSheetRangeIndexes(c.sheets),d=function(e){for(var t=rr(c.sheets.document,f[e]),n=function(e){var n=c.ranges[e];if(!r)return l(cr(t,n)),"continue";if(null==u.globals.getHiddenRows)return{value:tv(id(["getHiddenRows"]))};var i=u.globals.getHiddenRows(t,n.row,n.row+n.rows);if(!mt(i))return{value:tv(i.reason)};var a=i.value;if(0===a.length)return l(cr(t,n)),"continue";for(var o=function(e,r){var i=ir(e,n.col,r-e,n.cols);l(cr(t,i))},s=0;s<a.length;s+=1){var f=a[s],d=f.start,h=f.end,v=0===s?n.row:a[s-1].end;A("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",v<=d&&d<h&&h<=n.row+n.rows),v!==d&&o(v,d);var p=ir(d,n.col,h-d,n.cols);u.precedents.cells.push(cr(t,p))}var m=a[a.length-1].end;m!==n.row+n.rows&&o(m,n.row+n.rows)},i=0;i<c.ranges.length;i+=1){var a=n(i);if("object"==typeof a)return a}},h=0;h<f.length;h+=1){var v=d(h);if("object"==typeof v)return v}a.push({kind:uh.RangeValues,arrays:s})},u=this,c=0;c<e.length;c+=1){var s=o(c);if("object"==typeof s)return s.value}return i.length>0?tv($h(i)):a},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,mr,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new Yf(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,i){var a=e.get(n,i),o=sr(t.sheet,ar(t.range.row+n,t.range.col+i));return[a,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var i=this.context.parser.parseFormula(Oa(r.lexicalKind,t,{refStyle:e}),n);if(!mt(i))return i;var a=this.context.analyzer.checkFormula(r,i.value,"indirect");return St(a)?vt(a):pt(hd("ill-formed indirect formula"))},e.prototype.broadcastOper=function(e,t,r,n){if("object"!=typeof r)return Zf(e,t,r);switch(r.kind){case te.Missing:case te.Blank:return Zf(e,t,this.mathpack.zero);case te.Array:return 0!=(n&te.Array)?Zf(e,t,r):function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?Zf(e,t,r.get(0,0)):1===r.rows?new Xf(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new Xf(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new Xf(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}(e,t,new qf(r.rows,r.cols,r.opers),Me);case te.Range:default:return Zf(e,t,r)}},e.prototype.coerceOper=function(e,t){return dp(this.globals,e,t)},e.prototype.getBinaryOperator=function(e){var t=this,r=ft(e),n=[!1,!1];return function(i,a){n[0]=i,n[1]=a,ap(t,n,r);var o=t.dispatchFunction(vh(e),r,!1,n);return A("calc.runtime.FunctionDispatcher.getBinaryOperator",!gp(o)&&!oh(o)),o}},e.prototype.getUnaryOperator=function(e){var t=this,r=ft(e),n=[!1];return function(i){n[0]=i,ap(t,n,r);var a=t.dispatchFunction(vh(e),r,!1,n);return A("calc.runtime.FunctionDispatcher.getUnaryOperator",!gp(a)&&!oh(a)),a}},e.prototype.isInFilterMode=function(e){if(null==this.globals.isInFilterMode)return tv(id(["isInFilterMode"]));this.precedents.special|=ne.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if("object"==typeof n&&n.kind===te.Range)for(var i=0,a=this.getSheetRangeIndexes(n.sheets);i<a.length;i++){var o=a[i],u=this.globals.isInFilterMode(rr(n.sheets.document,o));if(!mt(u))return tv(u.reason);if(u.value)return!0}}return!1},e.prototype.formatFormula=function(e,t){var r=sr(e.range.sheet,t),n=this.context.parser.formatFormula(Ta(zt(e.source,e.range),r,{refStyle:this.config.refStyle}),Wv(bt(e.range.range),t,e.formula));return mt(n)?n.value:tv(id(["prettyPrint failure"]))},e}(),Ep=[void 0,_e],yp=[void 0,we],Rp=function(){function e(){}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?tv(id(["LETREC cycle"])):this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),e}(),Op=ol.create((function(e,t){return e-t})),Ip={kind:lh.CallLambda};var Tp=function(){function e(e,t,r,n,i,a,o,u,c,s,l){var f=this;this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=i,this.stackEnv=a,this.closureEnv=o,this.usage=u,this.target=c,this.isLambda=s,this.isRunning=!1,this.cellEvaluator=Ui((function(e){return Be(e.sheet,e.range)}),(function(e){var t="error ref, qualifier = "+S(e.data.qualifier);return Md("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Te.REF,t),we}),(function(e,t){if(e.kind===Ei.NoOriginSheet){var r="error ref, no sheet, qualifier = "+S(t.data.qualifier);return Md("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Te.REF,r),we}return tv(e)})),this.udfEvaluator=function(e,t,r){return Ui((function(e){if(e.length>1){return Md("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Te.NAME,"UDF resolution, ambiguous name"),_e}if(void 0===f.globals.getUserDefinedFunc)return tv(id(["getUserDefinedFunc"]));var t=f.globals.getUserDefinedFunc(e[0]);return mt(t)?new Cp(t.value):tv(t.reason)}),void 0!==r?function(){return r}:function(e){var t="UDF resolution, qualifier = "+S(e.data.qualifier);return Md("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Te.NAME,t),_e},(function(e,t){return tv(e)}))(e,t)},this.term=l,this.continuation=[]}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof ev)return rv(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return mt(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if(bh(this.term)){var e=this.continuation;if(0===e.length){var t=ip(this,this.term,this.target),r=dp(this.globals,t,this.target);return this.precedents.bound=oe.Exact,!bn(yn.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==qt.Cell||!xd(r)||1===r.rows&&1===r.cols?vt(r):pt(id(["spilling"]))}var n=e[e.length-1];return this.applyContinuation(this.term,n)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case lh.App:var n=t.holeIndex,i=r.children.length;return(a=t.locals)[n]=e,n+1<i?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(a,a,r.data);case lh.Conditional:var a;if(0===(n=t.holeIndex)){var o=gh(r.data.funName),u=o===He.IF?te.Boolean:te.Number,c=ip(this,e,u);if(xd(c))return t.locals=[c],this.nextHoleTransition(t,r.children[n+1]);if(Wd(c))return pt(id(["IF/CHOOSE with a rich value condition"]));if(c=dp(this.globals,c,u),o===He.IF&&"boolean"==typeof c)return this.popContextTransition(r.children[c?1:2]);if(o===He.CHOOSE&&"number"==typeof c){var s=this.context.globals.config.mathpack.fix(c);if(s<1||s>r.children.length-1){var l="CHOOSE; out of bounds option = "+S(s);return Md("calc.runtime.FormulaEvaluationMachine.applyContinuation",Te.VALUE,l),this.popContextTransition(Le)}return this.popContextTransition(r.children[s])}return A("calc.runtime.FormulaEvaluationMachine.applyContinuation",Ud(c)),this.popContextTransition(c)}return(a=t.locals)[n]=e,n+1<r.children.length?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(a,a,r.data);case lh.Name:var f=this.popContextTransition(e),d=t.locals;return this.locals=d.locals,this.visitedNames=d.visitedNames,f;case lh.Let:n=t.holeIndex;var h=r.children.length-1;if(n>=h){f=this.popContextTransition(e),d=t.locals;return this.stackEnv.length=d.stackEnvLen,f}if(r.data.rec){var v=this.stackEnv.length-h+n;this.stackEnv[v].value=e,this.stackEnv[v]=e}else this.stackEnv.push(e);return this.nextHoleTransition(t,r.children[n+1]);case lh.Array:var p=ip(this,e,wd),m=r.data,g=m.rows,C=m.cols,E=t.holeIndex,y=E%C,R=C===y+1,O=(E-y)/C,I=t.locals;if(I[O][y]=dp(this.globals,p,wd),g===O+1&&R)return this.popContextTransition(Ve(g,C,I));var k=R?O+1:O,b=R?0:y+1;return this.nextHoleTransition(t,r.children[k][b]);case lh.CallLambda:f=this.popContextTransition(e),d=t.locals;return this.locals=d.locals,this.stackEnv.length=d.stackEnvLen,this.closureEnv=d.closureEnv,this.usage.lambdaDepth-=1,f;default:return T("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},e.prototype.reduceFormula=function(e){var t=this;switch(e.kind){case lh.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case lh.App:var r=e.data.funName;if(!Ch(r)){var n=gh(r);if(n!==He._UDF){var i=this.globals.getFirstOrderFunc(n);if(i.kind===ze.Failure)return tv(i.reason)}}return 0===e.children.length?gp(a=new Sp(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(r,e.data.funType,e.data.isFormulaRoot,[]))?this.evaluateLambdaTransition(void 0,a):oh(a)?this.evaluateMachineTransition(void 0,a):this.updateTermTransition(a):this.pushContextTransition(e,e.children[0],[]);case lh.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case lh.Let:return this.evaluateLetTransition(e);case lh.Name:var a;if(void 0!==(a=this.evalNameTerm(e))[0]){var o=a[0],u=a[1],c=a[2],s=this.pushContextTransition(e,u,{locals:this.locals,visitedNames:this.visitedNames});return this.locals=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=vt(n);else{var i=t.originSheet;if(!mt(i))return tv(i.reason);r=It(i.value.document,n.document)?i:vt(n)}var a=t.originGridCell;return Ed(e,a,r,t.calcingArray,a,r,!1,!0,vt(!1))}(Zt(o),this.locals),this.visitedNames=c,s}var l=a[1];return this.updateTermTransition(l);case lh.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case lh.ReadStack:return A("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(f=this.stackEnv[this.stackEnv.length-1-e.data])),this.updateTermTransition(f instanceof Rp?f.value:f);case lh.ReadClosure:var f;return A("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(h=this.closureEnv.getValue(e.data[0]))),A("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(f=h[e.data[1]])),f instanceof Rp&&(f=f.value,h[e.data[1]]=f),this.updateTermTransition(f);case lh.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case lh.Fun:var d=e.data.closedIdents.map((function(e){var r=t.stackEnv[t.stackEnv.length-1-e];return A("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==r),r})),h=this.closureEnv.setValue(e.data.closureId,d);return this.updateTermTransition(new pp(e.data.arity,this.locals,h,e.children));default:return T("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=r.funName,i=r.funType,a=r.isFormulaRoot;ap(this,t,i);var o=new Sp(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,i,a,t);return gp(o)?this.evaluateLambdaTransition(e,o):oh(o)?this.evaluateMachineTransition(e,o):this.popContextTransition(o)},e.prototype.pushContextTransition=function(e,t,r){var n=function(e,t){return{context:e,holeIndex:0,locals:t}}(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),Zd(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n,i,a,o,u=t.lambda,c=t.args,s=this.continuation[this.continuation.length-1-(void 0!==e?1:0)],l=(null===(n=s)||void 0===n?void 0:n.context.kind)===lh.CallLambda?s:void 0;return this.usage.lambdaCalls[0]+1>(null!=(i=this.globals.limits.maxLambdaCalls)?i:1/0)?tv(Id(fd.LambdaCalls)):void 0===l&&this.usage.lambdaDepth+1>(null!=(a=this.globals.limits.maxLambdaDepth)?a:1/0)?tv(Id(fd.LambdaDepth)):(void 0!==e&&this.continuation.pop(),void 0!==l?(o=this.updateTermTransition(u.term),this.stackEnv.length=l.locals.stackEnvLen):(o=this.pushContextTransition(Ip,u.term,{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv}),this.usage.lambdaDepth+=1),(r=this.stackEnv).push.apply(r,c),this.closureEnv=u.env,this.locals=function(e,t){return Ed(e.locals.lexicalSource,e.locals.originGridCell,e.locals.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.locals.wrapCellReferences,vt(!1))}(u,this.locals),this.usage.lambdaCalls[0]+=1,o)},e.prototype.evaluateLetTransition=function(e){var t=this.pushContextTransition(e,e.children[0],{stackEnvLen:this.stackEnv.length});if(e.data.rec)for(var r=e.children.length-1,n=0;n<r;n+=1)this.stackEnv.push(new Rp);return t},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){return this.term=e,zd},e.prototype.getNameFormulaAsTerm=function(e){this.precedents.names.push(e);var t=this.globals.getNameFormula(e);if(t.kind===ze.Failure)return tv(t.reason);var r=t.value;return null!=r?Qh("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",r):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);return void 0!==n?tv(function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),yd(r)}(n,r.current)):this.visitedNames.map.getCount()+1>(null!=(t=this.globals.limits.maxNameChain)?t:1/0)?tv(Id(fd.NameChain)):function(e,t){var r={name:t,previous:e.current};return fv(r,e.map.setValue(t,r))}(this.visitedNames,e)},e.prototype.nameEvaluator=function(e,t,r){var n=this;return Ui((function(e){var t=e[0];return[t,e[1],n.checkForNameCycle(t)]}),void 0!==r?function(){return[void 0,r]}:function(e){var t="name resolution; qualifier = "+S(e.data.qualifier);return Md("calc.runtime.FormulaEvaluationMachine.evalName",Te.NAME,t),Ep},(function(e,t){if(e.kind===Ei.NoOriginSheet){var r="name resolution, no sheet; qualifier = "+S(t.data.qualifier);return Md("calc.runtime.FormulaEvaluationMachine.evalName",Te.REF,r),yp}return tv(e)}))(e,Gi((function(e){return n.getNameFormulaAsTerm(e)}))(t))},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,e.data.qualifier,e.data.name);return this.nameEvaluator(e,t,e.children)},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,e.data.qualifier,e.data.ref);return this.cellEvaluator(e,t)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,e.data.qualifier,e.data.name);return this.udfEvaluator(e,t,e.children)},e}();function kp(e,t,r,n,i){return new Tp(e,t,r,n,dv,[],Op,{lambdaCalls:[0],lambdaDepth:0},Dd,!1,Qh("calc.runtime.createFormulaEvaluationMachine",i))}function Ap(e,t,r,n,i,a,o,u){return A("calc.runtime.createLambdaEvaluationMachine",u.length===o.arity),new Tp(e,t,r,n,i,j(u),o.env,a,re.All,!0,o.term)}function bp(e,t,r,n){var i=Sv(e),a=nv(),o=kp(i.machineContext,t,a,lv,r);return function e(t,r){var n=t.evaluate(r);return n instanceof Array?n[0]:Td((function(n){return e(t,"number"==typeof n?n:r)}))}(new yv(i,[o]),Sr(n)?void 0:n)}function Np(e){return{evalFormula:function(t,r,n){return bp(e,t,r,n)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=pv(e,t),n=mv(e.schedulerInfo);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=pv(e,t),n=mv(e.schedulerInfo);return r.evaluateAsync(n)}(e,t)}}}var Fp,Lp=oa.formulaSpan,wp=oa.RefStyle,_p=ra.LexicalKind,Dp=la.getSubExpressionFromPosition,Mp=la.isSuccess,Up=la.failure,Gp=la.ResultKind,xp=la.isWellFormed,Pp=Lp(0,0,"","");function Vp(e){var t,r,n,i,a=e.config,o=Ra(a),u=Us(a),c=ud(a),s=Kf(u),l=Zh(c),f=Np(e),d=ms(o).parseFormula,h=!1,v=void 0,p=-1,m=!1;function g(){h=!1,n=void 0,p=-1,v=void 0,i=void 0,m=!1}function C(){if(!h){if(h=!0,void 0===t||void 0===r)return;var e=d(wp.A1,t,_p.Range,r);Mp(e)&&(n=e.value)}}function S(e){if(C(),void 0!==n&&e!==p){var t=v;v=void 0,e>=0&&e<r.length&&(v=Dp(n,e)),v!==t&&(i=void 0,m=!1),p=e}}function E(){if(void 0!==v&&!m&&void 0!==n){var e=t,r=s.checkFormula(Gs(_p.Cell,e.range),{node:v,spans:n.spans});if(xp(r)){var a=l.compileFormula(cd(_p.Cell,e.range),r);if(Mp(a)){var o=f.evalFormula(iv(Yt(e)),a.value,void 0);o.kind!==Gp.Paused&&(i=o)}}m=!0}}return{setCellAndFormula:function(e,n){t=e,r=n,g()},getSubExpressionSpanFromFormulaCharacterIndex:function(e){if(S(e),void 0!==n&&void 0!==v){var t=n.spans[v.label];if(void 0!==t)return t}return Pp},evaluateSubExpressionFromFormulaCharacterIndex:function(e){return S(e),E(),void 0!==i?Promise.resolve(i):Promise.resolve(Up(gt("formula Inspector Service.evaluateSubExpressionFromFormulaCharacterIndex : No valid formula to evaluate.")))},evaluateSubExpression:function(){return C(),void 0!==n&&(v=n.node,i=void 0,m=!1),E(),void 0!==i?Promise.resolve(i):Promise.resolve(Up(gt("formula Inspector Service.evaluateSubExpression : No valid formula to evaluate.")))}}}!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(Fp||(Fp={}));var Wp=function(){function e(e,t){this.localeInfo=e,this.source=t,this.bytecode=[],this.blocks=[];for(var r="",n=0;n<t.length;n+=1){var i=t.charCodeAt(n);if(126===i&&n+1<t.length){var a=t.charCodeAt(n+1);if(63===a||42===a){r+=t.charAt(n+1),n+=1;continue}}63!==i&&42!==i?r+=t.charAt(n):(this.pushBlock(r),r="",this.pushMeta(i))}this.pushBlock(r)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(Fp.OP_DOT)}},e.prototype.pushMeta=function(e){63===e?this.bytecode.push(Fp.OP_DOT):this.bytecode.push(Fp.OP_DOTSTAR)},e.prototype.test=function(e){var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(var i=0;i<n.length;i+=1){var a=Number(n[i]);if(a!==this.bytecode.length){var o=this.bytecode[a];switch(o){case Fp.OP_DOT:this.addState(t,a+1);break;case Fp.OP_DOTSTAR:this.addState(t,a);break;default:var u=this.blocks[o];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,a+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;var r=this.bytecode;t<r.length&&r[t]===Fp.OP_DOTSTAR&&(e[t+1]=!0)},e}(),Bp={"=":qe.Eq,"<":qe.Lt,">":qe.Gt},Hp={"<>":qe.Ne,"<=":qe.Le,">=":qe.Ge};function jp(e,t){(function(e,t){for(var r=0;r<t.length;r+=1)if(e.isNumeral(t.charCodeAt(r)))return!0;return!1})(e,t)&&tv(jt(["potential string -> number coercion: "+Ca(t)]))}function Kp(e,t){if("string"!=typeof t)return t;var r,n,i=(r=t).length>=2&&void 0!==(n=Hp[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=Bp[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:i[0],operand:function(e,t){if(0===e.stringCompareCI(t,e.trueName))return!0;if(0===e.stringCompareCI(t,e.falseName))return!1;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(void 0!==n&&0===e.stringCompareCI(n,t))return be(r)}var i=e.parseNumber(t);return Wt(i)?i:(jp(e,t),t)}(e,i[1])}}function qp(e,t,r,n){var i=function(e,t){var r="object"==typeof t&&"FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:qe.Eq,operand:t},n=e.config,i=n.mathpack,a=n.localeInfo;if(r.operator===qe.Ne&&""===r.operand)return function(e){return!Gd(e)};if(r.operator===qe.Eq&&""===r.operand)return Gd;if(void 0!==r.operator&&""===r.operand)return function(e){return!1};if(void 0===r.operator&&""===r.operand)return function(e){return Gd(e)||""===e};var o,u,c=void 0===r.operator?qe.Eq:r.operator;switch(typeof r.operand){case"number":return o=c,u=r.operand,function(e){var t=Wd(e)?e.getFallback():e;if("number"==typeof t)return Mv(i,o,t,u);if("string"==typeof t&&o===qe.Eq){var r=a.parseNumber(t);return Wt(r)?Mv(i,o,r,u):(jp(a,t),!1)}return o===qe.Ne};case"boolean":return function(e,t){return function(r){var n=Wd(r)?r.getFallback():r;return"boolean"==typeof n?_v(e,n,t):e===qe.Ne}}(c,r.operand);case"string":return function(e,t){switch(e){case qe.Eq:case qe.Ne:var r=new Wp(a,t);return function(t){var n=Wd(t)?t.getFallback():t;return"string"!=typeof n?e===qe.Ne:r.test(n)===(e===qe.Eq)};case qe.Lt:case qe.Gt:case qe.Le:case qe.Ge:return function(r){var n=Wd(r)?r.getFallback():r;return"string"==typeof n&&Dv(a,e,n,t)}}}(c,r.operand);case"object":return Ud(r.operand)?function(e,t){return function(r){var n=Wd(r)?r.getFallback():r;return Ud(n)?wv(e,n.type-t.type):e===qe.Ne}}(c,r.operand):T("calc.funcs.criteria.compileCriteria",r.operand)}return T("calc.funcs.criteria.compileCriteria",r.operand)}(e,Kp(e.config.localeInfo,r)),a=t,o=void 0===n?a:n;return new Yf(o.rows,o.cols,Or(a.denseRows,o.denseRows),Or(a.denseCols,o.denseCols),(function(e,t){return i(a.get(e,t))?o.get(e,t):void 0}),(function(){return i(a.getSparse())?o.getSparse():void 0}))}function Jp(e,t,r,n,i){var a=function(n,a,u,c){if("object"==typeof a&&a.kind===te.Array){for(var s=new qf(a.rows,a.cols,a.opers),l=n,f=0;f<u;f+=1)l=o(l,s);return l}var d=(c&&void 0!==i?i:r)(e,a);return null==d?n:t(n,d,u)};function o(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var i=0;i<t.cols;i+=1){var o=t.get(n,i);void 0!==o&&(r=a(r,o,1,!0))}return r}function u(e,t){for(var r=e,n=t.getSparse(),i=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var u=0;u<t.denseCols;u+=1){var c=t.get(o,u);void 0!==c&&(r=a(r,c,1,!1))}i>0&&void 0!==n&&(r=a(r,n,i,!1))}var s=(t.rows-t.denseRows)*t.cols;return s>0&&void 0!==n&&(r=a(r,n,s,!1)),r}return n.reduce((function(e,t){return"object"==typeof t&&t.kind===uh.RangeValues?t.arrays.reduce(u,e):a(e,t,1,!1)}),void 0)}function Xp(e){return function(t,r){return e(t)(r[0])}}function Yp(e){return function(t,r){return e(t)(r[0],r[1])}}var Qp=function(e){return"number"==typeof e?e:k("calc.funcs.assertNumber")},zp=function(e){return"string"==typeof e?e:k("calc.funcs.assertString")};function Zp(e,t){var r=Yd(e,t,!1),n=Wd(r)?r.getFallback():r;switch(typeof n){case"number":return n;case"boolean":return Le;case"string":var i=e.coerceOper(n,te.Number);return"number"==typeof i?i:Le;case"object":switch(n.kind){case te.Error:return n;case te.Array:return Le;case te.Missing:return Me;case te.Blank:return e.mathpack.zero}}return T("calc.funcs.chkNumOper",n)}function $p(e,t){var r=Wd(t)?t.getFallback():t;switch(typeof r){case"number":return r;case"object":break;default:return}switch(r.kind){case te.Error:return r;case te.Missing:case te.Blank:return;default:return T("calc.funcs.arithmeticOperationCoerce",r)}}function em(e,t){var r=Wd(t)?t.getFallback():t;switch(typeof r){case"boolean":return r?e.mathpack.one:e.mathpack.zero;case"number":return r;case"string":return e.mathpack.zero;case"object":break;default:return T("calc.funcs.arithmeticAOperationCoerce",r)}switch(r.kind){case te.Error:return r;case te.Missing:case te.Blank:return;default:return T("calc.funcs.arithmeticAOperationCoerce",r)}}function tm(e){return function(t,r,n){if(void 0!==t&&Ud(t))return t;if(A("calc.funcs.numberReducer",void 0===t||"number"==typeof t),Ud(r))return r;var i,a;A("calc.funcs.numberReducer","number"==typeof r),void 0===t?(i=r,a=n-1):(i=t,a=n);for(var o=0;o<a;o+=1){var u=e(i,r);if(Ud(u))return u;i=u}return i}}function rm(e){return function(t,r,n){return e.count+=n,r}}function nm(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if("object"==typeof r&&r.kind===uh.RangeValues)for(var n=r.arrays.length-1;n>=0;n-=1){var i=r.arrays[n];if(i.rows>i.denseRows||i.cols>i.denseCols)if("number"==typeof(u=i.getSparse()))return u;for(var a=i.denseRows-1;a>=0;a-=1)for(var o=i.denseCols-1;o>=0;o-=1){var u;if("number"==typeof(u=i.get(a,o)))return u}}}}function im(e,t,r){return"number"!=typeof t||"number"!=typeof r?t:e.checkAlmostCancellation(r,t)}function am(e,t){var r=im(e.mathpack,Jp(e,tm(e.mathpack.add),$p,t),nm(t));return null==r?e.mathpack.zero:r}function om(e){return e.kind===te.Range&&(!Ct(e.sheets)||1!==e.ranges.length)}function um(e,t,r){if(om(t))return pt(Le);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return vt({values:n,valuesToFilter:n})}if(om(r))return pt(Le);var i=function(e,t){var r=e.ranges[0],n=t.ranges[0],i=Rr(r.cols,16384-n.col),a=Rr(r.rows,(1<<20)-n.row),o=ir(r.row,r.col,a,i),u=Be(e.sheets,o),c=ir(n.row,n.col,a,i),s=Be(t.sheets,c);return{actualEvalRange:u,actualFilterRange:s}}(t,r),a=i.actualEvalRange,o=i.actualFilterRange,u=a.ranges[0],c=o.ranges[0],s=e.dereferenceAllOpers([a])[0];return u.col===c.col&&u.row===c.row?vt({values:s,valuesToFilter:s}):vt({values:s,valuesToFilter:e.dereferenceAllOpers([o])[0]})}function cm(e,t){var r=t,n=r[0],i=r[1],a=um(e,n,r[2]);if(!mt(a))return a.reason;var o=a.value,u=o.values,c=o.valuesToFilter;return am(e,[dh([qp(e,u.arrays[0],i,c.arrays[0])])])}function sm(e,t){var r=Jp(e,tm(e.mathpack.mul),$p,t);return null==r?e.mathpack.zero:r}function lm(e,t,r,n){var i=im(r.mathpack,Jp(r,tm(r.mathpack.add),e,n,t),nm(n));if(null==i)return Fe;if(Ud(i))return i;var a={count:0},o=Jp(r,rm(a),e,n,t);return A("calc.funcs.averageCoerceInner","number"==typeof i&&"number"==typeof o&&a.count>0),r.mathpack.div(i,r.mathpack.fromNumber(a.count))}var fm=lm.bind(void 0,$p,void 0),dm=lm.bind(void 0,em,(function(e,t){var r=Wd(t)?t.getFallback():t;return"string"==typeof r?e.mathpack.zero:$p(0,r)}));function hm(e,t){var r=t,n=r[0],i=r[1],a=um(e,n,r[2]);if(!mt(a))return a.reason;var o=a.value,u=o.values,c=o.valuesToFilter,s=[dh([qp(e,u.arrays[0],i,c.arrays[0]).strict()])];return fm(e,s)}function vm(e,t){var r=e.dereferenceAllOpers(t);return dm(e,r)}function pm(e,t,r,n,i){for(var a=void 0,o=0,u="",c=function(e,t){return e.coerceOper(t,te.String)},s=function(e,n,i){if(void 0!==e&&Ud(e))return e;for(var c=0;c<i;c+=1){if(void 0!==a&&t.length>0&&(!r||a.length>0)){var s=t[o];if(o=(o+1)%t.length,u.length+s.length>32767)return Le;u+=s}if(Ud(n))return n;if("string"!=typeof n)return k("calc.funcs.concatInner: expected string in reducer");if(u.length+n.length>32767)return Le;if(u+=n,a=n,""===n&&(0===t.length||r))break}return n},l=0;l<i.length;l+=1){var f=n[l];if(Vd(f)&&f.ranges.length>1)return Le;var d=Jp(e,s,c,i.slice(l,l+1));if(void 0!==d&&Ud(d))return d;A("calc.funcs.concatInner: expected string from reduce","string"==typeof d)}if(r&&""===a&&t.length>0&&u.length>0){var h=t[(o+t.length-1)%t.length];u=u.substring(0,u.length-h.length)}return u}function mm(e,t){var r=t,n=e.dereferenceAllOpers(t);return pm(e,[],!0,r,n)}function gm(e,t){var r=t,n=r[0],i=r[1],a=r.slice(2),o=[];if(!Pd(n)){if(Vd(n)&&n.ranges.length>1)return Le;var u=Jp(e,Hm(o,zp),(function(e,t){return e.coerceOper(t,te.String)}),e.dereferenceAllOpers([n]));if(void 0!==u&&Ud(u))return u;A("calc.funcs.textjoin: expected string from reduce","string"==typeof u)}return pm(e,o,Pd(i)||i,a,e.dereferenceAllOpers(a))}function Cm(e,t,r){var n={count:0};return Jp(t,rm(n),e,r),t.mathpack.fromNumber(n.count)}var Sm=Cm.bind(void 0,(function(e,t){var r=Wd(t)?t.getFallback():t;return"number"==typeof r?r:void 0}));function Em(e,t){var r=e.dereferenceAllOpers(t);return Sm(e,r)}var ym=Cm.bind(void 0,(function(e,t){var r=Wd(t)?t.getFallback():t;return Gd(r)||""===r?r:void 0}));var Rm=Cm.bind(void 0,(function(e,t){var r=Wd(t)?t.getFallback():t;return"object"!=typeof r||r.kind===te.Error?r:void 0}));function Om(e,t){var r=e.dereferenceAllOpers(t);return Rm(e,r)}var Im=Cm.bind(void 0,(function(e,t){return t}));function Tm(e,t){var r=t,n=r[0],i=r[1];if(om(n))return Le;var a=e.dereferenceAllOpers([n])[0],o=[dh([qp(e,a.arrays[0],i)])];return Im(e,o)}var km=function(e,t,r){return e.mathpack.cond2(t,r)>0},Am=function(e,t,r){return e.mathpack.cond2(t,r)<0};function bm(e,t,r,n,i){var a=Jp(n,(function(t,r,i){return void 0===t?r:Ud(t)?t:(A("calc.funcs.minMaxCoerceInner","number"==typeof t),Ud(r)?r:(A("calc.funcs.minMaxCoerceInner","number"==typeof r),e(n,t,r)?t:r))}),t,i,r);return null==a?n.mathpack.zero:a}var Nm=bm.bind(void 0,km,$p,void 0),Fm=bm.bind(void 0,Am,$p,void 0),Lm=bm.bind(void 0,km,em,$p),wm=bm.bind(void 0,Am,em,$p);function _m(e,t){var r=e.dereferenceAllOpers(t);return Lm(e,r)}function Dm(e,t){var r=e.dereferenceAllOpers(t);return wm(e,r)}function Mm(e,t){var r=Wd(t)?t.getFallback():t;switch(typeof r){case"boolean":return r;case"number":return 0!==e.mathpack.cond(r);case"object":break;default:return}switch(r.kind){case te.Error:return r;case te.Missing:case te.Blank:return;default:return T("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function Um(e,t,r){var n=Jp(t,(function(t,r,n){return void 0!==t&&Ud(t)?t:Ud(r)?r:(A("calc.funcs.booleanInner",(void 0===t||"boolean"==typeof t)&&"boolean"==typeof r),e(t,r,n))}),Mm,r);return null==n?Le:n}var Gm=Um.bind(void 0,(function(e,t){return!1!==e&&t})),xm=Um.bind(void 0,(function(e,t){return!0===e||t})),Pm=Um.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function Vm(e,t){var r=e.dereferenceAllOpers(t);return Gm(e,r)}function Wm(e,t){var r=e.dereferenceAllOpers(t);return xm(e,r)}function Bm(e,t){var r=e.dereferenceAllOpers(t);return Pm(e,r)}function Hm(e,t){return function(r,n,i){if(void 0!==r&&Ud(r))return r;if(!Ud(n))for(var a=0;a<i;a+=1)e.push(t(n));return n}}function jm(e,t,r,n){var i=[],a=Jp(t,Hm(i,Qp),$p,[r]);if(null==a)return De;if(Ud(a))return a;var o=t.mathpack;if(o.cond2(n,o.one)<0)return De;if(o.cond2(n,o.fromNumber(i.length))>0)return De;var u=i.sort(o.cond2);if(e){var c=Qp(o.add(Qp(o.sub(o.fromNumber(i.length),n)),o.one));return u[o.lfix(c)-1]}return u[o.lfix(n)-1]}var Km=jm.bind(void 0,!0),qm=jm.bind(void 0,!1);function Jm(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return Km(e,n,i)}function Xm(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return qm(e,n,i)}function Ym(e,t,r,n){var i=e.mathpack,a=[],o=Jp(e,Hm(a,Qp),$p,t);if(null==o)return De;if(Ud(o))return o;if(Ud(r))return r;if(i.cond(r)<0)return De;if(i.cond2(r,i.one)>0)return De;var u=a.sort(i.cond2),c=Qp(i.sub(i.fromNumber(u.length),i.one)),s=Qp(i.add(i.fromNumber(u.length),i.one)),l=Qp(n?i.mul(c,r):i.sub(Qp(i.mul(s,r)),i.one));if(i.cond(l)<0||i.cond2(l,c)>0)return De;var f=i.lfix(l),d=Qp(i.sub(l,i.fromNumber(f)));if(0===i.cond(d))return u[f];var h=i.sub(u[f+1],u[f]);return Ud(h)?h:i.add(u[f],Qp(i.mul(h,d)))}var Qm=function(e,t,r){return Ym(e,[t],r,!0)};function zm(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return Qm(e,n,i)}var Zm=function(e,t,r){return Ym(e,[t],r,!1)};function $m(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return Zm(e,n,i)}function eg(e,t){var r=e.mathpack;if(r.cond(t)<0)return De;if(r.cond2(t,r.fromNumber(5))>=0)return De;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}var tg=function(e,t,r){return Ym(e,[t],eg(e,r),!0)};function rg(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return tg(e,n,i)}var ng=function(e,t,r){return Ym(e,[t],eg(e,r),!1)};function ig(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return ng(e,n,i)}function ag(e,t){return Ym(e,t,e.mathpack.fromNumber(.5),!0)}function og(e,t){var r=e.dereferenceAllOpers(t);return ag(e,r)}function ug(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1],a=[],o=Jp(e,Hm(a,Qp),$p,[n]);if(null==o)return De;if(Ud(o))return o;var u=e.mathpack;if(u.cond(i)<0)return De;if(u.cond2(i,u.one)>=0)return De;a=a.sort(u.cond2);var c=u.lfix(Qp(u.div(Qp(u.mul(u.fromNumber(a.length),i)),u.fromNumber(2))));A("calc.funcs.trimmean",c+c<a.length);var s=a[c],l=a[a.length-1-c],f=0,d=0,h=Jp(e,tm(e.mathpack.add),(function(e,t){var r=$p(0,t);if(void 0===r)return r;A("calc.funcs.trimmean: unexpected error","number"==typeof r);var n=e.mathpack;if(n.cond2(r,s)<0)f+=1;else{if(!(n.cond2(r,l)>0))return r;d+=1}}),[n]);A("calc.funcs.trimmean: found no elements","number"==typeof h),A("calc.funcs.trimmean: trimmed too many",f<=c&&d<=c);for(var v=h;f<c;f+=1){if(Ud(p=u.sub(v,s)))return p;v=p}for(;d<c;d+=1){var p;if(Ud(p=u.sub(v,l)))return p;v=p}return u.div(v,u.fromNumber(a.length-c-c))}function cg(e){return function(t,r){var n=e(t,r);return"number"==typeof n?t.mathpack.mul(n,n):n}}function sg(e,t){return function(r,n){var i=e(r,n);if("number"!=typeof i)return i;var a=r.mathpack,o=a.sub(i,t);return Ud(o)?o:a.mul(o,o)}}function lg(e,t,r,n){var i={count:0};if(null==Jp(r,rm(i),e,n,t))return Fe;A("calc.funcs.varFirstPass: unexpected count type",i.count>=1);var a=tm(r.mathpack.add),o=Jp(r,a,e,n,t),u=Jp(r,a,cg(e),n,void 0===t?void 0:cg(t));if(A("calc.funcs.varFirstPass: unexpected sum type",null!=o),Ud(o))return o;A("calc.funcs.varFirstPass: unexpected error","number"==typeof o&&"number"==typeof u);var c=r.mathpack,s=c.div(o,c.fromNumber(i.count));return Ud(s)?s:[i.count,o,u,s]}function fg(e,t,r,n,i){var a=Jp(r,tm(r.mathpack.add),sg(e,i),n,void 0===t?void 0:sg(t,i));return A("calc.funcs.varSecondPass: unexpected error","number"==typeof a),a}function dg(e,t,r,n){var i=lg(e,t,r,n);if(!Array.isArray(i))return i;var a=r.mathpack,o=i[0],u=i[1],c=i[2],s=i[3];if(o<2)return Fe;var l=a.mul(u,u);if(Ud(l))return l;var f=Qp(a.div(l,a.fromNumber(o))),d=Qp(a.sub(c,f));if(0===a.cond(s))return a.cond(d)<0?a.zero:a.div(d,a.fromNumber(o-1));if(a.cond(d)>=0){var h=Qp(a.div(d,a.fromNumber(o-1)));if(a.cond2(h,a.fromNumber(21219957905e-324))>0){var v=a.div(f,c),p=Ud(v)?v:a.sub(v,a.one);if(!Ud(p)&&a.cond2(a.abs(p),a.fromNumber(.01))>0){var m=a.div(s,h),g=Ud(m)?m:a.sub(a.abs(m),a.fromNumber(1e3));if(!Ud(g)&&a.cond(g)<0)return h}}}var C=fg(e,t,r,n,s);return a.cond(C)<0?a.zero:a.div(C,a.fromNumber(o-1))}function hg(e,t,r,n){var i=lg(e,t,r,n);if(!Array.isArray(i))return i;var a=r.mathpack,o=i[0],u=i[1],c=i[2],s=i[3];if(o<1)return Fe;var l=a.mul(u,u);if(Ud(l))return l;var f=a.mul(c,a.fromNumber(o));if(Ud(f))return f;var d=Qp(a.sub(f,l));if(0===a.cond(s))return a.cond(d)<0?a.zero:a.div(d,a.fromNumber(o*o));if(a.cond(d)>=0){var h=Qp(a.div(d,a.fromNumber(o*o)));if(a.cond2(h,a.fromNumber(21219957905e-324))>0){var v=a.div(Qp(a.div(l,a.fromNumber(o))),c),p=Ud(v)?v:a.sub(v,a.one);if(!Ud(p)&&a.cond2(a.abs(p),a.fromNumber(.01))>0){var m=a.div(s,h),g=Ud(m)?m:a.sub(a.abs(m),a.fromNumber(1e3));if(!Ud(g)&&a.cond(g)<0)return h}}}var C=fg(e,t,r,n,s);return a.cond(C)<0?a.zero:a.div(C,a.fromNumber(o))}var vg=dg.bind(void 0,$p,void 0),pg=hg.bind(void 0,$p,void 0),mg=dg.bind(void 0,em,$p),gg=hg.bind(void 0,em,$p);function Cg(e){return function(t,r){var n=e(t,r);return"number"!=typeof n?n:t.mathpack.sqrt(n)}}var Sg=Cg(vg),Eg=Cg(pg),yg=Cg(mg),Rg=Cg(gg);function Og(e,t){var r=e.dereferenceAllOpers(t);return Sg(e,r)}function Ig(e,t){var r=e.dereferenceAllOpers(t);return Eg(e,r)}function Tg(e,t){var r=e.dereferenceAllOpers(t);return yg(e,r)}function kg(e,t){var r=e.dereferenceAllOpers(t);return Rg(e,r)}function Ag(e,t){var r=e.dereferenceAllOpers(t);return vg(e,r)}function bg(e,t){var r=e.dereferenceAllOpers(t);return pg(e,r)}function Ng(e,t){var r=e.dereferenceAllOpers(t);return mg(e,r)}function Fg(e,t){var r=e.dereferenceAllOpers(t);return gg(e,r)}var Lg=[fm,Sm,Rm,Nm,Fm,sm,Sg,Eg,am,vg,pg];function wg(e,t){var r,n=[],i=Jp(e,(r=n,function(e,t,n){if(void 0!==e&&Ud(e))return e;if("number"==typeof t)for(var i=0;i<n;i+=1)r.push({value:t,index:r.length});return t}),$p,t);if(null==i)return Me;if(Ud(i))return i;var a=e.mathpack,o=n.sort((function(e,t){return a.cond2(e.value,t.value)})),u=1,c=0,s=1/0,l=[];function f(e){u=1,s=e.index}var d,h,v,p=function(e){var t=e.value;u>c?(c=u,l.length=0,l.push({value:t,index:s})):u===c&&l.push({value:t,index:s})};f(o[0]);for(var m=1;m<o.length;m+=1)h=o[m-1],v=o[m],0===a.cond2(h.value,v.value)?((d=o[m]).index<s&&(s=d.index),u+=1):(p(o[m-1]),f(o[m]));return p(o[o.length-1]),c<2?Me:(A("calc.funcs.modeInner: unexpected error",0!==l.length),l.sort((function(e,t){return e.index-t.index})))}function _g(e,t){var r=wg(e,t);return Array.isArray(r)?r[0].value:r}function Dg(e,t){var r=e.dereferenceAllOpers(t);return _g(e,r)}function Mg(e,t){var r=e.dereferenceAllOpers(t),n=wg(e,r);return Array.isArray(n)?Ve(n.length,1,n.map((function(e){return[e.value]}))):n}function Ug(e){return"object"!=typeof e||e.kind!==uh.RangeValues?e:dh(e.arrays.map((function(e){return e.map((function(e){var t=e[0],r=e[1];return void 0!==r&&function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(void 0!==r&&r.kind===G.WorksheetFuncName&&(r.id===He.SUBTOTAL||r.id===He.AGGREGATE))return!0}return!1}(r.formula.annotations)?void 0:t}))})))}function Gg(e,t){var r=e.mathpack.sfix(t[0]),n=Lg.length;if(!(r>=1&&r<=n||r>=101&&r<=n+100))return Le;var i=r>100||e.isInFilterMode(t.slice(1)),a=e.dereferenceAllOpersAndFormulae(t.slice(1),i).map(Ug);return(0,Lg[r%100-1])(e,a)}var xg=j(Lg,[ag,_g]),Pg=[Km,qm,Qm,tg,Zm,ng];function Vg(e,t){var r=e.mathpack,n=r.sfix(t[0]),i=r.sfix(t[1]);if(!(n>=1&&n<=xg.length+Pg.length&&i>=0&&i<=7))return Le;var a=1==(1&i),o=2==(2&i),u=!(4==(4&i));function c(t){var r=u?e.dereferenceAllOpersAndFormulae(t,a).map(Ug):e.dereferenceAllOpers(t,a);return o&&(r=r.map((function(e){if("object"!=typeof e)return e;if(e.kind===uh.RangeValues)return dh(e.arrays.map((function(e){return e.map((function(e){return void 0===e||Ud(e)?void 0:e}))})));if(e.kind===te.Array){var t=e.opers.map((function(e){return e.map((function(e){return void 0===e||Ud(e)?void 0:e}))}));return function(e,t,r){return b("calc.runtime.coercedArrayOper",e),b("calc.runtime.coercedArrayOper",t),r.length!==e?k("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:te.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,t)}return e}))),r}if(n>xg.length){if(4!==t.length)return Le;var s=e.dereferenceOper(t[3],te.Number);if(Ud(s))return Le;var l=t[2];if(l.kind===te.Range&&!Ct(l.sheets))return Le;var f=c([l])[0],d=xg.length;return(0,Pg[n-d-1])(e,f,s)}for(var h=2;h<t.length;h+=1){var v=t[h];if(!Vd(v)||!Ct(v.sheets))return Le}var p=c(t.slice(2));return A("calc.funcs.aggregate: requested non-array function with unexpected number",n>=1&&n<=xg.length),(0,xg[n-1])(e,p)}var Wg=ia.numErrorOper;function Bg(e,t){return e.mathpack.pi}var Hg=Xp((function(e){return e.mathpack.sqrt})),jg=Xp((function(e){return e.mathpack.exp})),Kg=Yp((function(e){return e.mathpack.power})),qg=Xp((function(e){return e.mathpack.ln})),Jg=Xp((function(e){return e.mathpack.log}));function Xg(e,t){var r=t,n=r[0],i=r[1],a=e.mathpack;if(void 0===i)return a.log(n);var o=a.ln(n);if(Ud(o))return o;var u=a.ln(i);return Ud(u)?u:a.div(o,u)}var Yg=Xp((function(e){return e.mathpack.sin})),Qg=Xp((function(e){return e.mathpack.cos})),zg=Xp((function(e){return e.mathpack.tan})),Zg=Xp((function(e){return e.mathpack.asin})),$g=Xp((function(e){return e.mathpack.acos})),eC=Xp((function(e){return e.mathpack.atan})),tC=Yp((function(e){return e.mathpack.atan2}));function rC(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)}var nC=Yp((function(e){return e.mathpack.round}));function iC(e,t){var r=t,n=r[0],i=r[1],a=e.mathpack;return a.roundDown(n,null!=i?i:a.zero)}var aC=Yp((function(e){return e.mathpack.roundUp})),oC=Yp((function(e){return e.mathpack.roundDown}));function uC(e,t){var r=Zp(e,t[0]);if(Ud(r))return r;var n=Zp(e,t[1]);if(Ud(n))return n;var i=e.mathpack;if(0===i.cond(n))return i.zero;if(0!==i.cond(r)&&i.cond(r)<0!=i.cond(n)<0)return Wg;var a=i.div(r,n);if(Ud(a))return Wg;var o=i.floor(a),u=Qp(i.sub(a,o)),c=i.fromNumber(.5-5e-15);if(i.cond2(u,c)<0)return i.mul(o,n);var s=i.add(o,i.one);return Ud(s)?s:i.mul(s,n)}function cC(e,t,r){var n=e.cond(t),i=e.cond(r);if(n>0&&i<0)return Wg;if(0===n||0===i)return e.zero;var a=e.div(t,r);return Ud(a)?a:e.mul(e.ceil(e.viewRound(a)),r)}function sC(e,t,r){var n=e.cond(t),i=e.cond(r);if(n>0&&i<0)return Wg;if(0===n&&0===i)return t;var a=e.div(t,r);return Ud(a)?a:e.mul(e.floor(e.viewRound(a)),r)}function lC(e,t){return cC(e.mathpack,t[0],t[1])}function fC(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=e.mathpack,u=void 0===i||Pd(i)?o.one:o.abs(i),c=void 0===a||Pd(a)?o.zero:a;return 0!==o.cond(c)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:cC(o,n,u)}function dC(e,t){var r=t,n=r[0],i=r[1],a=e.mathpack,o=void 0===i||Pd(i)?a.one:a.abs(i);return 0===a.cond(o)?a.zero:cC(a,n,o)}function hC(e,t){return sC(e.mathpack,t[0],t[1])}function vC(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=e.mathpack,u=void 0===i||Pd(i)?o.one:o.abs(i),c=void 0===a||Pd(a)?o.zero:a;return 0!==o.cond(c)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:sC(o,n,u)}function pC(e,t){var r=t,n=r[0],i=r[1],a=e.mathpack,o=void 0===i||Pd(i)?a.one:a.abs(i);return 0===a.cond(o)?a.zero:sC(a,n,o)}function mC(e,t,r){var n=e.div(t,r);if(Ud(n))return n;var i=e.mul(e.trunc(n),r);if(Ud(i))return i;var a=e.sub(t,i);return!Ud(a)&&e.cond(t)<0?e.abs(a):a}function gC(e,t,r){var n=r[0],i=t.mathpack;if(i.cond(n)>=0){var a=i.ceil(n);return 0===i.cond2(Qp(mC(i,a,i.fromNumber(2))),i.one)===e?i.add(a,i.one):a}var o=i.floor(n);return 0===i.cond2(Qp(mC(i,o,i.fromNumber(2))),i.one)===e?i.sub(o,i.one):o}var CC=gC.bind(void 0,!0),SC=gC.bind(void 0,!1),EC=Xp((function(e){return e.mathpack.abs}));function yC(e,t){var r=e.mathpack;return r.fromNumber(r.cond(t[0]))}function RC(e,t){var r=e.mathpack,n=Qp(r.div(r.fromNumber(180),r.pi));return r.mul(t[0],n)}function OC(e,t){var r=e.mathpack,n=Qp(r.div(r.pi,r.fromNumber(180)));return r.mul(t[0],n)}function IC(e,t){var r=Zp(e,t[0]);if(Ud(r))return r;var n=Zp(e,t[1]);if(Ud(n))return n;var i=e.mathpack;if(0===i.cond(n))return Fe;var a=i.div(r,n);return Ud(a)?Wg:i.cond(a)>0?i.floor(a):i.ceil(a)}function TC(e,t){var r=t[0],n=e.mathpack,i=n.sfix(r);if(n.cond(r)<0||i>170)return Wg;for(var a=n.one,o=i;o>0;o-=1){if(Ud(a))return a;a=n.mul(n.fromNumber(o),a)}return a}function kC(e,t){var r=Zp(e,t[0]);if(Ud(r))return r;var n=e.mathpack,i=n.floor(r);if(n.cond2(i,n.fromNumber(-1))<0||n.cond2(i,n.fromNumber(300))>0)return Wg;for(var a=n.one,o=n.toNumber(i);o>1;o-=2){if(Ud(a))return a;a=n.mul(n.fromNumber(o),a)}return a}function AC(e,t){var r=Zp(e,t[0]);if(Ud(r))return r;var n=e.mathpack;if(n.cond(r)<0)return Wg;var i=n.mul(n.pi,r);return Ud(i)?i:n.sqrt(i)}function bC(e,t){return Yd(e,t[0],!0)instanceof pp}function NC(e,t){var r=Zp(e,t[0]);if(Ud(r))return r;var n=e.mathpack,i=Qp(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),a=Qp(n.div(n.floor(i),n.fromNumber(2)));return 0===n.cond2(a,n.floor(a))}function FC(e,t,r){var n=t[0];if(!Ct(n.sheets))return Le;var i=n.ranges[0];if(e.calcingArray||!Et(i)){var a=n.sheets;return Ve(i.rows,i.cols,Qf(i.rows,i.cols,(function(t,n){var o=sr(a,ar(i.row+t,i.col+n));return r(e.getCellFormula(o),o)})))}var o=Nt(cr(n.sheets,i));return r(e.getCellFormula(o),o)}function LC(e,t){return FC(e,t,(function(e){return void 0!==e}))}function wC(e,t){return FC(e,t,(function(t,r){if(void 0===t)return Me;var n=e.formatFormula(t,r.range);return t.source===qt.Cell?n:"{"+n+"}"}))}function _C(e){return 55296==(64512&e)}function DC(e){return 56320==(64512&e)}function MC(e){return 55296==(63488&e)}function UC(e,t){if(_C(e)&&DC(t))return 65536+((1023&e)<<10|1023&t)}function GC(e,t,r){for(var n=t,i=0;i<r;i+=1){if(n>=e.length)return;_C(e.charCodeAt(n))&&n+1<e.length&&DC(e.charCodeAt(n+1))?n+=2:n+=1}return n}var xC=ia.valueErrorOper;function PC(e,t){return void 0===t?1:e.cond(t)<0?xC:e.sfix(t)}function VC(e,t){var r,n=t,i=n[0],a=n[1];if(void 0!==a&&Ud(a))return a;var o=PC(e.mathpack,a);if("number"!=typeof o&&Ud(o))return xC;var u=null!=(r=function(e,t,r){for(var n=t,i=0;i<r;i+=1){if(n-1<0)return;DC(e.charCodeAt(n-1))&&n-2>=0&&_C(e.charCodeAt(n-2))?n-=2:n-=1}return n}(i,i.length,o))?r:0;return i.substring(u)}function WC(e,t){var r,n=t,i=n[0],a=n[1];if(void 0!==a&&Ud(a))return a;var o=PC(e.mathpack,a);if("number"!=typeof o&&Ud(o))return xC;var u=null!=(r=GC(i,0,o))?r:i.length;return i.substring(0,u)}function BC(e,t){var r,n,i=t,a=i[0],o=i[1],u=i[2],c=e.mathpack,s=c.fix(o)-1,l=c.fix(u);if(c.cond(o)<0||s<0||c.cond(u)<0||l<0)return xC;var f=null!=(r=GC(a,0,s))?r:a.length,d=null!=(n=GC(a,f,l))?n:a.length;return a.substring(f,d)}function HC(e,t){var r=t[0];return e.mathpack.fromNumber(function(e,t,r){for(var n=0,i=t;i<r;n+=1){_C(e.charCodeAt(i))&&i+1<r&&DC(e.charCodeAt(i+1))?i+=2:i+=1}return n}(r,0,r.length))}function jC(e,t){for(var r=t,n="",i=0;i<r.length;i+=1){var a=r[i];if(n.length+a.length>32767)return n+a.substring(0,32767-n.length);n+=a}return n}function KC(e,t){var r=t;return r[0]===r[1]}function qC(e,t){var r=t[0],n=t[1],i=e.mathpack,a=i.fix(n);return i.cond(n)<0||a>2147483647?xC:""===r?"":a*r.length>32767?xC:r.repeat(a)}function JC(e,t){for(var r=t[0],n="",i=0;i<r.length;){for(;i<r.length&&32===r.charCodeAt(i);)i+=1;for(var a=i;i<r.length;){var o=32===r.charCodeAt(i);if(i+=1,o)break}n+=r.substring(a,i)}return n.length>0&&32===n.charCodeAt(n.length-1)&&(n=n.substring(0,n.length-1)),n}function XC(e,t){for(var r=t[0],n="",i=0;i<r.length;i+=1){var a=r.charCodeAt(i);(a>=256||(127&a)>=32)&&(n+=r.charAt(i))}return n}function YC(e,t){var r=e.mathpack.sfix(t[0]);return r<1||r>255?xC:String.fromCharCode(r)}function QC(e,t){var r=t[0],n=e.mathpack,i=n.lfix(n.trunc(r));if(n.cond2(r,n.one)<0||i>=1114112)return xC;return i<=65535&&MC(i)||i>=64976&&i<=65007||(65535&i)>=65534?Me:function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)}(i)}function zC(e,t){var r=t[0];if(0===r.length)return xC;var n=r.charCodeAt(0);return n>255?tv(id(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)}function ZC(e,t){var r=t[0];if(0===r.length)return xC;var n=r.charCodeAt(0),i=e.mathpack;if(!MC(n))return i.fromNumber(n);if(1===r.length)return xC;var a=UC(n,r.charCodeAt(1));return void 0===a?xC:i.fromNumber(a)}function $C(e){return e>=65&&e<=90||e>=97&&e<=122}function eS(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():tv(id([t+" for non-ASCII input"]))}function tS(e,t){var r=t[0];return eS(r,"LOWER",r.toLowerCase.bind(r))}function rS(e,t){var r=t[0];return eS(r,"UPPER",r.toUpperCase.bind(r))}function nS(e,t){var r=t[0];return eS(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var i=n;n<e.length&&!$C(e.charCodeAt(n));)n+=1;if(t+=e.substring(i,n),n===e.length)break;var a=n;for(t+=e.charAt(n).toUpperCase(),n+=1;n<e.length&&$C(e.charCodeAt(n));)n+=1;t+=e.substring(a+1,n)}return t}))}function iS(e,t){var r=t[0],n=t[1];if(Wd(r)){var i=r.getField(n);if(void 0!==i)return i}return Ge}function aS(e,t){for(var r=t[0],n=e.config.localeInfo,i=ol.create(n.stringCompareCI),a=1;a<t.length;a+=2){var o=t[a],u=t[a+1];i=i.setValue(o,u)}return new vp(i,r)}function oS(e,t){var r=t[0];return Ct(r.sheets)?e.mathpack.fromNumber(r.ranges.length):Le}function uS(e,t){var r=t[0],n=e.mathpack;return xd(r)?n.fromNumber(r.rows):Ct(r.sheets)?r.ranges.length>1?we:n.fromNumber(r.ranges[0].rows):Le}function cS(e,t){var r=t[0],n=e.mathpack;return xd(r)?n.fromNumber(r.cols):Ct(r.sheets)?r.ranges.length>1?we:n.fromNumber(r.ranges[0].cols):Le}function sS(e,t){if(0===t.length)return[e.reflectionGridCell,!e.calcingArray];var r=t[0];if(!Ct(r.sheets))return Le;if(r.ranges.length>1)return we;var n=r.ranges[0];return[n,Et(n)]}function lS(e,t){var r=sS(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],a=e.mathpack;return i?a.fromNumber(n.row+1):Ve(n.rows,1,Qf(n.rows,1,(function(e){return a.fromNumber(n.row+e+1)})))}function fS(e,t){var r=sS(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],a=e.mathpack;return i?a.fromNumber(n.col+1):Ve(1,n.cols,Qf(1,n.cols,(function(e,t){return a.fromNumber(n.col+t+1)})))}function dS(e,t){var r=e.mathpack;if(0===t.length)return r.fromNumber(e.getSheetRangeIndexes(function(e){return{document:e,index:void 0,index2:void 0}}(e.reflectionSheet.document)).length);var n=t[0];return xd(n)?Me:r.fromNumber(e.getSheetRangeIndexes(n.sheets).length)}function hS(e,t){var r=e.mathpack;if(0===t.length){var n=e.reflectionSheet;return void 0===n.index?Me:r.fromNumber(e.getSheetRangePosition(n)+1)}var i=t[0];if("string"==typeof i){var a=e.getSheetIndex(e.reflectionSheet.document,i);return void 0===a?Me:r.fromNumber(e.getSheetRangePosition(a)+1)}return i.kind===te.Range?r.fromNumber(e.getSheetRangePosition(i.sheets)+1):i.kind===te.Array?Me:T("calc.funcs.sheet",i)}function vS(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=r[3],u=r[4];if(!Ct(n.sheets))return Le;if(1!==n.ranges.length)return Le;var c=e.mathpack,s=n.ranges[0],l=s.row,f=s.col,d=s.rows,h=s.cols,v=l;"number"==typeof i&&(v+=c.lfix(i));var p=f;"number"==typeof a&&(p+=c.lfix(a));var m=v+d-1;if("number"==typeof o){if(0===(C=c.cond(o)))return we;m=v+c.lfix(o)-(C>0?1:-1)}var g=p+h-1;if("number"==typeof u){var C;if(0===(C=c.cond(u)))return we;g=p+c.lfix(u)-(C>0?1:-1)}var S=Rr(v,m),E=Rr(p,g),y=Or(v,m)-S+1,R=Or(p,g)-E+1;return S<0||E<0||S+y>1<<20||E+R>16384?we:We(n.sheets,[ir(S,E,y,R)])}function pS(e,t){var r=t[0];return xd(r)?Ve(r.cols,r.rows,Qf(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r}function mS(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=r[3],u=r[4],c=e.mathpack,s="number"!=typeof a?0:c.sfix(a)-1;if(s<0||s>3)return Le;var l=0!=(1&s),f=0!=(2&s),d="boolean"!=typeof o||o?_.A1:_.R1C1,h=function(e,t,r){return d===_.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},v=c.sfix(n);if(!h(f,1<<20,v))return Le;if("number"!=typeof i)return Le;var p=c.sfix(i);if(!h(l,16384,p))return Le;var m=ar(v<0?1048575:0,p<0?16383:0),g=$(f?U.Rel:U.Abs,d===_.R1C1&&f?v:v-1),C=$(l?U.Rel:U.Abs,d===_.R1C1&&l?p:p-1),S=hn(e.config.localeInfo,d,m,g,C,!1);return A("calc.funcs.address: cell wrapped",void 0!==S),"string"==typeof u?""===u?"!"+S:u.length>255?Le:Sn(e.config.localeInfo,e.config.refStyle,u)+"!"+S:S}function gS(e,t){var r=t,n=r[0],i=r[1],a="boolean"!=typeof i||i?_.A1:_.R1C1;if(n.length>255||n.length>0&&" "===n[0])return Le;var o=lr(e.originSheet,e.originGridCell),u={lexicalKind:qt.Indirect,origin:o.range,allowRelativeQualifier:!1},c=e.parseFormula(a,o.range,u,"="+n);if(!mt(c))return we;for(var s=c.value.node,l=!1,f=!1;;){if(!l&&s.kind===x.App&&s.head.kind===x.Operator&&s.head.id===qe.Pound&&1===s.args.length&&bn(yn.CalcDynamicArrayOperators)&&(l=!0,s=s.args[0]),f||s.kind!==x.Name){if(s.kind===x.CellRef){var d=e.getCellRef(s.qualifier,s.ref,o,!0);return void 0===d?we:Ct(d.sheets)?l?Gv(e,qe.Pound,[d]):d:we}return we}var h=e.getNameFormula(s.qualifier,s.whole);if(void 0===h)return we;o=lr(o.sheet,ar(0,0)),s=h[1],f=!0}}function CS(e,t){var r=t[0];return A("calc.funcs.if","boolean"==typeof r),t[r?1:2]}function SS(e,t){var r=t[0];A("calc.funcs.choose","number"==typeof r);var n=e.mathpack.fix(r);return n<1||n>t.length-1?Le:t[n]}function ES(e,t){return!0}function yS(e,t){return!1}function RS(e,t){return!t[0]}function OS(e,t){var r=t,n=r[0],i=r[1];return e.followHyperlinks?n:void 0!==i?i:n}function IS(e,t){return Me}function TS(e,t){if(Vd(t)){if(Ct(t.sheets)){var r=We(t.sheets,[bt(t.ranges[0])]);return e.dereferenceOper(r,Dd)}return Le}return t}function kS(e,t){var r=TS(e,t[0]);return"string"==typeof r||Ud(r)?r:""}function AS(e,t){var r=TS(e,t[0]);if("number"==typeof r||Ud(r))return r;var n=e.mathpack;return"boolean"==typeof r&&r?n.one:n.zero}function bS(e,t){var r=t[0],n=e.mathpack;switch(typeof r){case"number":return n.fromNumber(1);case"string":return n.fromNumber(2);case"boolean":return n.fromNumber(4)}switch(r.kind){case te.Error:return n.fromNumber(16);case te.Array:return n.fromNumber(64);case te.Rich:return n.fromNumber(128)}return T("calc.funcs.type",r)}function NS(e,t){var r=t[0];return Ud(r)?e.mathpack.fromNumber(r.type):Me}function FS(e,t){return Le}function LS(e,t){var r=t,n=r[0],i=r[1],a=void 0===i||Pd(i)?e.mathpack.zero:Zp(e,i);if(Ud(a))return a;var o=Zp(e,n);return Ud(o)?o:[o,a]}function wS(e,t){var r=LS(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],a=e.mathpack;return 0===a.cond2(n,i)?a.one:a.zero}function _S(e,t){var r=LS(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],a=e.mathpack;return a.cond2(n,i)>=0?a.one:a.zero}function DS(e,t,r){var n=Yd(e,t,!0);return n instanceof pp?void 0!==r&&n.arity!==r?Me:n:Ud(n)?n:we}function MS(e,t){var r=t,n=r[0],i=r.slice(1),a=DS(e,n,i.length);return Ud(a)?a:e.applyLambda(a,i)}function US(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=DS(e,a,2);if(Ud(o))return o;var u=e.mathpack,c=u.fix(n),s=u.fix(i);if(c<1||s<1)return Le;if(c*s>1e6)return tv(jt(["ARRAY.MAKE with very large size"]));var l=[!1,!1];return ah(new fh(e,c,s,(function(t,r){var n=e.mathpack;return l[0]=n.fromNumber(t+1),l[1]=n.fromNumber(r+1),e.applyLambda(o,l)})))}function GS(e,t){var r=Yd(e,t[0],!0);return r instanceof pp?e.mathpack.fromNumber(r.arity):Me}var xS=ia.OperKind,PS=ia.rangeSeqOper,VS=ia.valueErrorOper,WS=ia.refErrorOper,BS=ia.arrayOper,HS=ra.gridRange,jS=la.isSheetIndex;function KS(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=r[3],u=e.mathpack,c=u.sfix(i);if(c<0)return VS;var s=void 0===a?void 0:u.sfix(a);if(void 0!==s&&s<0)return VS;var l,f,d=void 0===o?0:u.sfix(o)-1;if(d<0)return VS;switch(n.kind){case xS.Range:if(!jS(n.sheets))return VS;if(d>=n.ranges.length)return WS;var h=n.ranges[d];if(void 0===s)if(1===h.rows)l=0,f=c-1;else{if(1!==h.cols)return WS;l=c-1,f=-1}else l=c-1,f=s-1;if(l>=h.rows||f>=h.cols)return WS;var v=HS(h.row+Or(l,0),h.col+Or(f,0),-1===l?h.rows:1,-1===f?h.cols:1);return PS(n.sheets,[v]);case xS.Array:return d>0?WS:(void 0===s?1===n.rows?(l=0,f=c-1):(l=c-1,f=-1):(l=c-1,f=s-1),l>=n.rows||f>=n.cols?WS:-1===l&&-1===f?n:-1===l?BS(n.rows,1,n.opers.map((function(e){return[e[f]]}))):-1===f?BS(1,n.cols,[n.opers[l]]):n.opers[l][f]);default:return T("calc.funcs.lookupFuncs: INDEX",n)}}var qS=function(e){return e<0?qe.Lt:e>0?qe.Gt:qe.Eq};function JS(e,t,r){void 0===r&&(r=!1);var n,i=Wd(t)?t.getFallback():t,a=e.config,o=a.localeInfo,u=a.mathpack;switch(typeof i){case"number":n=function(e){return{correctType:!0,sgnT:(t=u,r=e,n=i,qS(t.cond2(r,n)))};var t,r,n};break;case"string":if(r){var c=new Wp(o,i);n=function(e){return{correctType:!0,sgnT:c.test(e)?qe.Eq:qe.Ne}}}else n=function(e){return{correctType:!0,sgnT:qS(o.stringCompareCI(e,i))}};break;case"boolean":n=function(e){return{correctType:!0,sgnT:(t=e,r=i,qS(t-r))};var t,r};break;case"object":n=function(e){return{correctType:i.kind===e.kind,sgnT:qe.Ne}}}return function(e){var t=Wd(e)?e.getFallback():e;return typeof i!=typeof t?{correctType:!1,sgnT:qe.Ne}:n(t)}}function XS(e,t,r){for(var n=!1,i=r.length-1,a=Math.floor((0+i)/2),o=0,u=i,c=JS(e,t);;){var s=c(r.get(a)).sgnT;if(s===qe.Ne){if(a<u)for(var l=a+1;l<=u;l+=1)if((s=c(r.get(l)).sgnT)!==qe.Ne){a=l;break}s===qe.Ne&&(a=Math.floor((o+u)/2),s=qe.Gt)}if(s===qe.Eq){if(a<i){n=!0,o=a+=1,u=a;continue}return a}if(s===qe.Lt?o=a+1:u=a-1,!(o<=u)){if(n)a-=1;else if(s===qe.Gt&&(a-=1)>=0){o=a,u=a;continue}return a}a=Math.floor((o+u)/2)}}function YS(e,t,r,n){for(var i=-1,a=JS(e,t,n===qe.Eq),o=0;o<r.length;o+=1){var u=a(r.get(o)),c=u.correctType,s=u.sgnT;if(c){if(s===qe.Eq)return o;if(s!==qe.Ne&&s===n)return i;i=o}o===r.denseLength&&(o=Or(o,r.length-2))}return n!==qe.Eq?i:r.length}function QS(e,t){if("number"==typeof t)return t;var r;switch(t.kind){case uh.RangeValues:r=t.arrays[0].get(0,0);break;case xS.Array:r=t.opers[0][0];break;default:return T("calc.funcs.lookupFuncs.getNumFromRef",t)}return Ud(r=e.coerceOper(r,xS.Number))?WS:r}function zS(e){switch(e.kind){case uh.RangeValues:return e.arrays[0];case xS.Array:return new Jf(e.rows,e.cols,e.rows,e.cols,e.opers,Ke)}}function ZS(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=e.mathpack,u=function(e){if("number"==typeof e)return e;switch(e.kind){case xS.Range:if(!jS(e.sheets))return VS;if(e.ranges.length>1)return WS;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?WS:e}}(null!=a?a:o.one);if(Ud(u))return u;var c=e.dereferenceAllOpers([u])[0],s=QS(e,c);if(Ud(s))return s;var l=function(e){if("number"==typeof e)return Me;switch(e.kind){case xS.Rich:return Me;case xS.Range:if(!jS(e.sheets))return VS;if(e.ranges.length>1)return Me;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?Me:e;case xS.Array:return 1!==e.rows&&1!==e.cols?Me:e}}(i);if(Ud(l))return l;var f=zS(e.dereferenceAllOpers([l])[0]),d=rE(f,1===f.rows),h=-1;return(h=o.cond(s)>0?XS(e,n,d):0===o.cond(s)?YS(e,n,d,qe.Eq):YS(e,n,d,qe.Lt))<0||h>=d.length?Me:e.mathpack.fromNumber(h+1)}function $S(e,t,r){var n=t,i=n[0],a=n[1],o=n[2],u=n[3],c=function(e){if("number"==typeof e)return Me;switch(e.kind){case xS.Range:return jS(e.sheets)?e.ranges.length>1?Me:e:VS;case xS.Array:return e}}(a);if(Ud(c))return c;var s=function(e,t){if(e.kind===xS.Range){var r=e.ranges[0],n=HS(r.row,r.col,t?1:r.rows,t?r.cols:1);return PS(e.sheets,[n])}return e}(c,r),l=rE(zS(e.dereferenceAllOpers([s])[0]),r),f=!(null==u||u)?YS(e,i,l,qe.Eq):XS(e,i,l);if(f<0||f>=l.length)return Me;var d=function(e,t){if("number"==typeof t)return t;switch(t.kind){case xS.Range:if(!jS(t.sheets))return VS;if(t.ranges.length>1)return WS;var r=t.ranges;return e.calcingArray?tv(jt(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?tv(jt(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case xS.Array:return tv(jt(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,o);if(Ud(d))return d;var h=e.dereferenceAllOpers([d])[0],v=QS(e,h);if(Ud(v))return v;var p=e.mathpack.sfix(v)-1,m=function(e,t){switch(t.kind){case xS.Range:var r=t.sheets,n=t.ranges[0];return new Xf(n.rows,n.cols,(function(t,i){var a=ar(n.row+t,n.col+i);return e.dereferenceAllOpers([PS(r,[a])])[0].arrays[0].get(0,0)}));case xS.Array:return new qf(t.rows,t.cols,t.opers)}}(e,c);return p<0?VS:p>=(r?m.rows:m.cols)?WS:r?m.get(p,f):m.get(f,p)}function eE(e,t){return $S(e,t,!0)}function tE(e,t){return $S(e,t,!1)}function rE(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}var nE={};nE[ca.WorksheetFuncId.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return am(e,r)},nE[ca.WorksheetFuncId.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return sm(e,r)},nE[ca.WorksheetFuncId.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return fm(e,r)},nE[ca.WorksheetFuncId.COUNTBLANK]=function(e,t){var r=t[0];if(!Vd(r)||!Ct(r.sheets)||1!==r.ranges.length)return Le;var n=e.dereferenceAllOpers(t);return ym(e,n)},nE[ca.WorksheetFuncId.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return Nm(e,r)},nE[ca.WorksheetFuncId.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return Fm(e,r)},nE[ca.WorksheetFuncId.ISERROR]=function(e,t){return la.operKind(t[0])===ia.OperKind.Error},nE[ca.WorksheetFuncId.ISERR]=function(e,t){var r=t[0];return Ud(r)&&r.type!==ia.ErrorType.NA},nE[ca.WorksheetFuncId.ISBLANK]=function(e,t){return la.operKind(t[0])===ia.OperKind.Blank},nE[ca.WorksheetFuncId.ISLOGICAL]=function(e,t){return la.operKind(t[0])===ia.OperKind.Boolean},nE[ca.WorksheetFuncId.ISNA]=function(e,t){var r=t[0];return Ud(r)&&r.type===ia.ErrorType.NA},nE[ca.WorksheetFuncId.ISNONTEXT]=function(e,t){return la.operKind(t[0])!==ia.OperKind.String},nE[ca.WorksheetFuncId.ISTEXT]=function(e,t){return la.operKind(t[0])===ia.OperKind.String},nE[ca.WorksheetFuncId.ISNUMBER]=function(e,t){return la.operKind(t[0])===ia.OperKind.Number},nE[ca.WorksheetFuncId.ISREF]=function(e,t){return la.operKind(t[0])===ia.OperKind.Range},nE[ca.WorksheetFuncId.ISEVEN]=NC,nE[ca.WorksheetFuncId.ISODD]=function(e,t){var r=NC(e,t);return"boolean"==typeof r?!r:r};var iE,aE,oE=!1;function uE(e){return oE||(oE=!0,bn(yn.CalcNewFunctions)&&(nE[ca.WorksheetFuncId.AND]=Vm,nE[ca.WorksheetFuncId.COUNTA]=Om,nE[ca.WorksheetFuncId.OR]=Wm,nE[ca.WorksheetFuncId.CONCAT]=mm,nE[ca.WorksheetFuncId.IF]=CS,nE[ca.WorksheetFuncId.ABS]=EC,nE[ca.WorksheetFuncId.CEILING]=lC,nE[ca.WorksheetFuncId.ECMA_CEILING]=lC,nE[ca.WorksheetFuncId.DEGREES]=RC,nE[ca.WorksheetFuncId.FLOOR]=hC,nE[ca.WorksheetFuncId.RADIANS]=OC,nE[ca.WorksheetFuncId.ROUND]=nC,nE[ca.WorksheetFuncId.ROUNDUP]=aC,nE[ca.WorksheetFuncId.ROUNDDOWN]=oC,nE[ca.WorksheetFuncId.EVEN]=CC,nE[ca.WorksheetFuncId.SIGN]=yC,nE[ca.WorksheetFuncId.PI]=Bg,nE[ca.WorksheetFuncId.SQRT]=Hg,nE[ca.WorksheetFuncId.EXP]=jg,nE[ca.WorksheetFuncId.POWER]=Kg,nE[ca.WorksheetFuncId.LN]=qg,nE[ca.WorksheetFuncId.LOG10]=Jg,nE[ca.WorksheetFuncId.LOG]=Xg,nE[ca.WorksheetFuncId.SIN]=Yg,nE[ca.WorksheetFuncId.COS]=Qg,nE[ca.WorksheetFuncId.TAN]=zg,nE[ca.WorksheetFuncId.ASIN]=Zg,nE[ca.WorksheetFuncId.ACOS]=$g,nE[ca.WorksheetFuncId.ATAN]=eC,nE[ca.WorksheetFuncId.ATAN2]=tC,nE[ca.WorksheetFuncId.FACT]=TC,nE[ca.WorksheetFuncId.LEFT]=WC,nE[ca.WorksheetFuncId.RIGHT]=VC,nE[ca.WorksheetFuncId.MID]=BC,nE[ca.WorksheetFuncId.LEN]=HC,nE[ca.WorksheetFuncId.CONCATENATE]=jC),bn(yn.CalcWorksheetFunctions)&&(bn(yn["OfficeVSO:3852168_CalcCGAVERAGEIF"])&&(nE[ca.WorksheetFuncId.AVERAGEIF]=hm),bn(yn["OfficeVSO:3852168_CalcCGCOUNT"])&&(nE[ca.WorksheetFuncId.COUNT]=Em),bn(yn["OfficeVSO:3852168_CalcCGCOUNTIF"])&&(nE[ca.WorksheetFuncId.COUNTIF]=Tm),bn(yn["OfficeVSO:3852168_CalcCGMEDIAN"])&&(nE[ca.WorksheetFuncId.MEDIAN]=og),bn(yn["OfficeVSO:3852168_CalcCGSUMIF"])&&(nE[ca.WorksheetFuncId.SUMIF]=cm),bn(yn["OfficeVSO:3852168_CalcCGROWS"])&&(nE[ca.WorksheetFuncId.ROWS]=uS),bn(yn["OfficeVSO:3852168_CalcCGCOLUMNS"])&&(nE[ca.WorksheetFuncId.COLUMNS]=cS),bn(yn["OfficeVSO:3852168_CalcCGINDEX"])&&(nE[ca.WorksheetFuncId.INDEX]=KS),bn(yn["OfficeVSO:3852168_CalcCGMATCH"])&&(nE[ca.WorksheetFuncId.MATCH]=ZS),bn(yn["OfficeVSO:3852168_CalcCGHLOOKUP"])&&(nE[ca.WorksheetFuncId.HLOOKUP]=eE),bn(yn["OfficeVSO:3852168_CalcCGVLOOKUP"])&&(nE[ca.WorksheetFuncId.VLOOKUP]=tE),bn(yn["OfficeVSO:3852168_CalcCGLARGE"])&&(nE[ca.WorksheetFuncId.LARGE]=Jm),bn(yn["OfficeVSO:3852168_CalcCGSMALL"])&&(nE[ca.WorksheetFuncId.SMALL]=Xm),bn(yn["OfficeVSO:3852168_CalcCGPERCENTILE"])&&(nE[ca.WorksheetFuncId.PERCENTILE]=zm,nE[ca.WorksheetFuncId.PERCENTILE_INC]=zm),bn(yn["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"])&&(nE[ca.WorksheetFuncId.PERCENTILE_EXC]=$m),bn(yn["OfficeVSO:3852168_CalcCGQUARTILE"])&&(nE[ca.WorksheetFuncId.QUARTILE]=rg,nE[ca.WorksheetFuncId.QUARTILE_INC]=rg),bn(yn["OfficeVSO:3852168_CalcCGQUARTILE_EXC"])&&(nE[ca.WorksheetFuncId.QUARTILE_EXC]=ig),bn(yn["OfficeVSO:3852168_CalcCGTRIMMEAN"])&&(nE[ca.WorksheetFuncId.TRIMMEAN]=ug),bn(yn["OfficeVSO:3852168_CalcCGTRUE"])&&(nE[ca.WorksheetFuncId.TRUE]=ES),bn(yn["OfficeVSO:3852168_CalcCGFALSE"])&&(nE[ca.WorksheetFuncId.FALSE]=yS),bn(yn["OfficeVSO:3852168_CalcCGNOT"])&&(nE[ca.WorksheetFuncId.NOT]=RS),bn(yn["OfficeVSO:3852168_CalcCGNA"])&&(nE[ca.WorksheetFuncId.NA]=IS),bn(yn["OfficeVSO:3852168_CalcCGAVERAGEA"])&&(nE[ca.WorksheetFuncId.AVERAGEA]=vm),bn(yn["OfficeVSO:3852168_CalcCGMAXA"])&&(nE[ca.WorksheetFuncId.MAXA]=_m),bn(yn["OfficeVSO:3852168_CalcCGMINA"])&&(nE[ca.WorksheetFuncId.MINA]=Dm),bn(yn["OfficeVSO:3852168_CalcCGXOR"])&&(nE[ca.WorksheetFuncId.XOR]=Bm),bn(yn["OfficeVSO:3852168_CalcCGT"])&&(nE[ca.WorksheetFuncId.T]=kS),bn(yn["OfficeVSO:3852168_CalcCGN"])&&(nE[ca.WorksheetFuncId.N]=AS),bn(yn["OfficeVSO:3852168_CalcCGHYPERLINK"])&&(nE[ca.WorksheetFuncId.HYPERLINK]=OS),bn(yn["OfficeVSO:3852168_CalcCGAGGREGATE"])&&(nE[ca.WorksheetFuncId.AGGREGATE]=Vg),bn(yn["OfficeVSO:3852168_CalcCGSUBTOTAL"])&&(nE[ca.WorksheetFuncId.SUBTOTAL]=Gg),bn(yn["OfficeVSO:3852168_CalcCGVAR"])&&(nE[ca.WorksheetFuncId.VAR]=Ag,nE[ca.WorksheetFuncId.VAR_S]=Ag),bn(yn["OfficeVSO:3852168_CalcCGVARP"])&&(nE[ca.WorksheetFuncId.VARP]=bg,nE[ca.WorksheetFuncId.VAR_P]=bg),bn(yn["OfficeVSO:3852168_CalcCGSTDEV"])&&(nE[ca.WorksheetFuncId.STDEV]=Og,nE[ca.WorksheetFuncId.STDEV_S]=Og),bn(yn["OfficeVSO:3852168_CalcCGSTDEVP"])&&(nE[ca.WorksheetFuncId.STDEVP]=Ig,nE[ca.WorksheetFuncId.STDEV_P]=Ig),bn(yn["OfficeVSO:3852168_CalcCGVARA"])&&(nE[ca.WorksheetFuncId.VARA]=Ng),bn(yn["OfficeVSO:3852168_CalcCGVARPA"])&&(nE[ca.WorksheetFuncId.VARPA]=Fg),bn(yn["OfficeVSO:3852168_CalcCGSTDEVA"])&&(nE[ca.WorksheetFuncId.STDEVA]=Tg),bn(yn["OfficeVSO:3852168_CalcCGSTDEVPA"])&&(nE[ca.WorksheetFuncId.STDEVPA]=kg),bn(yn["OfficeVSO:3852168_CalcCGMODE"])&&(nE[ca.WorksheetFuncId.MODE]=Dg,nE[ca.WorksheetFuncId.MODE_SNGL]=Dg),bn(yn["OfficeVSO:3852168_CalcCGMODE_MULT"])&&(nE[ca.WorksheetFuncId.MODE_MULT]=Mg),bn(yn["OfficeVSO:3852168_CalcCGTYPE"])&&(nE[ca.WorksheetFuncId.TYPE]=bS),bn(yn["OfficeVSO:3852168_CalcCGERROR_TYPE"])&&(nE[ca.WorksheetFuncId.ERROR_TYPE]=NS),bn(yn["OfficeVSO:3852168_CalcCGAREAS"])&&(nE[ca.WorksheetFuncId.AREAS]=oS),bn(yn["OfficeVSO:3852168_CalcCGSHEETS"])&&(nE[ca.WorksheetFuncId.SHEETS]=dS),bn(yn["OfficeVSO:3852168_CalcCGROW"])&&(nE[ca.WorksheetFuncId.ROW]=lS),bn(yn["OfficeVSO:3852168_CalcCGCOLUMN"])&&(nE[ca.WorksheetFuncId.COLUMN]=fS),bn(yn["OfficeVSO:3852168_CalcCGSHEET"])&&(nE[ca.WorksheetFuncId.SHEET]=hS),bn(yn["OfficeVSO:3852168_CalcCGOFFSET"])&&(nE[ca.WorksheetFuncId.OFFSET]=vS),bn(yn["OfficeVSO:3852168_CalcCGEXACT"])&&(nE[ca.WorksheetFuncId.EXACT]=KC),bn(yn["OfficeVSO:3852168_CalcCGREPT"])&&(nE[ca.WorksheetFuncId.REPT]=qC),bn(yn["OfficeVSO:3852168_CalcCGTRIM"])&&(nE[ca.WorksheetFuncId.TRIM]=JC),bn(yn["OfficeVSO:3852168_CalcCGCLEAN"])&&(nE[ca.WorksheetFuncId.CLEAN]=XC),bn(yn["OfficeVSO:3852168_CalcCGCHAR"])&&(nE[ca.WorksheetFuncId.CHAR]=YC),bn(yn["OfficeVSO:3852168_CalcCGUNICHAR"])&&(nE[ca.WorksheetFuncId.UNICHAR]=QC),bn(yn["OfficeVSO:3852168_CalcCGCODE"])&&(nE[ca.WorksheetFuncId.CODE]=zC),bn(yn["OfficeVSO:3852168_CalcCGUNICODE"])&&(nE[ca.WorksheetFuncId.UNICODE]=ZC),bn(yn["OfficeVSO:3852168_CalcCGLOWER"])&&(nE[ca.WorksheetFuncId.LOWER]=tS),bn(yn["OfficeVSO:3852168_CalcCGUPPER"])&&(nE[ca.WorksheetFuncId.UPPER]=rS),bn(yn["OfficeVSO:3852168_CalcCGPROPER"])&&(nE[ca.WorksheetFuncId.PROPER]=nS),bn(yn["OfficeVSO:3852168_CalcCGISFORMULA"])&&(nE[ca.WorksheetFuncId.ISFORMULA]=LC),bn(yn["OfficeVSO:3852168_CalcCGFORMULATEXT"])&&(nE[ca.WorksheetFuncId.FORMULATEXT]=wC),bn(yn["OfficeVSO:3852168_CalcCGINFO"])&&(nE[ca.WorksheetFuncId.INFO]=FS),bn(yn["OfficeVSO:3852168_CalcCGDELTA"])&&(nE[ca.WorksheetFuncId.DELTA]=wS),bn(yn["OfficeVSO:3852168_CalcCGGESTEP"])&&(nE[ca.WorksheetFuncId.GESTEP]=_S),bn(yn["OfficeVSO:3852168_CalcCGTRANSPOSE"])&&(nE[ca.WorksheetFuncId.TRANSPOSE]=pS),bn(yn["OfficeVSO:3852168_CalcCGADDRESS"])&&(nE[ca.WorksheetFuncId.ADDRESS]=mS),bn(yn["OfficeVSO:3852168_CalcCGINDIRECT"])&&(nE[ca.WorksheetFuncId.INDIRECT]=gS),bn(yn["OfficeVSO:3852168_CalcCGTEXTJOIN"])&&(nE[ca.WorksheetFuncId.TEXTJOIN]=gm),bn(yn["OfficeVSO:3852168_CalcCGCHOOSE"])&&(nE[ca.WorksheetFuncId.CHOOSE]=SS),bn(yn["OfficeVSO:3852168_CalcCGSQRTPI"])&&(nE[ca.WorksheetFuncId.SQRTPI]=AC),bn(yn["OfficeVSO:3852168_CalcCGFACTDOUBLE"])&&(nE[ca.WorksheetFuncId.FACTDOUBLE]=kC),bn(yn["OfficeVSO:3852168_CalcCGINT"])&&(nE[ca.WorksheetFuncId.INT]=rC),bn(yn["OfficeVSO:3852168_CalcCGTRUNC"])&&(nE[ca.WorksheetFuncId.TRUNC]=iC,nE[ca.WorksheetFuncId.ROUNDDOWN]=oC),bn(yn["OfficeVSO:3852168_CalcCGODD"])&&(nE[ca.WorksheetFuncId.ODD]=SC),bn(yn["OfficeVSO:3852168_CalcCGMROUND"])&&(nE[ca.WorksheetFuncId.MROUND]=uC),bn(yn["OfficeVSO:3852168_CalcCGQUOTIENT"])&&(nE[ca.WorksheetFuncId.QUOTIENT]=IC),bn(yn["OfficeVSO:3852168_CalcCGFLOOR.MATH"])&&(nE[ca.WorksheetFuncId.FLOOR_MATH]=vC),bn(yn["OfficeVSO:3852168_CalcCGFLOOR.PRECISE"])&&(nE[ca.WorksheetFuncId.FLOOR_PRECISE]=pC),bn(yn["OfficeVSO:3852168_CalcCGCEILING.MATH"])&&(nE[ca.WorksheetFuncId.CEILING_MATH]=fC),bn(yn["OfficeVSO:3852168_CalcCGCEILING.PRECISE"])&&(nE[ca.WorksheetFuncId.CEILING_PRECISE]=dC,nE[ca.WorksheetFuncId.ISO_CEILING]=dC)),bn(yn.CalcFieldValueFunction)&&(nE[ca.WorksheetFuncId.FIELDVALUE]=iS,nE[ca.WorksheetFuncId._FV]=iS),bn(yn.CalcRecordFunctions)&&(nE[ca.WorksheetFuncId.RECORD]=aS),bn(yn.CalcFunFunctions)&&(nE[ca.WorksheetFuncId.ARITY]=GS,nE[ca.WorksheetFuncId.APPLY]=MS,nE[ca.WorksheetFuncId.ARRAYMAKE]=US,nE[ca.WorksheetFuncId.ISFUN]=bC)),nE[e]}(aE=iE||(iE={})).DerefOperKind=uh,aE.machine=o;var cE={},sE=0;function lE(e){var t=cE[e];cE[e]=(void 0===t?0:t)+1,(sE+=1)%100==0&&(O.ULS.traceTag(595858520,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.common.hashUtils.logCollision: "+JSON.stringify(cE)+"."),cE={})}function fE(e){if(null==e)return"";var t,r=Xt(e.sheet.document);r===$t?t="illegalDocument":t=(null==r.path?"":"p:"+r.path.toLocaleUpperCase()+",")+"n:"+r.name.toLocaleUpperCase();return t+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}var dE=function(e){var t=e^e>>16;return t*=2246822507,t^=t>>13,t*=3266489909,t^=t>>16};function hE(e){var t,r=1;return r=31*(r=31*(r=31*(r=31*r+("number"==typeof(t=e.sheet.index)?dE(t):t.charCodeAt(0)))+dE(e.range.col))+dE(e.range.row))+dE(e.sheet.document.name.length),void 0!==e.sheet.document.path&&(r=31*r+dE(e.sheet.document.path.length)),r}function vE(e,t){return At(e,t)}function pE(){return{map:{},keyToHash:hE,keyEquals:vE,nelements:0,add:function(e){var t=this.keyToHash(e);if(Sr(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var r=this.map[t],n=0;n<r.length;n+=1)if(this.keyEquals(e,r[n]))return;lE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),r.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),r=this.map[t];if(Sr(r))return!1;for(var n=0;n<r.length;n+=1)if(this.keyEquals(e,r[n]))return!0;return lE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(r){t.map[+r].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,r=this.keyToHash(e),n=this.map[r];if(Sr(n))return!1;var i=[],a=!1;return n.forEach((function(r){t.keyEquals(e,r)?(t.nelements-=1,a=!0):i.push(r)})),this.map[r]=i,a||lE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),a}}}var mE=function(){function e(e){this.valueCreationFunc=e}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}(),gE=la.createResolutionHandler,CE=la.createNameFinder,SE={};function EE(e){bn(yn.CalcLogStopWatch)&&(SE[e]=On(e))}function yE(e){if(bn(yn.CalcLogStopWatch)){var t=SE[e];void 0!==t&&t.stop()}}function RE(e,t){switch(t.ref.kind){case M.Error:e.errRefs+=1}}function OE(e,t,r,n){return gE((function(i){var a,o;Ct(i.sheet)||(n.crossSheetRefs+=1),a=e.sheet.document,o=i.sheet.document,void 0===a&&void 0===o||void 0!==a&&void 0!==o&&It(a,o)||(n.crossDocRefs+=1),i.sheet.index!==e.sheet.index&&(n.crossSheetRefs+=1),i.range.rows===1<<20&&(n.columnRefs+=1),16384===i.range.cols&&(n.rowRefs+=1),yt(i)&&r.addDependency(i,e,t.maxRangeSize,n)}),(function(e){return RE(n,e)}),(function(e,t){e.kind===Ht.NotImplemented?RE(n,t):n.errRefs+=1}))}function IE(e,t){var r=t[e];return void 0===r&&(r=0),r}function TE(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:gr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(t){e.columnRefs+=t.columnRefs,e.crossDocRefs+=t.crossDocRefs,e.crossSheetRefs+=t.crossSheetRefs,e.largeRanges+=t.largeRanges,e.nameRefs+=t.nameRefs,e.parserErrors+=t.parserErrors,e.rowRefs+=t.rowRefs,e.tableRefs+=t.tableRefs,e.errRefs+=t.errRefs,function(e,t){EE("calc_ts_merge_sets");var r=pE();e.forEach((function(e){r.add(e)})),t.forEach((function(t){r.contains(t)||e.push(t)})),yE("calc_ts_merge_sets")}(e.dependents,t.dependents),Object.keys(t.functionsCount).forEach((function(r){var n=e.functionsCount[r];void 0===n&&(n=0),e.functionsCount[r]=n+t.functionsCount[r]})),Object.keys(t.operatorsCount).forEach((function(r){var n=Number(r),i=e.operatorsCount[n];void 0===i&&(i=0),e.operatorsCount[n]=i+t.operatorsCount[n]}))}};return e}function kE(e){var t={_logger:e,_dependencyGraph:gr(),haveDependents:function(e){return void 0!==t._dependencyGraph[fE(e)]},directDependents:function(e){var r=[],n=t._dependencyGraph[fE(e)];return void 0!==n&&n.forEach((function(e){r.push(e)})),r},allDependents:function(e){return t.getDependents(e,!1)},rootDependents:function(e){return t.getDependents(e,!0)},reset:function(){t._dependencyGraph=gr()},add:function(e,r,n){var i=V({},e);i.getCurrentDocumentLoc=function(){return Xt(e.getCurrentDocumentLoc())};var a=TE();if(null==n)return a;var o,u,c,s=function(e,t,r,n){var i=CE((function(i){var a=t.nameRefToSheetGridRange(e,i);return null==a||r.addDependency(a,e,t.maxRangeSize,n),a})),a=gE(mr,mr,(function(){}));return function(e,t){return a(e,i(t))}}(r,i,t,a),l=OE(r,i,t,a),f={originGridCell:vt(r.range),originSheet:vt(r.sheet),wrapCellReferences:!1},d=[];for(d.push(n.node);d.length>0;){var h=d.pop();if(null!=h)switch(h.kind){case x.Literal:break;case x.Array:h.nodes.map((function(e){return e.map((function(e){d.push(e)}))}));break;case x.App:if("object"==typeof h.head){var v=h.head;switch(v.kind){case x.Operator:a.operatorsCount[v.id]=(o=v.id,u=a.operatorsCount,c=void 0,void 0===(c=u[o])&&(c=0),c+1);break;case x.Name:a.functionsCount[v.whole]=IE(v.whole,a.functionsCount)+1;break;default:d.push(v)}}h.args.map((function(e){d.push(e)}));break;case x.Paren:d.push(h.node);break;case x.Name:a.nameRefs+=1,s(void 0,i.resolver.resolveName(f,h.qualifier,h.whole));break;case x.CellRef:l(h,i.resolver.resolveCellRef(f,h.qualifier,h.ref));break;case x.Bad:a.parserErrors+=1;break;default:return T("calc.calc.recalcMapperImpl",h)}}return a},merge:function(e){t.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=kE(t._logger);return e.mergeGraph(t._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){EE("calc_ts_merge_graph");var r=function(r){var n=t._dependencyGraph[r],i=e[r];void 0===n&&(n=[]);var a=n,o=pE();a.forEach((function(e){o.add(e)})),i.forEach((function(e){o.contains(e)||a.push(e)})),t._dependencyGraph[r]=a};for(var n in e)r(n);yE("calc_ts_merge_graph")},addDependency:function(e,r,n,i){if(Rt(e)){var a=fE(e);t.updateDependency(a,r)&&i.dependents.push(e)}else if(Xd(e.range)>n)i.largeRanges+=1;else for(var o=e.range.row;o<e.range.row+e.range.rows;o+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var c=sr(e.sheet,ar(o,u));t.addDependency(c,r,n,i)}},updateDependency:function(e,r){var n=t._dependencyGraph[e];return void 0===n&&(n=[]),!n.some((function(e){return At(e,r)}))&&(n.push(r),t._dependencyGraph[e]=n,!0)},getDependents:function(e,r){EE("calc_ts_get_dependents");for(var n=pE(),i=[],a=t.directDependents(e);a.length>0;){var o=a.shift();if(void 0!==o&&!n.contains(o)){n.add(o);var u=t.directDependents(o);u.length>0&&u.forEach((function(e){a.push(e)})),r&&0!==u.length||i.push(o)}}return i},stats:function(){var e=Object.keys(t._dependencyGraph);if(void 0===e||0===e.length)return AE(0,0);var r=e.length,n=0;return e.forEach((function(e){var r=t._dependencyGraph[e];n+=r.length})),AE(r,n)}};return t}function AE(e,t){return{nodes:e,arcs:t}}var bE=la.createResolver,NE=la.success;function FE(e){return I(e),kE(e)}function LE(e,t,r,n,i,a,o,u,c,s){return{maxRangeSize:e,nameRefs:t,rowRefs:r,columnRefs:n,crossSheetRefs:i,crossDocRefs:a,getCurrentDocumentLoc:o,getCurrentSheetIndex:u,getSheetIndex:c,nameRefToSheetGridRange:s,resolver:bE({getSheetIndex:function(e,t){return NE(c(e,t))},getDocumentLoc:o})}}var wE=ra.LexicalKind,_E=ra.gridCell,DE=ra.documentLoc,ME=oa.RefStyle,UE=la.ResultKind,GE=la.failure;function xE(e,t){return{}}function PE(e,t,r){return{config:e,mathpack:t,formatInfo:r}}function VE(e){var t={globals:e,runtime:function(e){var t=e.config,r={config:t},n=V({config:t},e.formatInfo),i={config:t},a=ms(r),o=Kf(n),u=Zh(i);return{parser:a,analyzer:o,compiler:u}}(e),cache:gr(),lazyCreateCacheItem:function(e){var r,n=fE(e),i=t.cache[n];return void 0===i&&(i={cell:e,rawValue:r,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},t.cache[n]=i),i},size:function(){var e=0;for(var r in t.cache)e+=1;return e},clear:function(){t.cache=gr()},cells:function(){var e=Object.keys(t.cache);return void 0===e||0===e.length?[]:e.map((function(e){return t.cache[e].cell}))},getItem:function(e){var r=fE(e);return t.cache[r]},getValue:function(e){var r=t.getItem(e);if(void 0!==r&&null!==r.rawValue)return r.rawValue},getFormula:function(e,r,n){var i=t.getItem(e);if(void 0!==i&&WE(t.runtime,i,r,n)&&BE(i.formula))return i.formula},getFormulaFormat:function(e){var r=t.getItem(e);if(void 0!==r)return r.format},getCompiledFormula:function(e,r){var n=t.getItem(e);if(void 0!==n&&function(e,t,r){if(BE(t.compiledFormula))return!0;if(!WE(e,t,r))return!1;if(void 0!==r&&r)return!1;t.compiledFormula=null;try{var n=e.compiler.compileFormula(cd(wE.Cell,t.cell.range),t.formula);return n.kind===UE.Success&&(t.compiledFormula=n.value,!0)}catch(e){return O.ULS.traceTag(595968586,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.calc.formulaCache.lazyCompileFormula: Exception "+S(e)),!1}}(t.runtime,n,r)&&BE(n.compiledFormula))return n.compiledFormula},getEvalResult:function(e){var r=t.getItem(e);if(void 0!==r)return r.evalResult},isEqualValue:function(e,r){var n=t.getItem(e);return void 0!==n&&n.rawValue===r},updateCellValue:function(e,r,n,i,a){if(!t.isEqualValue(e,r)){var o=t.lazyCreateCacheItem(e);if(o.rawValue=r,o.formula=void 0,o.compiledFormula=void 0,o.evalResult=void 0,o.format=void 0,null!=n){var u=n.getValue(e);void 0!==u&&r===u&&(o.formula=n.getFormula(e,!0),o.compiledFormula=n.getCompiledFormula(e,!0),o.evalResult=void 0,o.format=o.format)}null!=a&&(o.format=a),null!=i&&i.forEach((function(e){var r=t.getItem(e);void 0!==r&&(r.evalResult=void 0)}))}},updateEvalResult:function(e,r,n){var i=t.lazyCreateCacheItem(e);i.evalResult=r,null!=n&&(i.format=n)},merge:function(e,r){e.cells().forEach((function(n){var i=e.getValue(n);void 0===i||!0!==r&&void 0!==t.getItem(n)||t.updateCellValue(n,i,e)}))},parseCompileNameFormula:function(e,r,n){var i=void 0===n?ME.A1:n,a=Zt(hr(fr(DE(void 0,"Doc")),"")),o=void 0!==r?bt(r.range):_E(0,0),u=t.runtime.parser.parseFormula(i,o,a.kind,e),c=S(e);if(u.kind!==UE.Success){var s="calc.formulaCache.parseCompileNameFormula: couldn't parse "+c;return O.ULS.traceTag(595969230,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,s),GE(Aa(s))}var l=t.runtime.analyzer.checkFormula(xs(o),u.value);if(St(l))return t.runtime.compiler.compileFormula(cd(a.kind,o),l);var f="calc.formulaCache.parseCompileNameFormula: formula "+c+" is not well-formed.";return O.ULS.traceTag(595969231,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,f),GE(hd(f))}};return t}function WE(e,t,r,n){if(BE(t.formula))return!0;if(!BE(t.rawValue))return!1;if(void 0!==t.formula&&null===t.formula)return!1;if(void 0!==r&&r)return!1;t.formula=null;var i=t.rawValue;try{var a=e.parser.parseFormula(oa.RefStyle.A1,t.cell,wE.Cell,i);if(a.kind!==UE.Success)return!1;var o=e.analyzer.checkFormula(Gs(wE.Cell,t.cell.range),a.value,n);return!!o.isWellFormed&&(t.formula=o,bn(yn.CalcFormatCalculations)&&(t.format=void 0),!0)}catch(e){return O.ULS.traceTag(595968585,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.calc.formulaCache.lazyParseFormula: Exception "+S(e)),!1}}function BE(e){return null!=e}var HE=function(e,t){return{functionId:e,functionName:t}},jE=function(e,t){return{errorType:e,errorName:t}},KE=function(e,t,r,n,i,a,o,u,c,s,l,f,d,h){var v=[];return t.forEach((function(e,t){"string"==typeof e?v.push(jE(t,e)):Cr(e)&&v.push(e)})),{worksheetFunctionNames:e,errorTypeNames:v,errorNames:[],trueName:r,falseName:n,rowLetter:i,columnLetter:a,leftBrace:o,rightBrace:u,leftBracket:c,rightBracket:s,decimalSeparator:l,listSeparator:f,columnSeparator:d,rowSeparator:h}},qE=function(e,t,r){return{iformat:e,category:t,decimals:r}},JE=function(e,t){return{sheetId:e,sheetName:t}},XE={kind:"Blank"},YE=function(e){return{kind:"Error",type:e}},QE=function(e){return{kind:"Rich",fields:e}};function zE(e){return"object"==typeof e?e.kind:typeof e}var ZE=function(e,t){return{row:e,column:t}},$E=function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}},ey=function(e,t,r,n,i){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:i}},ty=function(e,t,r,n,i){return void 0===i&&(i="Inferred"),{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:i}};function ry(e,t,r,n){return ty(e,t,r,n,"CellFormula")}function ny(e,t,r){return ty(void 0,e,t,r,"ArrayFormula")}function iy(e,t,r,n){return ty(e,t,r,n,"Value")}var ay=function(e,t,r,n,i){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:i}},oy=function(e,t,r,n){return ay(e,t,void 0,r,n)};function uy(e,t,r,n){return ay(e,void 0,t,r,n)}var cy=function(e,t){return{isSpilled:e,formulaBarText:t}},sy=function(e,t,r){return{range:e,data:t,fromStateId:r}};function ly(e,t){return sy(e,t,void 0)}function fy(e,t){return sy(e,void 0,t)}var dy=function(e,t){return{sheetId:e,usedRange:t}},hy=function(e){return{kind:"NamedValue",value:e}},vy=function(e){return{kind:"NamedFormula",formulaBarText:e}},py=function(e){return{kind:"NamedRange",range:e}},my=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},gy=function(e,t){return{name:e,data:t}},Cy=function(e,t,r){return{scope:e,objects:t,fromStateId:r}};function Sy(e,t){return Cy(e,t,void 0)}function Ey(e){return Cy(e,void 0,void 0)}function yy(e,t){return Cy(e,void 0,t)}var Ry=function(e,t,r,n,i,a){return void 0===a&&(a="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:i,kind:a}};function Oy(e,t,r,n){return Ry(e,t,void 0,r,n,"CellFormula")}function Iy(e,t,r,n){return Ry(e,t,r,void 0,n,"Value")}function Ty(e,t,r,n){return Ry(e,t,void 0,r,n,"Inferred")}var ky,Ay,by,Ny,Fy=function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}},Ly=function(e,t,r,n,i){return{isExact:e,iformat:t,hasHyperlink:r,category:n,decimals:i}},wy=function(e,t,r){return{formulaBarText:e,value:t,format:r}},_y=function(e,t){return{range:e,data:t}},Dy=function(e,t){return{range:e,data:t}},My=function(e,t,r){return{range:e,task:t,reason:r}},Uy=function(e,t,r,n,i,a){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:i,rangeFailures:[]}},Gy=function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}},xy=function(e,t,r,n,i,a,o,u){return{totalEvalTimeMs:e,samplePrecisionRate:t,sampleRecalcStatisticsRate:u,sampleWorkbookStatisticsRate:n,rngSeed:r,sampleRecalcEditedStopwatchRate:i,sampleRecalcViewportStopwatchRate:a,sampleCellEvalStopwatchRate:o}};function Py(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function Vy(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]}function Wy(e,t){var r=Vy(),n=r[0],i=r[1],a=i[0],o=i[1],u=setTimeout(t,Math.max(0,e));return[n,[function(e){clearTimeout(u),a(e)},function(e){clearTimeout(u),o(e)}]]}function By(e,t,r){var n=Wy(e,(function(){return s(t())})),i=n[0],a=n[1],o=a[0],u=a[1],c=!1;function s(e){u(e),c=!0}var l=Promise.resolve().then((function(e){return r(s,(function(){return c}))}));return Py(Promise.race([i,l]),o)}function Hy(e,t){var r;return new Promise((function(n,i){Promise.resolve(t).then((function t(a){if(void 0!==a){r=a;try{Promise.resolve(e(r)).then(t,i)}catch(e){i(e)}}else n(r)}),i)}))}function jy(e,t){return{setMessageListeners:function(t){e.onmessage=function(e){return t.onMessage(e.data)},e.onmessageerror=function(e){return t.onMessageError(e.data)}},postMessage:e.postMessage.bind(e),close:t.bind(e)}}function Ky(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(ky||(ky={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(Ay||(Ay={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(by||(by={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(Ny||(Ny={}));var qy,Jy={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function Xy(e){return[e.name,e.message,e.stack]}function Yy(e){var t,r=e[0],n=e[1],i=e[2],a=Jy[r];return null!=a?t=new a(n):(t=new Error(n)).name=r,void 0!==i&&(t.stack=i),t}function Qy(e){return Ky(e)?[qy.Error,Xy(e)]:[qy.Unknown,e]}function zy(e,t,r,n){var i=new Error(e);return i.stack=e+"\n    at "+t+":"+r+":"+n,i}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(qy||(qy={}));function Zy(e){var t=e.message.indexOf("__START_ERROR__"),r=e.message.indexOf("__END_ERROR__");return t>=0&&r>=0?Yy(JSON.parse(e.message.substring(t+"__START_ERROR__".length,r))):null!=e.error?e.error:zy(e.message,e.filename,e.lineno,e.colno)}function $y(e,t,r,n,i,a){var o={port:t,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==o)throw new Error("endpoint is closed");return o}function c(e,t,r){if(null!=o){var n=o.callbacks[e];null!=n&&(delete o.callbacks[e],n[t](r))}}function s(e,t,r,n,i){var a;try{a=u()}catch(e){return Promise.reject(e)}var o=a.lastAppId+1,c=[by.App,o,e,t,r,i],s=Wy(n,(function(){f(c,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),l=s[0],d=s[1];a.callbacks[o]=d,a.lastAppId=o;try{a.port.postMessage(c)}catch(e){f(c,e)}return l}function l(e,t,r,n){var i=u(),a=[by.App,-1,e,t,r,n];try{i.port.postMessage(a)}catch(e){f(a,e)}}function f(e,t){var r=e[1],n=e[5];null!=o&&(r>=0&&c(r,Ny.Rejected,t),n?g(r>=0?Ay.PostCallError:Ay.PostNotifyError,t,!0):(r<0&&g(Ay.PostNotifyError,t,!1),s("","",[],Math.max(C.callTimeout,C.initTimeout),!0).catch((function(e){}))))}function d(e){var t=e[1],r=e[2],n=e[3],i=e[4],a=e[5];if(null!=o)if(""!==r||""!==n){var u=Promise.resolve().then((function(e){if(null!=o){var t=r,a=n,u=o.modules[t],c=null!=u?u[a]:void 0;if(null==c)throw new Error("method "+t+"."+a+" has not been exported");return c.apply(u,i)}}));t>=0?u.then((function(e){return h(t,Ny.Fulfilled,e,a)}),(function(e){return h(t,Ny.Rejected,e,a)})):u.catch((function(e){g(Ay.UnhandledNotifyError,function(e,t,r){var n=t+"."+r+".notify: ";if(Ky(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var i=new Error(n+e);return i.stack=void 0,i}(e,r,n),!1)}))}else h(t,Ny.Fulfilled,void 0,a)}function h(e,t,r,n){if(null!=o){var i=[by.Result,e,t,Qy(r),n];try{o.port.postMessage(i)}catch(e){v(i,e)}}}function v(e,t){var r=e[1],n=e[4];null!=o&&(n?g(Ay.PostResultError,t,!0):h(r,Ny.Rejected,Qy(t),!0))}function p(e){var t=e[1],r=e[2],n=e[3];null!=o&&c(t,r,function(e){return e[0]===qy.Unknown?e[1]:Yy(e[1])}(n))}function m(e){if(void 0===e&&(e=!0),null!=o){var t=o.port,r=o.callbacks;if(o=void 0,e)try{t.postMessage([by.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var i in r)c(Number(i),Ny.Rejected,n);try{t.close()}catch(e){}if(null!=a)try{a(C)}catch(n){var u=null!=n.stack?n.stack:n.message;console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function g(e,t,r){if(null!=o){var n=void 0;try{i(C,{kind:e,closing:r,error:t})||(n=[t])}catch(t){n=[t]}if(r&&m(),null!=n){var a=n[0],u=null!=a.stack?a.stack:a.message;console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+u)}}}var C={workerKind:e,initTimeout:r,callTimeout:n,setExports:function(e,t){return u().modules[e]=t},getImports:function(e,t){var r={};return t.forEach((function(t){return r[t]=function(e,t){var r={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=null!=r.callTimeout?r.callTimeout:C.callTimeout;return s(e,t,n,a,r.isCritical)},notify:function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];l(e,t,n,r.isCritical)}};return r}(e,t)})),r},close:m,dispatchError:g};return o.port.setMessageListeners({onMessage:function(e){switch(e[0]){case by.App:return d(e);case by.Result:return p(e);case by.Close:return m(!1);default:return T("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var t=new Error("failed to send "+e[0]+" message");switch(e[0]){case by.App:return f(e,t);case by.Result:return v(e,t);case by.Close:return;default:return T("calc.worker.createPortEndpoint.onMessageError",e)}}}),C}function eR(e,t,r){var n=this,i=null!=t.initTimeout?t.initTimeout:6e4,a=null!=t.callTimeout?t.callTimeout:3e4;return By(i,(function(){return new Error("exceeded timeout; initTimeout = "+i+"ms")}),(function(o,u){return B(n,void 0,void 0,(function(){function n(e){return function(t,r){return s?null!=e.onError&&(e.onError(t,r),!0):(o(r.error),!0)}}function c(e){return function(t){s&&null!=e.onClosed&&e.onClosed(t)}}var s,l,f;return H(this,(function(o){switch(o.label){case 0:return s=!1,l=$y(e,r.outside,i,a,n(t.outside),c(t.outside)),f=$y(e,r.inside,i,a,n(t.inside),c(t.inside)),u()||null==t.inside.onInit?[3,2]:[4,t.inside.onInit(f)];case 1:o.sent(),o.label=2;case 2:return u()||null==t.outside.onInit?[3,4]:[4,t.outside.onInit(l)];case 3:o.sent(),o.label=4;case 4:return s=!0,[2,l]}}))}))}))}function tR(){return"undefined"!=typeof MessageChannel}var rR=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return k("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var nR,iR;function aR(){if(null==da.getCalcAbsUrl()){return O.ULS.traceTag(595907587,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function oR(e){setTimeout((function(){try{e.terminate()}catch(e){}}),100)}function uR(){var e={};for(var t in yn){var r=yn[t];null!=r&&(e[r]=bn(r))}return e}r(8);var cR=((nR={})[ky.FunctionCall]=function(){return!0},nR[ky.MessageChannel]=tR,nR[ky.Dedicated]=aR,nR);function sR(e){return cR[e]()}var lR=((iR={})[ky.FunctionCall]=function(e){return eR(ky.FunctionCall,e,(t=new rR,r=new rR,t.open(r),{outside:t,inside:r}));var t,r},iR[ky.MessageChannel]=function(e){if(!tR())return k("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var t=function(){var e=new MessageChannel;return{outside:jy(e.port1,e.port1.close.bind(e.port1)),inside:jy(e.port2,e.port2.close.bind(e.port1))}}();try{return eR(ky.MessageChannel,e,t)}catch(e){try{t.outside.close()}catch(e){}throw e}},iR[ky.Dedicated]=function(e){var t=this,r=e.outside,n=e.inside,i=e.initTimeout,a=e.callTimeout,o=n.scriptName;if(null==o)return k("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=da.getCalcAbsUrl();if(!aR()||null==u)return k("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=i?i:6e4,s=null!=a?a:3e4;return By(c,(function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")}),(function(e,n){return In("calc.worker.createDedicatedWorker (total)",(function(){return B(t,void 0,void 0,(function(){function t(t){return B(this,void 0,void 0,(function(){function i(t,n){return o?null!=r.onError&&(r.onError(t,n),!0):(e(n.error),!0)}function a(e){o&&null!=r.onClosed&&r.onClosed(e)}var o,l,f,d,h;return H(this,(function(e){switch(e.label){case 0:o=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),l=new Worker(t),d=jy(l,(function(){return oR(l)})),f=$y(ky.Dedicated,d,c,s,i,a),l.onerror=function(e){var r;e.preventDefault(),r=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+t):Zy(e),f.dispatchError(Ay.UnhandledError,r,!o)},function(e,t){var r={shipAssertTag:function(e,r,n,i){try{t.ULS.shipAssertTag(e,r,n,i)}catch(e){}},assertTag:function(e,r,n,i){try{t.ULS.assertTag(e,r,n,i)}catch(e){}},traceTag:function(e,r,n,i){try{t.ULS.traceTag(e,r,n,i)}catch(e){}},debugTraceTag:function(e,r,n,i){try{t.ULS.debugTraceTag(e,r,n,i)}catch(e){}}};e.setExports("",r)}(f,O),n()?[3,3]:[4,In("calc.worker.createDedicatedWorker (inside)",(function(){var e=f.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:s,calcAbsUrl:u,features:uR()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==r.onInit?[3,5]:[4,r.onInit(f)];case 4:e.sent(),e.label=5;case 5:return o=!0,[2,f];case 6:throw h=e.sent(),null!=f?f.close():null!=l&&oR(l),h;case 7:return[2]}}))}))}var i,a,l,f;return H(this,(function(e){switch(e.label){case 0:n=o+(/\.min\.js$/.test(r=u)?".min.js":".js"),c=r.lastIndexOf("/"),i=r.substring(0,c+1)+n,a="calc.worker.createDedicatedWorker: workerUrl = "+i,O.ULS.traceTag(595907588,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,a),e.label=1;case 1:e.trys.push([1,6,,7]),l=new Blob(['importScripts("'+encodeURI(i)+'");'],{type:"application/javascript"}),f=URL.createObjectURL(l),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,t(f)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(f),[7];case 5:return[3,7];case 6:return e.sent(),O.ULS.traceTag(595881991,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+i+". Attempting with string url instead..."),[2,t(i)];case 7:return[2]}var r,n,c}))}))}))}))},iR);function fR(e,t){return lR[e](t)}function dR(e,t){return B(this,void 0,void 0,(function(){var r,n,i,a,o;return H(this,(function(u){switch(u.label){case 0:r=0,u.label=1;case 1:if(!(r<e.length))return[3,6];if(!sR(n=e[r]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,fR(n,t)];case 3:return[2,u.sent()];case 4:return i=u.sent(),a=null!=i.stack?i.stack:i.message,o="calc.worker.tryCreateWorker: starting "+n+" worker threw "+a,O.ULS.traceTag(595907598,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,o),[3,5];case 5:return r+=1,[3,1];case 6:return[2,void 0]}}))}))}function hR(){setTimeout((function(){try{self.close()}catch(e){}}),100)}function vR(e,t,r,n){var i=t.initTimeout,a=t.callTimeout,o=t.calcAbsUrl,u=t.features;return B(this,void 0,void 0,(function(){var t,c,s,l,f=this;return H(this,(function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,By(i,(function(){return new Error("exceeded timeout; initTimeout = "+i+"ms")}),(function(e,t){return B(f,void 0,void 0,(function(){function c(t,r){return l?null!=n.onError&&(n.onError(t,r),!0):(e(r.error),!0)}function s(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,f,d,h,v,p;return H(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=jy(self,hR),f=$y(ky.Dedicated,d,i,a,c,s),h=function(e){var t=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);return{shipAssertTag:function(e,r,n,i){if(t.shipAssertTag.notify(e,r,n,i),!n)throw new Error("shipAssertTag: "+e+" "+r+" "+i)},assertTag:function(e,r,n,i){if(t.assertTag.notify(e,r,n,i),!n)throw new Error("assertTag: "+e+" "+r+" "+i)},traceTag:function(e,r,n,i){t.traceTag.notify(e,r,n,i)},debugTraceTag:function(e,r,n,i){t.debugTraceTag.notify(e,r,n,i)}}}(f),v=function(e){return!0===u[e]},r.config.initCalc(h,v,o),t()||null==n.onInit?[3,3]:[4,n.onInit(f)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw p=e.sent(),null!=f?f.close():hR(),p;case 5:return[2]}}))}))})).then((function(e){return[Ny.Fulfilled,e]}),(function(e){return[Ny.Rejected,e]}))];case 1:t=d.sent(),c=t[0],s=t[1],l=[by.Result,e,c,Qy(s),!0];try{self.postMessage(l)}catch(e){throw hR(),e}return[2]}}))}))}var pR={onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});O.ULS.traceTag(595908699,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var t=e.getImports("talk",["ping"]);e.setExports("location",ra),e.setExports("talk",{start:function(e,r,n){return B(this,void 0,void 0,(function(){var i,a=this;return H(this,(function(o){switch(o.label){case 0:return i=Date.now(),[4,Hy((function(o){return B(a,void 0,void 0,(function(){return H(this,(function(a){switch(a.label){case 0:return Date.now()>=i+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 1:return a.sent(),t.ping.notify(o,n),[2,o+1]}}))}))}),0)];case 1:return o.sent(),[2]}}))}))},memoryTest:function(e){var t=[],r=0;try{for(;r<e;r+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,t.push(n)}}catch(e){}t=[];var i="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+r+"KB";O.ULS.traceTag(595906820,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,i)},ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestInsideDef.ping: n = "+e;O.ULS.traceTag(595907656,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,r)}return e+1},logMessage:function(e,t){if(t){var r="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;O.ULS.traceTag(595714188,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,r)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"},mR={outside:{onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestOutsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});O.ULS.traceTag(595910859,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Error,n)},onClosed:function(e){O.ULS.traceTag(595908701,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.worker.smokeTestOutsideDef.onClose")},onInit:function(e){e.setExports("talk",{ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestOutsideDef.ping: n = "+e;O.ULS.traceTag(595907657,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,r)}return e+1}})}},inside:pR},gR=!1,CR=void 0;function SR(){null!=CR&&CR.close(),gR=!1}var ER=Promise.resolve();function yR(e,t,r,n){return void 0===n&&(n=0),bn(yn.CalcWebWorkerTest)?(SR(),ER=ER.then((function(i){return function(e,t,r,n){return B(this,void 0,void 0,(function(){var i,a,o,u,c,s,l,f=this;return H(this,(function(h){switch(h.label){case 0:gR=!0,h.label=1;case 1:return h.trys.push([1,8,9,10]),l="calc.worker.runSmokeTest: starting; duration = "+e+"ms, pingInterval = "+t+"ms",O.ULS.traceTag(595908687,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,l),[4,dR([ky.Dedicated,ky.MessageChannel,ky.FunctionCall],mR)];case 2:if(null==(CR=h.sent()))throw new Error("could not create any kind of worker");if(!gR)throw new Error("smoke test canceled during worker creation");return l="calc.worker.runSmokeTest: worker created; outside.workerKind = "+CR.workerKind,O.ULS.traceTag(595907658,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,l),i=CR.getImports("talk",["start","memoryTest","ping","logMessage"]),a=CR.getImports("location",["gridCell"]),[4,i.ping.call(-1,r)];case 3:return o=h.sent(),[4,a.gridCell.call(2,3)];case 4:if(u=h.sent(),0!==o||2!==u.row||3!==u.col)throw new Error("expected 0, 2, 3; got "+o+", "+u.row+", "+u.col);return n>0&&CR.workerKind===ky.Dedicated?[4,i.memoryTest.call(n)]:[3,6];case 5:h.sent(),h.label=6;case 6:return i.start.notify(e,t,r),c=Date.now(),[4,Hy((function(n){return B(f,void 0,void 0,(function(){var a;return H(this,(function(o){switch(o.label){case 0:return Date.now()>=c+e?[2,void 0]:n%1e3!=0?[3,3]:(a=On("calc.worker.runSmokeTest: ping call roundtrip"),[4,i.ping.call(n,!1)]);case 1:return o.sent(),a.stop(),a=On("calc.worker.runSmokeTest: logMessage notify"),[4,i.logMessage.notify("To be, or not to be, that is the question:Whether 'tis nobler in the mind to sufferThe slings and arrows of outrageous fortune,Or to take arms against a sea of troublesAnd by opposing end them. To dieto sleep,No more; and by a sleep to say we endThe heart-ache and the thousand natural shocksThat flesh is heir to: 'tis a consummationDevoutly to be wish'd. To die, to sleep;To sleep, perchance to dreamay, there's the rub:For in that sleep of death what dreams may come,When we have shuffled off this mortal coil,Must give us pausethere's the respectThat makes calamity of so long life.For who would bear the whips and scorns of time,Th'oppressor's wrong, the proud man's contumely,The pangs of dispriz'd love, the law's delay,The insolence of office, and the spurnsThat patient merit of th'unworthy takes,When he himself might his quietus makeWith a bare bodkin? Who would fardels bear,To grunt and sweat under a weary life,But that the dread of something after death,The undiscovere'd country, from whose bournNo traveller returns, puzzles the will,And makes us rather bear those ills we haveThan fly to others that we know not of?Thus conscience does make cowards of us all,And thus the native hue of resolutionIs sicklied o'er with the pale cast of thought,And enterprises of great pitch and momentWith this regard their currents turn awryAnd lose the name of action.",!1)];case 2:o.sent(),a.stop(),o.label=3;case 3:return[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 4:return o.sent(),i.ping.notify(n,r),[2,n+1]}}))}))}),0)];case 7:return h.sent(),l="calc.worker.runSmokeTest: success",O.ULS.traceTag(595906821,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Error,l),[3,10];case 8:return s=h.sent(),gR&&(l="calc.worker.runSmokeTest: failure: "+(null!=s.stack?s.stack:s.message),O.ULS.traceTag(595908702,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Error,l)),[3,10];case 9:return SR(),CR=void 0,[7];case 10:return[2]}}))}))}(e,t,r,n)}))):Promise.resolve()}function RR(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return[Rr(r,i),Or(n,a)]}function OR(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return[Or(r,i),Rr(n,a)]}function IR(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Or(r,i)<Rr(n,a)}function TR(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return r<i&&a>=n?[r,i]:r>=i&&a<n?[a,n]:void 0}function kR(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return r===i&&n===a?0:r>=i&&n<=a?-1:r<=i&&n>=a?1:void 0}var AR,bR=V;function NR(e){var t,r,n,i=V(V({},e),{split:(t=e.split,r=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var i=t(e),a=e===r?0:e.depth;return void 0!==a&&a<n&&(e.split=i,i[0][0].depth=a+1,i[1][0].depth=a+1),i})});return function(e){return FR(i,jR(i,i.top,e))}}function FR(e,t){return t===BR||t===WR?t:{setOperations:e,root:t}}function LR(e,t){return t===BR?e:t===WR||e===BR?t:e===WR?e:FR(e.setOperations,wR(e.setOperations,e.setOperations.top,e.root,t.root))}function wR(e,t,r,n){if(n===BR)return r;if(n===WR)return n;if(r===BR)return n;if(r===WR)return r;if(r.isExact&&n.isExact){var i=function(e,t,r,n){var i=r.key,a=n.key,o=e.compare(i,a);if(void 0!==o)return o<0?n:r;var u=e.union(i,a);if(void 0!==u){var c=e.compare(u,t);return void 0!==c&&0===c?WR:KR(e,t,u,!0)}return}(e,t,r,n);if(void 0!==i)return i}var a=qR(e,t,r),o=qR(e,t,n),u=e.split(t),c=u[0][0],s=u[1][0];return VR(e,c,s,wR(e,c,a.left,o.left),wR(e,s,a.right,o.right))}function _R(e,t){return e===BR?e:t===BR||e===WR?t:t===WR?e:FR(e.setOperations,DR(e.setOperations,e.setOperations.top,e.root,t.root))}function DR(e,t,r,n){if(r===BR)return r;if(n===BR)return n;if(r===WR)return n;if(n===WR)return r;if(r.isExact&&n.isExact){var i=function(e,t,r,n){var i=r.key,a=n.key;if(!e.meets(i,a))return BR;var o=e.compare(i,a);if(void 0!==o)return o<0?r:n;var u=e.intersect(i,a);if(void 0!==u)return KR(e,t,u,!0);return}(e,t,r,n);if(void 0!==i)return i}var a=qR(e,t,r),o=qR(e,t,n),u=e.split(t),c=u[0][0],s=u[1][0];return VR(e,c,s,DR(e,c,a.left,o.left),DR(e,s,a.right,o.right))}function MR(e,t,r,n){if(r===BR||n===BR)return!1;if(r===WR||n===WR)return!0;if(r.isExact&&n.isExact)return e.meets(r.key,n.key);var i=qR(e,t,r),a=qR(e,t,n),o=e.split(t),u=o[0][0],c=o[1][0];return MR(e,u,i.left,a.left)||MR(e,c,i.right,a.right)}function UR(e,t){return e===BR||t===BR?e:t===WR?BR:e===WR?FR(t.setOperations,GR(t.setOperations,t.setOperations.top,e,t.root)):FR(e.setOperations,GR(e.setOperations,e.setOperations.top,e.root,t.root))}function GR(e,t,r,n){if(r===BR)return r;if(n===BR)return r;if(n===WR)return BR;if(r===WR){var i=qR(e,t,n),a=e.split(t),o=a[0][0],u=a[1][0];return VR(e,o,u,GR(e,o,WR,i.left),GR(e,u,WR,i.right))}if(r.isExact&&n.isExact){var c=function(e,t,r,n){var i=r.key,a=n.key;if(!e.meets(i,a))return r;var o=e.except(i,a);if(void 0!==o)return KR(e,t,o,!0);return}(e,t,r,n);if(void 0!==c)return c}var s=qR(e,t,r),l=qR(e,t,n),f=e.split(t),d=f[0][0],h=f[1][0];return VR(e,d,h,GR(e,d,s.left,l.left),GR(e,h,s.right,l.right))}function xR(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function PR(e,t,r,n){if(r===n)return 0;if(r===BR)return-1;if(n===BR)return 1;if(r===WR)return n===WR?0:1;if(n===WR)return-1;if(r.isExact&&n.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,r,n);var i=qR(e,t,r),a=qR(e,t,n),o=e.split(t),u=o[0][0],c=o[1][0],s=PR(e,u,i.left,a.left);if(void 0!==s){var l=PR(e,c,i.right,a.right);if(void 0!==l)return xR(s,l)}}function VR(e,t,r,n,i){return n===BR?i===BR?BR:i===WR?HR(n,i,void 0,!1,e.infimum(r,r),e.supremum(r,r)):HR(n,i,void 0,!1,i.infimum,i.supremum):i===BR?n===WR?HR(n,i,void 0,!1,e.infimum(t,t),e.supremum(t,t)):HR(n,i,void 0,!1,n.infimum,n.supremum):n===WR?i===WR?WR:HR(n,i,void 0,!1,e.combineInfima(e.infimum(t,t),i.infimum),e.combineSuprema(e.supremum(t,t),i.supremum)):i===WR?HR(n,i,void 0,!1,e.combineInfima(n.infimum,e.infimum(r,r)),e.combineSuprema(n.supremum,e.supremum(r,r))):HR(n,i,void 0,!1,e.combineInfima(n.infimum,i.infimum),e.combineSuprema(n.supremum,i.supremum))}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(AR||(AR={}));var WR=AR.Dense,BR=AR.Empty;function HR(e,t,r,n,i,a){return{key:r,left:e,right:t,isExact:n,infimum:i,supremum:a}}function jR(e,t,r){if(!e.meets(t,r))return BR;var n=e.compare(t,r);if(void 0!==n)return n<=0?WR:KR(e,t,r,!0);var i=e.intersect(t,r);return void 0!==i?KR(e,t,i,!0):KR(e,t,r,!1)}function KR(e,t,r,n){return HR(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function qR(e,t,r){if(void 0!==r.left)return r;var n=e.split(t),i=n[0][0],a=n[1][0],o=VR(e,i,a,jR(e,i,r.key),jR(e,a,r.key));if(o===BR||o===WR)throw new Error("incorrect set operations implementation");var u=o;return bR(r,{left:u.left,right:u.right})}function JR(e){return e===BR||e===WR?0:function e(t){if(void 0===t||t===BR||t===WR)return 0;return e(t.left)+e(t.right)+1}(e.root)}function XR(e,t){return e===BR||function(e,t,r){return function t(n,i){if(i===BR)return!0;if(i===WR)return r(n);if(i.isExact)return r(i.key);var a=qR(e,n,i),o=e.split(n),u=o[0][0],c=o[1][0];return t(u,a.left)&&t(c,a.right)}(e.top,t)}(e.setOperations,e.root,t)}function YR(e,t,r){var n=function(e,t,r){var n=Math.pow(t,e),i=1-Math.pow(t/r,e),a=Math.pow(r,e),o=a*n,u=a-n,c=-1/e;return{cdf:1===e?function(e){return(1-n/e)/i}:function(t){return(1-n*Math.pow(t,-e))/i},invCdf:1===e?function(e){return 1/((a-e*u)/o)}:function(e){return Math.pow((a-e*u)/o,c)}}}(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],i=n.cdf(r),a=n.cdf(t+1),o=n.invCdf((i+a)/2),u=Math.min(Math.max(Math.round(o),t+1),r-1);return[[[t,u],n.cdf(u)-n.cdf(t+1)],[[u,r],n.cdf(r)-n.cdf(u)]]}}}function QR(e,t,r,n,i){var a=YR(e,t,r);return{id:i,split:function(e){return a.split(e)},canSplit:function(e){return a.canSplit(e)},meets:IR,intersect:OR,union:function(e,t){return n=t,i=(r=e)[0],a=r[1],o=n[0],u=n[1],Or(i,o)<=Rr(a,u)?RR(e,t):void 0;var r,n,i,a,o,u},except:TR,compare:kR,top:n,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return Rr(e,t)},combineSuprema:function(e,t){return Or(e,t)}}}var zR={},ZR=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t.push([i,e[i].id])}var a=JSON.stringify(t.sort()),o=zR[a];return void 0===o&&(o={box:{},probabilities:{},depth:1},zR[a]=o),o};function $R(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];if(Object.prototype.hasOwnProperty.call(e,i)){t=!1;break}}return t?WR:{isSubspace:!0,bounds:e}}function eO(e){return e.isSubspace?1:e.subspaceCount}var tO=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:eO(e)+eO(t)}};function rO(e,t){if(t===WR)return t;if(t.isSubspace){for(var r=!1,n=0,i=Object.keys(t.bounds);n<i.length;n++){var a=i[n];if(Object.prototype.hasOwnProperty.call(e,a)){r=!0;break}}if(!r)return WR}return{productOperations:e,root:t}}function nO(e){return void 0===e?WR:e}var iO={unzip:function(e){for(var t={},r={},n=0,i=Object.keys(e);n<i.length;n++){var a=i[n];if(Object.prototype.hasOwnProperty.call(e,a)){var o=e[a];if(o===BR)return BR;if(o===WR)continue;t[a]=o.setOperations,r[a]=o.root}}return rO(t,$R(r))},combineProduct:function(e,t,r,n){for(var i={},a=0,o=Object.keys(e);a<o.length;a++){var u=o[a];if(Object.prototype.hasOwnProperty.call(e,u)){var c=n(e[u],e[u].top,nO(t[u]),nO(r[u]));if(c===BR)return c;if(c===WR)continue;i[u]=c}}return i},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},i=0,a=t;i<a.length;i++){var o=a[i];if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];n[o]=u}}return n},fromUntypedProduct:function(e,t,r){for(var n={},i=0,a=r;i<a.length;i++){var o=a[i],u=t[o];n[o]=FR(e[o],void 0!==u?u:WR)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=WR}return t}},aO=iO.unzip.bind(iO);function oO(e,t,r){var n=iO.combineProduct(e,t,r,wR);if(n===BR)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function uO(e,t,r){for(var n=0,i=0,a=Object.keys(e);i<a.length;i++){var o=a[i];if(Object.prototype.hasOwnProperty.call(e,o)){var u=nO(t[o]),c=nO(r[o]),s=e[o];if(void 0===(n=xR(n,PR(s,s.top,u,c))))return}}return n}var cO,sO=(cO={},function(e,t,r){var n;if(t===cO.left&&r===cO.right)return cO.res;cO.left=t,cO.right=r;var i,a=uO(e,t.bounds,r.bounds);if(void 0!==a)return cO.res=a<=0?r:t;for(var o=0,u=Object.keys(e);o<u.length;o++){var c=u[o];if(Object.prototype.hasOwnProperty.call(e,c)&&0!==PR(e[c],e[c].top,nO(t.bounds[c]),nO(r.bounds[c]))){if(void 0!==i)return cO.res=void 0;i=c}}if(void 0!==i){var s=wR(e[i],e[i].top,nO(t.bounds[i]),nO(r.bounds[i]));if(s===BR)return cO.res=BR;if(s===WR){var l=t.bounds,f=i,d=(l[f],W(l,["symbol"==typeof f?f:f+""]));return cO.res=$R(d)}var h=V(V({},t.bounds),((n={})[i]=s,n));return cO.res=$R(h)}return cO.res=void 0});function lO(e,t,r){if(r===BR)return t;if(r===WR)return r;if(t===BR)return r;if(t===WR)return t;if(!t.isSubspace||!r.isSubspace)return tO(t,r,oO(e,t.bounds,r.bounds));var n=sO(e,t,r);return void 0!==n?n:tO(t,r,oO(e,t.bounds,r.bounds))}function fO(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=iO.restrict.apply(iO,j([t.bounds],r));if(t.isSubspace)return $R(i);var a=fO.apply(void 0,j([e,t.left],r));if(a===WR)return WR;var o=fO.apply(void 0,j([e,t.right],r));return lO(e,a,o)}function dO(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===WR||e===BR)return e;var n=iO.restrict.apply(iO,j([e.productOperations],t)),i=fO.apply(void 0,j([n,e.root],t));return i===BR?i:rO(n,i)}function hO(e,t){var r,n,i,a;if(void 0!==t.children)return t.children;for(var o,u,c=t.box,s=t.probabilities,l=0,f=0,d=Object.keys(e);f<d.length;f++){var h=d[f];if(Object.prototype.hasOwnProperty.call(e,h)){var v=s[h],p=e[h];if(void 0===v){o=h,u=p.top;break}if(v>l){var m=nO(c[h]);if(m===BR)throw new Error("the key split can never return empty");var g=p.top;if(m!==WR){if(!m.isExact)throw new Error("the key can always be represented exactly");g=m.key}if(!p.canSplit(g))continue;o=h,l=v,u=g}}}if(void 0===o||void 0===u)throw new Error("there has to be at least one dimension");var C=e[o],S=C.split(u),E=S[0],y=E[0],R=E[1],O=S[1],I=O[0],T=O[1],k=[{box:V(V({},c),(r={},r[o]=jR(C,C.top,y),r)),probabilities:V(V({},s),(n={},n[o]=R,n)),depth:t.depth+1},{box:V(V({},c),(i={},i[o]=jR(C,C.top,I),i)),probabilities:V(V({},s),(a={},a[o]=T,a)),depth:t.depth+1}];return t.depth<10&&(t.children=k),k}var vO=function(e,t,r,n){return function e(t,r,n,i){if(r===BR)return[BR,BR];if(r===WR)return[$R(n),$R(i)];var a=uO(t,r.bounds,n);if(void 0!==a&&a<=0)return[r,BR];var o=iO.combineProduct(t,r.bounds,n,DR);if(o===BR)return[BR,r];var u=iO.combineProduct(t,r.bounds,i,DR);if(r.isSubspace)return[$R(o),u===BR?BR:$R(u)];var c=e(t,r.left,n,i),s=c[0],l=c[1],f=e(t,r.right,n,i),d=f[0],h=f[1];return[lO(t,s,d),lO(t,l,h)]}(e,t,r.box,n.box)};function pO(e,t,r,n,i){var a=hO(e,n),o=a[0],u=a[1],c=vO(e,t,o,u),s=c[0],l=c[1],f=vO(e,r,o,u),d=f[0],h=f[1],v=i(e,s,d,o);return v===WR?WR:lO(e,v,i(e,l,h,u))}function mO(e,t,r,n){if(r===BR)return t;if(t===BR)return r;if(t===WR)return t;if(r===WR)return r;if(t.isSubspace&&r.isSubspace){var i=sO(e,t,r);if(void 0!==i)return i}return pO(e,t,r,n,mO)}function gO(e,t){if(t===BR)return e;if(t===WR)return t;if(e===BR)return t;if(e===WR)return e;var r=V(V({},e.productOperations),t.productOperations),n=mO(r,e.root,t.root,ZR(r));return n===BR?n:rO(r,n)}function CO(e,t,r,n){if(t===BR||r===BR)return BR;if(t===WR)return r;if(r===WR)return t;if(t.isSubspace&&r.isSubspace){var i=iO.combineProduct(e,t.bounds,r.bounds,DR);return i===BR?BR:$R(i)}return pO(e,t,r,n,CO)}function SO(e,t){if(e===BR)return e;if(t===BR)return t;if(e===WR)return t;if(t===WR)return e;var r=V(V({},e.productOperations),t.productOperations),n=CO(r,e.root,t.root,ZR(r));return n===BR?n:rO(r,n)}function EO(e,t,r,n){if(t===BR)return t;if(r===WR)return BR;if(r===BR)return t;if(t===WR)return pO(e,t,r,n,EO);if(t.isSubspace&&r.isSubspace){var i=function(e,t,r){var n,i,a=uO(e,t.bounds,r.bounds);if(0===a||-1===a)return BR;for(var o=0,u=Object.keys(e);o<u.length;o++){var c=u[o];if(Object.prototype.hasOwnProperty.call(e,c)){var s=PR(e[c],e[c].top,nO(t.bounds[c]),nO(r.bounds[c]));if(void 0===s||s>0){if(void 0!==i)return;i=c}}}if(void 0!==i){var l=GR(e[i],e[i].top,nO(t.bounds[i]),nO(r.bounds[i]));if(l===BR)return BR;if(l===WR){var f=t.bounds,d=i;f[d];return $R(W(f,["symbol"==typeof d?d:d+""]))}return $R(V(V({},t.bounds),((n={})[i]=l,n)))}}(e,t,r);if(void 0!==i)return i}return pO(e,t,r,n,EO)}function yO(e,t){if(e===BR)return e;if(t===BR)return e;if(t===WR)return BR;if(e===WR){var r=EO(t.productOperations,WR,t.root,ZR(t.productOperations));return r===BR?r:rO(t.productOperations,r)}var n=V(V({},e.productOperations),t.productOperations),i=EO(n,e.root,t.root,ZR(n));return i===BR?i:rO(n,i)}function RO(e,t){if(e===t)return 0;if(e===BR)return-1;if(t===BR)return 1;if(e===WR)return t===WR?0:1;if(t===WR)return-1;var r=V(V({},e.productOperations),t.productOperations);return function e(t,r,n,i){if(r===n)return 0;if(r===BR)return-1;if(n===BR)return 1;if(r===WR)return n===WR?0:1;if(n===WR)return-1;if(r.isSubspace&&n.isSubspace)return uO(t,r.bounds,n.bounds);var a=hO(t,i),o=a[0],u=a[1],c=vO(t,r,o,u),s=c[0],l=c[1],f=vO(t,n,o,u),d=f[0],h=f[1],v=e(t,s,d,o);return void 0!==v?xR(v,e(t,l,h,u)):void 0}(r,e.root,t.root,ZR(r))}function OO(e,t,r,n){if(t===BR||r===BR)return!1;if(t===WR||r===WR)return!0;if(!function(e,t,r){for(var n=0,i=Object.keys(e);n<i.length;n++){var a=i[n];if(Object.prototype.hasOwnProperty.call(e,a)){var o=nO(t[a]),u=nO(r[a]),c=e[a];if(!MR(c,c.top,o,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var i=hO(e,n),a=i[0],o=i[1],u=vO(e,t,a,o),c=u[0],s=u[1],l=vO(e,r,a,o),f=l[0],d=l[1];return OO(e,c,f,a)||OO(e,s,d,o)}function IO(e,t){if(e===BR||t===BR)return!1;if(e===WR||t===WR)return!0;var r=V(V({},e.productOperations),t.productOperations);return OO(r,e.root,t.root,ZR(r))}var TO,kO=function(e){return yO(WR,e)};function AO(e){return e===BR||e===WR?0:eO(e.root)}!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(TO||(TO={}));var bO=[TO.AvailableSet,TO.AvailableRead+1],NO=[0,1<<20],FO=[0,16384],LO={availability:QR(1,bO[0]+1,bO[1],bO,"Availability operations, alpha = 1"),row:QR(.2,NO[0]+1,NO[1],NO,"Row operations, alpha = 0.2"),col:QR(.35,FO[0]+1,FO[1],FO,"Col operations, alpha = 0.35")},wO={availability:NR(LO.availability),row:NR(LO.row),col:NR(LO.col)};function _O(e){return aO({row:wO.row([e.row,e.row+e.rows]),col:wO.col([e.col,e.col+e.cols])})}function DO(e){if(e!==BR){var t,r,n=e===WR?void 0:e.root.bounds.row,i=e===WR?void 0:e.root.bounds.col,a=void 0===n?LO.row.top:(t=FR(LO.row,n),r=[],xO(t,(function(e){return r.push(e),!0})),r.reduce(RR)),o=a[0],u=a[1],c=void 0===i?LO.col.top:function(e){var t=[];return PO(e,(function(e){return t.push(e),!0})),t.reduce(RR)}(FR(LO.col,i)),s=c[0];return ir(o,s,u-o,c[1]-s)}}var MO=aO({availability:wO.availability([TO.AvailableSet,TO.AvailableSet+1])}),UO=aO({availability:wO.availability([TO.AvailableRead,TO.AvailableRead+1])}),GO=aO({availability:wO.availability([TO.AvailableSet,TO.AvailableRead+1])});function xO(e,t){return e!==WR?XR(e,t):t(LO.row.top)}function PO(e,t){return e!==WR?XR(e,t):t(LO.col.top)}function VO(e,t){return function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=dO.apply(void 0,j([e],r));if(i===BR)return!0;if(i===WR)return t(iO.denseProduct(r));var a=i.productOperations,o=i.root;function u(e){return e.isSubspace?t(iO.fromUntypedProduct(a,e.bounds,r)):u(e.left)&&u(e.right)}return u(o)}(e,(function(e){return xO(e.row,(function(r){var n=r[0],i=r[1];return PO(e.col,(function(e){var r=e[0],a=e[1];return t(ir(n,r,i-n,a-r))}))}))}),"row","col")}function WO(e,t){return VO(e,(function(e){return Ot(e,t)}))}var BO,HO,jO=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var i=n,a=1+(n<<1),o=2+(n<<1);if(a<=r&&this.cmp(this.items[a],t)<0&&(i=a),o<=r&&this.cmp(this.items[o],i===a?this.items[i]:t)<0&&(i=o),n===i)break;this.items[n]=this.items[i],n=i}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++){if(!e(r[t]))return}},e}(),KO=function(){function e(e){this.min=0,this.max=0,this.heap=new jO((function(t,r){var n=t[0],i=t[1],a=r[0],o=r[1],u=e(n,a);return 0!==u?u:i-o}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e}();function qO(e,t){return{sheet:e,set:t}}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell"}(BO||(BO={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(HO||(HO={}));var JO,XO={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function YO(e,t){var r;return V(V({},e),((r={})[t]=(e[t]||0)+1,r))}function QO(e,t){switch(t.message){case JO.ChangedCell:return V(V({},e),{changedCellCount:YO(e.changedCellCount,t.cellKind),calculatedCellCount:YO(e.calculatedCellCount,t.cellKind)});case JO.UnchangedCell:return V(V({},e),{calculatedCellCount:YO(e.calculatedCellCount,t.cellKind)});case JO.ContinueComputation:return V(V({},e),{continueCount:e.continueCount+1});case JO.StateTimedOut:return V(V({},e),{stateTimedOut:!0});case JO.EditFinished:return V(V({},e),{editFinishedCount:e.editFinishedCount+1});case JO.RecalcFinished:return V(V({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return T("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function zO(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor(Math.log2(t))}function ZO(e){switch(typeof e){case"number":return{kind:"n",magnitude:zO(e)};case"string":return{kind:"s"};case"boolean":return{kind:"b"};case"object":switch(e.kind){case te.Error:return{kind:"e",type:(t=e.type,r=di[t],void 0===r?"error.type:"+t:r)};case te.Rich:return{kind:"r"};case te.Array:return{kind:"a"};case te.Blank:return{kind:"z"};default:return T("calc.calc.precisionValue",e)}}var t,r}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(JO||(JO={}));var $O,eI,tI,rI={samples:[],failures:[]};function nI(e,t){return 0===t.length?e:0===e.length?t:e.concat(t)}!function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.ContinueComputation=2]="ContinueComputation",e[e.ComputeCellValue=3]="ComputeCellValue",e[e.MaybeCollectGarbage=4]="MaybeCollectGarbage",e[e.PrecisionContinueComputation=5]="PrecisionContinueComputation",e[e.PrecisionComputeCellValue=6]="PrecisionComputeCellValue",e[e.RunExperiment=7]="RunExperiment",e[e.TestAdvanceState=8]="TestAdvanceState"}($O||($O={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(eI||(eI={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.PrecisionStatistics="PrecisionStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(tI||(tI={}));var iI=function(){function e(){this.queue=new KO((function(e,t){return e.kind-t.kind})),this.kindToId=[0,0,0,0,0,0,0,0,0],this.onInvalidateMessage=function(e){}}return e.prototype.invalidate=function(e){this.kindToId[e]+=1},e.prototype.isMessageValid=function(e){return e.kindId>=this.kindToId[e.kind]},e.prototype.peek=function(){for(;;){var e=this.queue.peek();if(void 0===e||this.isMessageValid(e))return e;this.onInvalidateMessage(e),this.queue.pop()}},e.prototype.pop=function(){for(;;){var e=this.queue.pop();if(void 0===e||this.isMessageValid(e))return e;this.onInvalidateMessage(e)}},e.prototype.enqueue=function(e,t,r){this.queue.enqueue({kind:e,kindId:this.kindToId[e],stateId:t,message:r})},e.prototype.enqueueRunExperimentMessage=function(e){this.queue.enqueue({kind:$O.RunExperiment,kindId:this.kindToId[$O.RunExperiment],message:e})},e.prototype.push=function(e,t,r){this.queue.push({kind:e,kindId:this.kindToId[e],stateId:t,message:r})},e.prototype.pushRunExperimentMessage=function(e){this.queue.push({kind:$O.RunExperiment,kindId:this.kindToId[$O.RunExperiment],message:e})},e.prototype.getCountUpperBound=function(){return this.queue.getCount()},e}();function aI(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var i=e.slice(0,-1);return t<e.length-1&&(i[t]=e[e.length-1]),i}function oI(e,t,r){return{kind:e,key:t,value:r}}function uI(e,t){return oI(1,e,t)}function cI(e,t){return oI(2,e,t)}function sI(e,t){return oI(3,e,t)}var lI=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,i,a){void 0===a&&(a=2);var o=a>1?Math.ceil(a):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:i,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,n){var i=r.keyCompare(n.key,e);if(1===n.kind)return 0===i?n.value:void 0;if(!(void 0===i||i<0))for(var a=0,o=n.value;a<o.length;a++){var u=t(r,o[a]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:Ln(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var i=mI(this.lattice,this.root,t,n,r);return void 0!==i?i===this.root?this:new e(this.lattice,i,this.count):new e(this.lattice,pI(this.lattice,this.root,uI(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==mI(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return fI(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return fI(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return fI(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return fI(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var n=[],i=this.lattice,a=function(e,r){var o=i.keyCompare(e.key,t);if(void 0===o||o<0)return yr(e,1);if(2===e.kind){for(var u=e.value,c=0;c<u.length;c+=1)if(0===i.keyCompare(u[c].key,t)){if((h=aI(u,c)).length<r){var s=cI(e.key,h);return n.push(s),yr(s,3)}return yr(cI(hI(i,h),h),2)}}else for(u=e.value,c=0;c<u.length;c+=1){var l=a(u[c],i.minChildren),f=l[0],d=l[1];if(3===d){var h;if((h=aI(u,c)).length>=r)return yr(sI(hI(i,h),h),2);s=sI(e.key,h);return n.push(s),yr(s,3)}if(2===d)return yr(sI(e.key,aI(u,c,f)),2)}return yr(e,1)},o=2===this.root.kind?1:2,u=a(this.root,o),c=u[0],s=u[1];if(c===this.root)return this;for(var l=3===s?void 0:c,f=0;f<n.length;f+=1)fI(n[f],(function(e,t){return l=pI(r.lattice,l,uI(e,t)),!0}));return new e(this.lattice,l,this.count-1)},e}();function fI(e,t,r,n){var i=void 0!==r?r:function(){return!0},a=void 0!==n?n:function(){return!0};if(null==e)return!0;var o=function(e){if(!i(e.key))return!0;if(2===e.kind)for(var r=e.value,n=0;n<r.length;n+=1){var u=r[n];if(a(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,n=0;n<r.length;n+=1)if(!o(r[n]))return!1;return!0};return o(e)}function dI(e,t){for(var r=function(e,t){for(var r=0,n=1,i=e.keyDistance(t[0].key,t[1].key),a=2;a<t.length;a+=1)for(var o=0;o<a;o+=1){var u=e.keyDistance(t[o].key,t[a].key);u>i&&(r=o,n=a,i=u)}return yr(r,n)}(e,t),n=r[0],i=r[1],a=t[n].key,o=t[i].key,u=[],c=0;c<t.length;c+=1){var s=t[c];u.push([s,e.keyDistance(a,s.key)-e.keyDistance(o,s.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var l=e.minChildren;l<t.length-e.minChildren&&u[l][1]<0;l+=1);var f=[],d=[];for(c=0;c<l;c+=1)f.push(u[c][0]);for(c=l;c<t.length;c+=1)d.push(u[c][0]);return yr(f,d)}function hI(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function vI(e,t,r){var n=dI(e,r),i=n[0],a=n[1];return yr(oI(t,hI(e,i),i),oI(t,hI(e,a),a))}function pI(e,t,r){if(null==t)return cI(r.key,[r]);var n=function t(n){if(2===n.kind){var i=j(n.value,[r]);if(i.length>e.maxChildren){var a=vI(e,n.kind,i),o=a[0],u=a[1];return yr(cI(o.key,o.value),u)}return yr(cI(e.keyJoin(n.key,r.key),i),void 0)}var c=n.value.slice(),s=function(e,t,r){for(var n=0,i=e.keyDistance(t[0].key,r),a=t[0].value.length,o=1;o<t.length;o+=1){var u=t[o],c=e.keyDistance(u.key,r);(c<i||c===i&&u.value.length<a)&&(n=o,i=c,a=u.value.length)}return n}(e,c,r.key),l=t(c[s]),f=l[0],d=l[1];if(c[s]=f,null!=d&&(c.push(d),c.length>e.maxChildren)){var h=vI(e,n.kind,c),v=h[0];u=h[1];return yr(sI(v.key,v.value),u)}return yr(sI(e.keyJoin(n.key,r.key),c),void 0)}(t),i=n[0],a=n[1];return null!=a?sI(e.keyJoin(i.key,a.key),[i,a]):i}function mI(e,t,r,n,i){if(void 0!==t)return function t(n){if(2!==n.kind)for(i=0;i<n.value.length;i+=1){o=n.value[i];if(e.keyMeets(o.key,r))if(void 0!==(u=t(o)))return sI(n.key,aI(n.value,i,u))}else for(var i=0;i<n.value.length;i+=1){var o,u;if(void 0!==(u=a(o=n.value[i])))return cI(n.key,aI(n.value,i,u))}}(t);function a(t){if(0===e.keyCompare(t.key,r))return void 0!==i&&t.value!==i&&n(t.value)?uI(t.key,i):t}}function gI(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols;return Or(r,o)<Rr(r+i,o+c)&&Or(n,u)<Rr(n+a,u+s)}function CI(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,c=r+i,s=o+t.rows,l=n+a,f=u+t.cols;return r===o&&c===s&&n===u&&l===f?0:r<=o&&c>=s&&n<=u&&l>=f?1:r>=o&&c<=s&&n>=u&&l<=f?-1:void 0}function SI(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols;return Ir(r-o+.5*(i-c))+Ir(n-u+.5*(a-s))}function EI(){return lI.create(Kd,gI,CI,SI)}var yI,RI=function(e,t,r,n){return{isExact:e,iformat:t,category:r,decimals:n}},OI=RI(!0,As.General,"General",0),II=function(e,t){return e&&t===As.General},TI={fmla:"",lexicalKind:qt.Cell,origin:ar(0,0),compiledFmla:void 0},kI={fmla:"",lexicalKind:qt.Range,origin:ar(0,0),compiledFmla:void 0},AI=function(e,t){return""===e&&!t};!function(e){e[e.Dirty=0]="Dirty",e[e.Calced=1]="Calced"}(yI||(yI={}));var bI={oper:Ke,clientFailure:void 0,calcState:yI.Calced},NI=function(e,t,r){return Gd(e)&&void 0===t&&r===yI.Calced};function FI(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!kt(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function LI(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===qt.Cell?TI:kI;e=e.setValue(t,n)}return!0})),e}var wI={values:EI(),formats:EI(),formulae:EI()},_I={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,recalcValuesNodeCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0};var DI=ir(0,0,1<<20,16384);var MI,UI=function(){function e(e){this.sheet=e,this.oldAvailabilities={},this.availabilityHistorySize=0,this.inFilterMode=!1,this.filterModeAvailable=!1,this.serverContents=this.editedContents=wI,this.recalcValues=this.editedContents.values,this.recalcFailures=BR,this.editedTaint=this.recalcTaint=BR,this.serverAvailability=this.editedAvailability=BR,this.serverUsed=this.editedUsed=DI,this.hiddenRows=this.hiddenAvailability=BR}return e.prototype.cloneServer=function(){var t=new e(this.sheet);return t.serverContents=this.serverContents,t.serverAvailability=this.serverAvailability,t.serverUsed=this.serverUsed,t},e.prototype.advanceState=function(e){this.editedContents=this.serverContents,this.recalcValues=this.editedContents.values,this.recalcFailures=BR,this.editedTaint=this.recalcTaint=BR,this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=this.editedAvailability=BR,this.serverUsed=this.editedUsed=DI,this.hiddenRows=this.hiddenAvailability=BR,this.inFilterMode=this.filterModeAvailable=!1},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=RO(t,SO(_O(e),UO));return void 0!==r&&r>=0},e.prototype.hasRecalcFailure=function(e){return IO(this.recalcFailures,_O(e))},e.prototype.hasEditedEditTaint=function(e){return IO(this.editedTaint,_O(e))},e.prototype.hasRecalcEditTaint=function(e){return IO(this.recalcTaint,_O(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r,n,i=wO.row(yr(e,t)),a=(r=this.hiddenAvailability)===(n=i)?0:r===BR?-1:n===BR?1:r===WR?n===WR?0:1:n===WR?-1:PR(r.setOperations,r.setOperations.top,r.root,n.root);if(!(void 0!==a&&a>=0))return pt({kind:zT.HiddenRows});var o=[];return xO(_R(this.hiddenRows,i),(function(e){var t=e[0],r=e[1];return o.push(dd(t,r)),!0})),vt(o)},e.prototype.setHiddenRows=function(e,t){var r=wO.row(yr(e.row,e.row+e.rows));this.hiddenRows=LR(UR(this.hiddenRows,r),_R(t,r)),this.hiddenAvailability=LR(this.hiddenAvailability,r)},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?vt(this.inFilterMode):pt({kind:zT.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){var r=this,n=SO(e,MO);VO(SO(this.editedAvailability,n),(function(e){return r.editedContents.formulae.forEachMeets(e,(function(r,n){return!!AI(n.fmla,void 0!==n.compiledFmla)||Ot(Jd(e,r),t)}))}))},e.prototype.promoteServerAvailability=function(e,t){var r=SO(e,MO),n=this.oldAvailabilities[t];if(void 0===n)return!1;var i=RO(n,r);return void 0!==i&&i>=0&&(this.unionAvailability(!0,SO(e,GO)),this.unionTaint(!0,BR),this.unionUsed(!0,DO(e)),!0)},e.prototype.extendServerUnused=function(e){var t=void 0===e?BR:_O(e),r=kO(t),n=this.serverContents,i=n.values,a=n.formats,o=n.formulae;VO(r,(function(e){return i.forEachMeets(e,(function(e,t){return NI(t.oper,t.clientFailure,t.calcState)||(i=i.setValue(e,bI)),!0})),a.forEachMeets(e,(function(e,t){return"object"==typeof t&&II(t.isExact,t.iformat)||(a=a.setValue(e,OI)),!0})),!0})),VO(r,(function(e){return o=LI(o,e),!0})),this.setContents(!0,{values:i,formats:a,formulae:o});var u=this.serverAvailability;u=gO(u=SO(u,t),SO(r,UO)),this.serverAvailability=this.editedAvailability=u,this.editedTaint=this.recalcTaint=BR;var c,s,l=this.serverUsed;s=e,l=void 0===(c=l)||void 0===s?void 0:Jd(c,s),this.serverUsed=this.editedUsed=l},e.prototype.setRecalcFailure=function(e){this.recalcFailures=gO(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=gO(this.recalcTaint,e)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this;Ot(e,(function(e,n,i){var a=function(e){return Array.isArray(e)}(t)?t[n][i]:t;return r.recalcValues=r.recalcValues.setValue(e,{oper:a,clientFailure:void 0,calcState:yI.Calced}),r.editedContents=V(V({},r.editedContents),{values:r.editedContents.values.setValue(e,{oper:a,clientFailure:void 0,calcState:yI.Dirty})}),!0}))},e.prototype.getRecalcValue=function(e){var t=this.recalcValues.getValue(e);return void 0===t?bI:t},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return void 0===t?bI.oper:t.oper},e.prototype.setEditedFormat=function(e,t){this.editedContents=V(V({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return void 0!==t?t:OI},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return void 0!==t?t:OI},e.prototype.getEditedFormula=function(e){var t=void 0;return this.editedContents.formulae.forEachGe(e,(function(e,r){return!!AI(r.fmla,void 0!==r.compiledFmla)||(t=[e,r],!1)})),t},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,this.recalcValues=this.editedContents.values,this.recalcFailures=BR},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=gO(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?BR:gO(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r,n,i=e?this.serverUsed:this.editedUsed;n=t,i=void 0===(r=i)?n:void 0===n?r:Kd(r,n),e&&(this.serverUsed=i),this.editedUsed=i},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u){this.setCommon(e,t,void 0,r,n,i,a,o,u)},e.prototype.setRangeFormula=function(e,t,r,n,i,a,o){var u=_O(t);this.setCommon(e,u,t,r,n,void 0,i,a,o)},e.prototype.setCommon=function(e,t,r,n,i,a,o,u,c){var s=e?this.serverContents:this.editedContents,l=s.values,f=s.formats,d=s.formulae;void 0!==n&&void 0===i&&(l=function(e,t,r){return VO(t,(function(t){return e.forEachLe(t,(function(t,n){return n.calcState!==r&&(e=e.setValue(t,{oper:n.oper,clientFailure:n.clientFailure,calcState:r})),!0})),!0})),e}(l,t,o));var h=n;void 0!==n&&(VO(t,(function(e){return d=LI(d,e),!0})),AI(n.fmla,void 0!==n.compiledFmla)&&(h=void 0));var v=void 0!==h&&void 0===r?n:void 0,p=void 0!==h&&void 0!==r?n:void 0,m=i;void 0!==i&&NI(i,a,o)&&(VO(t,(function(e){return l.forEachMeets(e,(function(e,t){return NI(t.oper,t.clientFailure,t.calcState)||(l=l.setValue(e,bI)),!0})),!0})),m=void 0);var g=void 0!==m?{oper:m,clientFailure:a,calcState:o}:void 0,C=u;"object"==typeof u&&II(u.isExact,u.iformat)&&(VO(t,(function(e){return f.forEachMeets(e,(function(e,t){return"object"==typeof t&&II(t.isExact,t.iformat)||(f=f.setValue(e,OI)),!0})),!0})),C=void 0);var S=!1===C?void 0:C,E=!1===C?C:void 0,y=t;if(!e){var R=SO(t,MO);y=gO(dO(SO(this.editedAvailability,R),"row","col"),SO(t,void 0!==c?_O(c):BR))}void 0===v&&void 0===S&&void 0===g||WO(y,(function(e){return void 0!==v&&(d=FI(d,e,v)),void 0!==S&&(f=f.setValue(e,S)),void 0!==g&&(l=l.setValue(e,g)),!0})),void 0!==p&&(d=FI(d,r,p)),void 0!==E&&(f=function(e,t,r){var n=SO(t,UO);return WO(yO(t,dO(SO(r,n),"row","col")),(function(t){return e=e.setValue(t,!1),!0})),e}(f,y,e?this.serverAvailability:this.editedAvailability));var O=void 0===i?BR:y;this.setContents(e,{values:l,formats:f,formulae:d}),this.unionAvailability(e,SO(O,GO)),e||(this.editedAvailability=yO(this.editedAvailability,yO(t,y))),this.unionTaint(e,O),this.unionUsed(e,DO(t))},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,BR),this.unionTaint(e,BR),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcFailuresSetSubspaceCount:AO(this.recalcFailures),recalcTaintSetSubspaceCount:AO(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:AO(this.editedAvailability),hiddenRowsNodeCount:JR(this.hiddenRows)+JR(this.hiddenAvailability)}},e.prototype.collectGarbage=function(e){var t=BR;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=gO(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function i(e){return IO(SO(_O(e),MO),t)}function a(e,t){return!AI(t.fmla,void 0!==t.compiledFmla)&&i(e)}function o(e,t){return("object"!=typeof t||!II(t.isExact,t.iformat))&&i(e)}function u(e,t){return!NI(t.oper,t.clientFailure,t.calcState)&&i(e)}this.serverContents={formulae:this.serverContents.formulae.filter(a),formats:this.serverContents.formats.filter(o),values:this.serverContents.values.filter(u)},this.editedContents={formulae:this.editedContents.formulae.filter(a),formats:this.editedContents.formats.filter(o),values:this.editedContents.values.filter(u)},this.recalcValues=this.recalcValues.filter(u)},e}();function GI(e,t){e[t]=(e[t]||0)+1}function xI(e,t,r){return e.push(t.join(".")+": expected "+r),!1}function PI(e,t,r){return void 0===r&&(r=!1),function(n,i,a){return Cr(n)&&e(n)||xI(i,a,r?t+" (received "+n+")":t)}}function VI(e,t,r,n){for(var i=[],a=t(e,i,[n]),o=0,u=i;o<u.length;o++){GI(r,u[o])}return a}function WI(e,t,r,n){var i=n+".<index>";return e.filter((function(e){return VI(e,t,r,i)}))}function BI(e){return function(t,r,n){return!!Sr(t)||e(t,r,n)}}function HI(e){return function(t,r,n){if(Sr(t))return xI(r,n,"non-null object");var i=n.length;try{var a=!0;for(var o in e)n[i]=o,a=a&&e[o](t[o],r,n);return a}finally{n.length=i}}}function jI(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,i){return e&&i(t,r,n)}),!0)}}function KI(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,i){return t.reduce((function(e,t){return e&&t(r)(r,n,i)}),e(r,n,i))}}function qI(e){return function(t,r,n){if(!Array.isArray(t))return xI(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,i){return t&&e(i,r,n)}),!0)}finally{n.pop()}}}function JI(e){var t="one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,i){if(Sr(r))return xI(n,i,"non-null object");var a=i.length;try{var o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return Sr(o)?(i.push("kind"),xI(n,i,t)):o(r,n,i)}finally{i.length=a}}}function XI(e){var t="typeof one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,i){var a=e[typeof r];return Sr(a)?xI(n,i,t):a(r,n,i)}}function YI(e){return"number"==typeof e&&e>-1/0&&e<1/0}function QI(e){return(0|e)===e||Math.floor(e)===e}function zI(e,t,r){return void 0===t&&(t="natural < "+e),void 0===r&&(r=!1),PI((function(t){return"number"==typeof t&&t>=0&&t<e&&QI(t)}),t,r)}var ZI=PI(YI,"finite number"),$I=PI((function(e){return YI(e)&&QI(e)}),"integer"),eT=zI(1/0,"natural"),tT=PI((function(e){return"string"==typeof e}),"string"),rT=PI((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),nT=PI((function(e){return"boolean"==typeof e}),"boolean"),iT=PI((function(e){return Array.isArray(e)}),"Array");function aT(e){return PI((function(t){return t===e}),JSON.stringify(e))}function oT(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var uT=PI((function(e){return"string"==typeof e&&oT(e)}),"formula text"),cT=HI({functionId:eT,functionName:rT}),sT=HI({errorType:eT,errorName:PI((function(e){return"string"==typeof e&&e.length>1&&"#"===e[0]}),"error name")}),lT={General:!0,Number:!0,Currency:!0,Accounting:!0,Date:!0,Time:!0,Percentage:!0,Fraction:!0,Scientific:!0,Text:!0,Special:!0,Custom:!0,MaxCategory:!1},fT=HI({iformat:eT,category:PI((function(e){return"string"==typeof e&&!0===lT[e]}),"NumberFormatCategory"),decimals:eT}),dT=PI((function(e){return"string"==typeof e||YI(e)}),"string or finite number"),hT=HI({sheetId:dT,sheetName:tT}),vT=zI(1<<20,void 0,!0),pT=zI(16384,void 0,!0),mT=HI({row:vT,column:pT}),gT=jI(mT,HI({lastRow:BI(vT),lastColumn:BI(pT)})),CT=jI(gT,HI({sheetId:dT})),ST=HI({kind:aT("Blank")}),ET=HI({kind:aT("Error"),type:eT}),yT=XI({number:ZI,string:tT,boolean:nT,object:JI({Blank:ST,Error:ET})}),RT=jI(HI({value:yT,iformat:eT,failureReason:BI(tT)}),JI({CellFormula:HI({formulaBarText:uT}),ArrayFormula:HI({formulaBarText:BI(tT)}),Value:HI({formulaBarText:tT}),Inferred:HI({formulaBarText:BI(tT)})})),OT=HI({range:CT,excludeRows:BI(qI(vT)),excludeColumns:BI(qI(pT)),data:BI(RT),fromStateId:BI($I)}),IT=HI({isSpilled:nT,formulaBarText:uT}),TT=HI({range:CT,data:BI(IT),fromStateId:BI($I)}),kT=HI({sheetId:dT,usedRange:BI(gT)}),AT=XI({number:ZI,string:tT,boolean:nT,object:JI({Error:ET})}),bT=HI({kind:aT("NamedValue"),value:AT}),NT=HI({kind:aT("NamedFormula"),formulaBarText:uT}),FT=HI({kind:aT("NamedRange"),range:CT}),LT=HI({kind:aT("NamedFailure"),failureReason:tT,objectKind:BI(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,i=e;n<i.length;n++){var a=i[n];r[a]=!0}var o="one of "+JSON.stringify(e);return PI((function(e){return"string"==typeof e&&!0===r[e]}),o)}("NamedValue","NamedFormula","NamedRange","NamedTable"))}),wT=HI({name:tT,data:BI(JI({NamedValue:bT,NamedFormula:NT,NamedRange:FT,NamedFailure:LT}))}),_T=HI({scope:BI(dT),objects:BI(iT),fromStateId:BI($I)}),DT=HI({value:BI(yT)}),MT=HI({value:yT}),UT=PI((function(e){return e.length>0}),"a non-empty array"),GT=PI((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),xT=jI(HI({range:KI(qI(CT),(function(e){return UT}),(function(e){return GT})),origin:BI(mT),viewport:BI(CT)}),JI({CellFormula:HI({formulaBarText:uT,value:BI(yT)}),Value:HI({formulaBarText:tT,value:yT}),Inferred:KI(HI({formulaBarText:tT}),(function(e){return t=oT(e.formulaBarText)?DT:MT,function(e,r,n){return t(e,r,n)};var t}))})),PT=HI({range:CT,formulaBarText:PI((function(e){return"string"==typeof e&&(0===e.length||oT(e))}),"empty string or text denoting formula"),origin:BI(mT),viewport:BI(CT)}),VT=((MI={number:!0,string:!0,boolean:!0})[te.Error]=!0,MI[te.Array]=!1,MI[te.Rich]=!1,MI),WT=PI((function(e){var t="object"==typeof e?e.kind:typeof e;return("string"==typeof t||"number"==typeof t)&&!0===VT[t]}),"supported WriteOper"),BT=function(e){return{kind:"NamedValue",value:e}},HT=function(e){return{kind:"NamedFormula",fmla:e}},jT=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},KT={namesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};var qT=function(){function e(e,t){this.names=e,this.allAvailable=t}return e.create=function(t){return new e(ol.create(t),!1)},e.prototype.update=function(t,r){return t!==this.names||r!==this.allAvailable?new e(t,r):this},e.prototype.getEntry=function(e,t){var r=this.names.getEntry(t);return void 0===r?this.allAvailable?vt(void 0):pt({kind:zT.NameLoc,name:hr(e,t)}):vt(!1!==r.value?r:void 0)},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable)},e.prototype.setUndefined=function(){return this.update(this.names,!0)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.allAvailable?this.update(this.names.filter((function(e,t){return!1!==t})),!0):this},e.prototype.clearCompiledFormulas=function(){this.names.forEach((function(e,t){return!1!==t&&t.compiledFmla.reset(),!0}))},e}(),JT=function(){function e(e,t){this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=qT.create(e),this.emptyRecalcFailures=this.recalcFailures=wn.create(e)}return e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e){var t=this.contents.getEntry(this.scope,e);return mt(t)?vt(void 0!==t.value?hr(this.scope,t.value.key):void 0):t},e.prototype.getNameFormula=function(e){var t=this.contents.getEntry(this.scope,e);return mt(t)?vt(void 0!==t.value?t.value.value:void 0):t},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.clearCompiledFormulas=function(){this.contents.clearCompiledFormulas(),this.oldContents!==this.contents&&this.oldContents.clearCompiledFormulas()},e.prototype.setNamedObject=function(e,t,r){this.contents=void 0===r?this.contents.remove(t):this.contents.setValue(t,r),this.isCurrent=this.isChanged=!0},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e){return!this.isChanged&&e===this.oldStateId&&(this.contents=this.oldContents,this.isCurrent=!0,!0)},e}(),XT=function(){function e(e,t,r,n,i,a){void 0===r&&(r={}),void 0===n&&(n=[]),this.document=e,this.stringCompareCI=t,this.sheets=r,this.sheetPosToId=n,this.sheetNameToId=void 0===i?wn.create(t):i,this.globalNames=void 0===a?new JT(t,fr(e)):a}return e.prototype.cloneServer=function(){var t=V({},this.sheets);for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];void 0!==n&&(t[r]=V(V({},n),{grid:n.grid.cloneServer()}))}return new e(this.document,this.stringCompareCI,t,this.sheetPosToId,this.sheetNameToId,this.globalNames)},e.prototype.setRecalcFailure=function(e,t){var r=this.getSheetById(e);return r.kind===ze.Failure?r:vt(r.value.grid.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getSheetById(e);return r.kind===ze.Failure?r:vt(r.value.grid.setRecalcEditTaint(t))},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===ze.Failure?r:vt(r.value.grid.setEditedAndRecalcValues(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===ze.Failure?r:vt(r.value.grid.setEditedFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===ze.Failure?n:vt(n.value.grid.setHiddenRows(t,r))},e.prototype.setInFilterMode=function(e,t){var r=this.getSheetById(e);return r.kind===ze.Failure?r:vt(r.value.grid.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u){var c=this.getSheetById(t.sheet.index);if(c.kind===ze.Failure)return c;var s=void 0!==u&&Tt(t.sheet,u.sheet)?u.range:void 0;return vt(c.value.grid.setCellContents(e,t.set,r,n,i,a,o,s))},e.prototype.setRangeFormula=function(e,t,r,n,i,a,o){var u=this.getSheetById(t.sheet.index);if(u.kind===ze.Failure)return u;var c=void 0!==o&&Tt(t.sheet,o.sheet)?o.range:void 0;return vt(u.value.grid.setRangeFormula(e,t.range,r,n,i,a,c))},e.prototype.setNamedObject=function(e,t,r){var n=this.getNameManager(t.scope.index);return n.kind===ze.Failure?n:vt(n.value.setNamedObject(e,t.name,r))},e.prototype.setUndefinedNames=function(e){var t=this.getNameManager(e.index);return t.kind===ze.Failure?t:vt(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNameManager(e.index);return r.kind===ze.Failure?r:vt(r.value.promoteNamedObjects(t))},e.prototype.setSheetNames=function(t){for(var r,n=[],i={},a=[],o=0;o<t.length;o+=1){var u=t[o],c=u.sheetName,s=u.sheetId;n[o]=s,a.push([c,s]);var l=this.sheets[s];if(void 0===l){var f=rr(this.document,s);i[s]={grid:new UI(f),names:new JT(this.stringCompareCI,f),pos:o,name:c}}else i[s]=V(V({},l),{pos:o})}var d=(r=wn.create(this.stringCompareCI)).setValues.apply(r,a);return new e(this.document,this.stringCompareCI,i,n,d,this.globalNames)},e.prototype.extendServerUnused=function(e,t){var r=this.getSheetById(e);return r.kind===ze.Failure?r:vt(r.value.grid.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getSheetById(e);return n.kind===ze.Failure?n:vt(n.value.grid.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t){var r=this.getNameManager(e);if(r.kind===ze.Failure)return r;var n=r.value.getNameLoc(t);return n.kind,ze.Failure,n},e.prototype.getNameFormula=function(e){var t=this.getNameManager(e.scope.index);return t.kind===ze.Failure?t:t.value.getNameFormula(e.name)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===ze.Failure?t:vt(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===ze.Failure?t:vt(t.value.setRecalcFailure(e.name))},e.prototype.getNameManager=function(e){if(void 0===e)return vt(this.globalNames);var t=this.getSheetById(e);return t.kind===ze.Failure?t:vt(t.value.names)},e.prototype.getEditedFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.getEditedFormula(e.range))},e.prototype.getEditedFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.getEditedFormat(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getSheetById(e);return t.kind===ze.Failure?t:t.value.grid.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===ze.Failure?n:n.value.grid.getHiddenRows(t,r)},e.prototype.getServerFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.getServerFormat(e.range))},e.prototype.getRecalcValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.getRecalcValue(e.range))},e.prototype.getServerValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.getServerValue(e.range))},e.prototype.allServerAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.allEditedAvailable(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===ze.Failure?t:vt(t.value.grid.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===ze.Failure?n:vt(n.value.grid.forEachEditedNonBlankCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.getSheetByName(e);return t.kind===ze.Failure||void 0===t.value?t:vt(t.value.grid.sheet)},e.prototype.getSheetName=function(e){var t=this.getSheetById(e);return t.kind===ze.Failure?t:vt(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getSheetById(e);return t.kind===ze.Failure?t:vt(t.value.grid.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){var t,r;if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{var n=this.getSheetById(e.index);if(!mt(n))return n;var i=this.getSheetById(e.index2);if(!mt(i))return i;t=Rr(n.value.pos,i.value.pos),r=Or(n.value.pos,i.value.pos)+1}for(var a=[],o=t;o<r;o+=1){var u=this.sheetPosToId[o];if(void 0===u)return this.unavailableFailure({kind:zT.SheetRange,sheets:e});a.push(u)}return vt(function(e,t){return{sheets:e,position:t}}(a,t))},e.prototype.onCellModified=function(e){this.forEachSheet((function(t){t.grid.onCellModified(e),t.names.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t){t.grid.collectGarbage(e),t.names.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t){t.grid.advanceState(e),t.names.advanceState(e)})),this.globalNames.advanceState(e)},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e){e.grid.clearCompiledFormulas(),e.names.clearCompiledFormulas()})),this.globalNames.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){var e=_I;return this.forEachSheet((function(t){return r=e,n=t.grid.getStatistics(),e={serverFormulaeNodeCount:r.serverFormulaeNodeCount+n.serverFormulaeNodeCount,serverFormatsNodeCount:r.serverFormatsNodeCount+n.serverFormatsNodeCount,serverValuesNodeCount:r.serverValuesNodeCount+n.serverValuesNodeCount,editedFormulaeNodeCount:r.editedFormulaeNodeCount+n.editedFormulaeNodeCount,editedFormatsNodeCount:r.editedFormatsNodeCount+n.editedFormatsNodeCount,editedValuesNodeCount:r.editedValuesNodeCount+n.editedValuesNodeCount,recalcValuesNodeCount:r.recalcValuesNodeCount+n.recalcValuesNodeCount,recalcFailuresSetSubspaceCount:r.recalcFailuresSetSubspaceCount+n.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:r.recalcTaintSetSubspaceCount+n.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:r.availabilitySetSubspaceCount+n.availabilitySetSubspaceCount,availabilityHistorySize:r.availabilityHistorySize+n.availabilityHistorySize,hiddenRowsNodeCount:r.hiddenRowsNodeCount+n.hiddenRowsNodeCount};var r,n})),e},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheet((function(t){return r=e,n=t.names.getStatistics(),e={namesCount:r.namesCount+n.namesCount,recalcFailuresCount:r.recalcFailuresCount+n.recalcFailuresCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.getAvailableCells=function(){var e=[];for(var t in this.sheets){var r=this.sheets[t];if(void 0!==r){var n=rr(this.document,parseInt(t,10));e.push({sheetIdx:n,availableCells:r.grid.getServerAvailability()})}}return e},e.prototype.forEachSheet=function(e){for(var t in this.sheets){if(this.sheets.hasOwnProperty(t))e(this.sheets[t])}},e.prototype.getSheetById=function(e){var t=this.sheets[e];return void 0!==t?vt(t):this.unavailableFailure({kind:zT.SheetId,document:this.document,sheetId:e})},e.prototype.getSheetByName=function(e){var t=this.sheetNameToId.getValue(e);return void 0===t?vt(void 0):this.getSheetById(t)},e.prototype.unavailableFailure=function(e){return pt(e)},e}(),YT=ar(0,0);function QT(e){var t=[],r=ji(Hi((function(){})),(function(){}),{vArray:function(e){e.nodes.forEach((function(e){return e.forEach((function(e){return Bi(e,r)}))}))},vApp:function(n){var i;if(Ut(n.head))t.push(function(e){if(e===qe.Isect)return" ";if(e===qe.Union)return",";var t=$e[e];return void 0===t?"op:"+e:t}(n.head.id));else{var a=e.annotations[n.head.label];(null===(i=a)||void 0===i?void 0:i.kind)===G.WorksheetFuncName&&t.push(vi(a.id))}for(var o=0,u=n.args;o<u.length;o++){Bi(u[o],r)}},vParen:function(e){Bi(e.node,r)}});return Wi(e.node,r),t}var zT,ZT=Ae([],[],ne.None,oe.Exact),$T=function(){function e(e,t,r,n,i,a,o,u,c,s,l){this.onNameFailure=n,this.onRangeFailure=i,this.onUnavailableObject=a,this.onSetCellValue=o,this.onSetCellValues=u,this.schedulerInfo=c,this.limits=s,this.maxDereferenceCells=l,this.iformats=[],this.worksheetFuncOverrides={},this.interruptToken=[ld.Continue],this.setDynamicPrecs=function(){},this.loadObjects=function(){return!1},this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.config=$n(e,r,t),this.setLocaleInfo(e),this.setRefStyle(r),this.parser=ms(this),this.analyzer=Kf(this),this.compiler=Zh(this),this.evaluator=Np(this)}return e.prototype.reconfigure=function(e,t,r){this.schedulerInfo=e,this.limits=t,this.maxDereferenceCells=r},e.prototype.setLocaleInfo=function(e){this.stringCompareCI=e.stringCompareCI,this.config=V(V({},this.config),{localeInfo:e})},e.prototype.setRefStyle=function(e){this.config=V(V({},this.config),{refStyle:e})},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.stringCompareCI(t,r.name)?er(e,t):r},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getNameLoc=function(e,t){var r=this.getDocument(e.document);if(r.kind===ze.Failure)return pt(nk([r.reason]));var n=r.value.getNameLoc(e.index,t);return n.kind===ze.Failure?pt(nk([n.reason])):n},e.prototype.getUserDefinedFuncLoc=function(e,t){return pt(jt(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===ze.Failure)return pt(nk([t.reason]));if(!t.value)return pt(nk([{kind:zT.GridRange,range:e}]));var r=this.getEditedFormat(e);if(r.kind===ze.Failure)return pt(nk([r.reason]));if(!1===r.value)return pt(nk([{kind:zT.CellFormat}]));var n=this.resolveIformat(r.value);return void 0===n.category||void 0===n.decimals?pt(nk([{kind:zT.NumberFormat,iformat:n.iformat}])):vt({iformat:n.iformat,category:n.category,decimals:n.decimals})},e.prototype.getNameFormula=function(e){var t=this.getDocument(e.scope.document);if(t.kind===ze.Failure)return pt(nk([t.reason]));var r=t.value.getNameFormula(e);if(r.kind===ze.Failure)return pt(nk([r.reason]));if(void 0===r.value)return vt(void 0);var n=r.value.compiledFmla.getValue();if(mt(n))return n;var i=this.hasRecalcNameFailure(e);return mt(i)?i.value||this.setNameFailure(e,n.reason):this.onUnavailableObject(i.reason),pt(function(e){return{kind:od.PreviousNameFailure,name:e}}(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===ze.Failure)return pt(nk([t.reason]));if(void 0===t.value)return vt(void 0);var r=t.value,n=r[0],i=r[1];if(void 0===i.compiledFmla)return vt(void 0);var a=cr(e.sheet,n),o=this.readCompiledFmla(a,i.compiledFmla);return mt(o)?vt(md(a,i.lexicalKind,o.value)):o},e.prototype.getKnownFormat=function(e){var t=this.iformats[e];return void 0===t?pt(nk([{kind:zT.NumberFormat,iformat:e}])):vt({iformat:e,category:t.category,decimals:t.decimals})},e.prototype.setCellValue=function(e,t,r){var n=this.hasRecalcValueChanged(e,t);if(n.kind===ze.Failure)return this.onUnavailableObject(n.reason);var i=this.setEditedAndRecalcValues(e,t);if(i.kind===ze.Failure)return this.onUnavailableObject(i.reason);var a=this.propagateEditTaint(e,r);if(a.kind===ze.Failure)return this.onUnavailableObject(a.reason);this.onSetCellValue(e,t,r,a.value,this.evalParams,n.value)},e.prototype.setCellValues=function(e,t,r){var n=this.setEditedAndRecalcValues(e,t);if(n.kind===ze.Failure)return this.onUnavailableObject(n.reason);var i=this.propagateEditTaint(e,r);if(i.kind===ze.Failure)return this.onUnavailableObject(i.reason);this.onSetCellValues(e,t,r,i.value,this.evalParams)},e.prototype.getFirstOrderFunc=function(e){if(0!=(dt(e).staticPrecs&(ne.Time|ne.Calc)))return pt(nk([{kind:zT.VolatileFunction,name:vi(e)}]));if(void 0!==this.worksheetFuncOverrides[e])return vt(this.worksheetFuncOverrides[e]);var t=uE(e);return null!=t?vt(t):pt(jt([vi(e)]))},e.prototype.getUserDefinedFunc=function(e){return pt(jt(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){var t=this.getSheetRangeIds(e);return t.kind===ze.Failure?pt(nk([t.reason])):vt(t.value)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,_O(e.range));if(n.kind===ze.Failure)return this.onUnavailableObject(n.reason);var i=this.setEditedAndRecalcValues(e,Ke);if(i.kind===ze.Failure)return this.onUnavailableObject(i.reason);var a=this.propagateEditTaint(e,r);if(a.kind===ze.Failure)return this.onUnavailableObject(a.reason);this.onRangeFailure(e,t,r,a.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===ze.Failure?pt(nk([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===ze.Failure)return pt(nk([r.reason]));var n=r.value.getSheetName(t);return n.kind===ze.Failure?pt(nk([n.reason])):void 0===n.value?n:vt(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===ze.Failure)return pt(nk([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===ze.Failure?pt(nk([n.reason])):void 0===n.value?n:vt(n.value.index)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===ze.Failure)return pt(nk([n.reason]));var i=n.value.getHiddenRows(e.index,t,r);return i.kind===ze.Failure?pt(nk([i.reason])):i},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===ze.Failure)return pt(nk([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===ze.Failure?pt(nk([r.reason])):r},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var i=t();return Array.isArray(i)?i:Td((function(){return r.withEvalParams(e,i.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t){var r=this;return this.withEvalParams({computeKind:e,computeCell:t},(function(){return r.evaluator.evalCells([t])}))},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===ze.Failure?r:(this.document=r.value.setSheetNames(t),vt(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,i=e.document,a=this.getDocument(i);return a.kind===ze.Failure?a:a.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():_I},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():KT},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.getEditedFormula(e)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.getEditedFormat(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.getServerFormat(e)},e.prototype.getRecalcValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.getRecalcValue(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.getServerValue(e)},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,i=this.getDocument(r.document);return i.kind===ze.Failure?i:i.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===ze.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u,c,s){var l=this.getDocument(t.sheet.document);if(l.kind===ze.Failure)return l;var f=void 0===r?void 0:n?this.compileFmla(e,qt.Cell,i,void 0,r):""===r?TI:{fmla:r,lexicalKind:qt.Cell,origin:i,compiledFmla:void 0};return l.value.setCellContents(e,t,f,a,o,u,c,s)},e.prototype.setRangeFormula=function(e,t,r,n,i,a,o,u){var c=this.getDocument(t.sheet.document);if(c.kind===ze.Failure)return c;var s=this.compileFmla(e,qt.Range,n,bt(t.range),r);return c.value.setRangeFormula(e,t,s,i,a,o,u)},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);if(n.kind===ze.Failure)return n;var i=Zt(t),a=void 0===r?void 0:this.compileNamedObject(e,i,r);return n.value.setNamedObject(e,t,a)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===ze.Failure?t:t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===ze.Failure?r:r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[]),e.forEach((function(e){r.iformats[e.iformat]=e}))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===ze.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===ze.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveIformat=function(e){if(e.isExact&&(void 0===e.category||void 0===e.decimals)){var t=this.iformats[e.iformat];void 0!==t&&(e.category=t.category,e.decimals=t.decimals)}return e},e.prototype.inferRangeFormat=function(e,t){var r,n=this,i=e,a=RO(_O(t.range),e);if(void 0!==a&&a<=0){var o=this.inferCellFormat(t);if(!mt(o)||void 0===o.value)return[];i=yO(i,_O(t.range)),r=o.value}else{var u=this.getEditedFormat(t);if(!mt(u))return[u.reason];if(!1===u.value)return[];r=this.resolveIformat(u.value)}r=V({},r);var c=[];return this.forEachEditedNonBlankCellInSet(t.sheet,i,(function(e){var i=sr(t.sheet,e),a=n.isFormatGeneral(i);if(!mt(a))return c.push(a.reason),!0;if(!a.value)return!0;var o=n.setEditedFormat(i,r);return mt(o)||c.push(o.reason),!0})),c},e.prototype.inferCellFormat=function(e){var t=this.isFormatGeneral(e);if(!mt(t))return t;if(!t.value)return vt(void 0);var r=this.getEditedFormula(e);if(r.kind===ze.Failure)return r;if(void 0===r.value||void 0===r.value[1].compiledFmla)return vt(void 0);var n=r.value[1].compiledFmla.getValue();if(!mt(n))return vt(void 0);var i=zt(r.value[1].lexicalKind,cr(e.sheet,r.value[0])),a=n.value,o=this.analyzer.findBestFormat(Ps(i),a);if(!mt(o))return vt(void 0);var u=o.value,c=u.category,s=u.iformat,l=u.decimals,f=this.iformats[s],d=void 0!==f&&c===f.category&&l===f.decimals,h=RI(d,s,c,l),v=this.setEditedFormat(e,h);return mt(v)?vt(h):v},e.prototype.isFormatGeneral=function(e){var t=this.getEditedFormat(e);return t.kind===ze.Failure?t:!1===t.value?vt(!1):vt("General"===this.resolveIformat(t.value).category)},e.prototype.anonymizeFormula=function(e,t){var r,n=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==n&&mt(n)?[ta(n.value,e),QT(n.value)]:[Ca(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,i){var a=this;return{fmla:i,lexicalKind:t,origin:null!=n?n:r,compiledFmla:new mE((function(){var o=a.parser.parseFormula(Oa(t,r),i),u=a.checkFormula(Gs(t,r),o,i,e?"server-cell-formula":"edit-cell-formula"),c=a.adjustFormulaOrigin(u,r,n);return a.compileFormula(t,r,c)}))}},e.prototype.compileFormula=function(e,t,r){return mt(r)?this.compiler.compileFormula(cd(e,t),r.value):r},e.prototype.compileNamedObject=function(e,t,r){var n=this,i=e?"server-named-formula":"edit-named-formula";switch(r.kind){case"NamedFormula":return{obj:r,compiledFmla:new mE((function(){var e=r.fmla,t=n.parser.parseFormula(Oa(qt.NameManager,YT),e),a=n.checkFormula(xs(YT),t,e,i);return n.compileNamedFormula(a)}))};case"NamedValue":return{obj:r,compiledFmla:new mE((function(){var e;if(Vd(r.value)){A("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",Ct(r.value.sheets)&&1===r.value.ranges.length);var a=r.value.sheets,o=n.getDocument(a.document);if(!mt(o))return n.onUnavailableObject(o.reason),pt(nk([o.reason]));var u=o.value.getSheetName(a.index);if(!mt(u))return n.onUnavailableObject(u.reason),pt(nk([u.reason]));var c=r.value.ranges[0];e=de(Re(se(ce($(U.Abs,c.row),$(U.Abs,c.col)),ce($(U.Abs,c.row+c.rows-1),$(U.Abs,c.col+c.cols-1))),Q(u.value,Y(a.document.name,a.document.path))),[])}else e=de(me(r.value,!0),[]);var s=n.analyzer.checkFormula(xs(YT),e,i);return St(s)?n.compileNamedFormula(vt(s)):k("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula "+ta(e,t))}))};case"NamedFailure":return{obj:r,compiledFmla:new mE((function(){return pt(nk([{kind:zT.ClientFailure,reason:r.failureReason}]))}))};default:return T("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},e.prototype.compileNamedFormula=function(e){return mt(e)?this.compiler.compileFormula(cd(qt.NameManager,YT),e.value):e},e.prototype.checkFormula=function(e,t,r,n){if(!mt(t))return t;var i=this.analyzer.checkFormulaWithDiagnostics(e,t.value,n);return St(i[0])?vt(i[0]):pt(hd("calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+Ca(r),Ms(i[1])))},e.prototype.adjustFormulaOrigin=function(e,t,r){return mt(e)&&void 0!==r?vt(Wv(t,r,e.value)):e},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&It(this.documentLoc,e)?vt(this.document):this.unavailableFailure({kind:zT.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new XT(e,this.stringCompareCI)),this.getDocument(e)},e.prototype.unavailableFailure=function(e){return pt(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=new Array(e.rows);return Ot(e,(function(i,a,o){var u=r.tryGetCellValue(i,t);return void 0!==u&&((void 0!==n[a]?n[a]:n[a]=new Array(e.cols))[o]=u,!0)}))?n:void 0},e.prototype.tryGetCellValue=function(e,t){var r=sr(t,e),n=this.getRecalcValue(r);if(n.kind!==ze.Failure){var i=n.value,a=i.oper,o=i.clientFailure,u=i.calcState;if(void 0===o){if(u===yI.Calced)return vd(a);var c=this.getEditedFormula(r);if(c.kind!==ze.Failure)if(void 0!==c.value){var s=c.value,l=s[0],f=s[1];if(void 0!==f.compiledFmla){if(mt(this.readCompiledFmla(cr(t,l),f.compiledFmla)))return pd(sr(t,bt(l)))}else this.onUnavailableObject({kind:zT.CellEvaluatingValue})}else this.setCellFailure(r,nk([{kind:zT.CellMissingFormula}]),ZT);else this.onUnavailableObject(c.reason)}else{var d={kind:zT.ClientFailure,reason:o};this.setCellFailure(r,nk([d]),ZT)}}else this.onUnavailableObject(n.reason)},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===ze.Failure)return pt(nk([n.reason]));if(!n.value)return pt(nk([{kind:zT.GridRange,range:r}]));var i=t.hasRecalcFailure(r);if(i.kind===ze.Failure)return pt(nk([i.reason]));if(i.value)return pt(Od(r));if(Xd(r.range)>t.maxDereferenceCells)return pt(nk([{kind:zT.GridRangeSize,range:r}]));var a=e(r.range,r.sheet);return void 0===a?pt(Od(r)):vt(a)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();return mt(r)?r:(this.setCellFailure(e,r.reason,ZT),pt(nk([{kind:zT.CellFormula,reason:r.reason}])))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===ze.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===ze.Failure||void 0===r.value?r:vt(cr(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===ze.Failure?t:t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.allEditedAvailable(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===ze.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===ze.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===ze.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.hasRecalcValueChanged=function(e,t){var r=this.hasRecalcFailure(e);if(r.kind===ze.Failure||r.value)return r;var n=this.getRecalcValue(e);return n.kind===ze.Failure?n:vt(void 0!==n.value.clientFailure||!Bt(n.value.oper,t,!1))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===ze.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===ze.Failure)return r;if(r.value)return vt(HO.EditedCell);for(var n=0,i=t.cells;n<i.length;n++){var a=i[n],o=this.hasRecalcEditTaint(a);if(o.kind===ze.Failure)return o;if(o.value){var u=this.setRecalcEditTaint(e.sheet,_O(e.range));return u.kind===ze.Failure?u:vt(HO.DependentCell)}}return t.bound===oe.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===BO.EditedCell?vt(HO.IndependentCell):vt(HO.UnknownNonEditedCell)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===ze.Failure?r:r.value.setEditedAndRecalcValues(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===ze.Failure?t:t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===ze.Failure?t:t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===ze.Failure)return this.onUnavailableObject(r.reason);this.onNameFailure(e,t,this.evalParams)},e}(),ek=function(e,t){return(e<<t|e>>>32-t)>>>0},tk=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-ek(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^ek(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}(),rk=ir(0,0,1<<20,16384);!function(e){e.DocumentLoc="DocumentLoc",e.SheetRange="SheetRange",e.SheetId="SheetId",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.HiddenRows="HiddenRows",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.PrecisionIncorrect="PrecisionIncorrect",e.PrecisionUnknown="PrecisionUnknown"}(zT||(zT={}));var nk=ad,ik=function(){function e(e,t,r,n){var i,a=this;void 0===n&&(n={}),this.queue=new iI,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.docs=new $T(e,t,r,this.onNameFailure.bind(this),this.onRangeFailure.bind(this),this.logUnavailableObject.bind(this),this.onSetCellValue.bind(this),this.onSetCellValues.bind(this),n,n,null!=(i=n.maxDereferenceCells)?i:32768),this.reconfigure(n),this.queue.onInvalidateMessage=function(e){if(e.kind===$O.ContinueComputation||e.kind===$O.PrecisionContinueComputation){var t=e.message.computeMsg;t.stateId>=a.stateId&&a.queue.isMessageValid(t)&&a.queue.push(t.kind,t.stateId,t.message)}}}return e.prototype.reconfigure=function(e){var t;this.config=e,this.rng=new tk(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!=(t=e.maxDereferenceCells)?t:32768)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==BO.PrecisionTest&&this.outputMessageLog.push({kind:tI.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,i){var a=i,o=a.computeKind,u=a.computeCell;if(o!==BO.PrecisionTest)this.outputMessageLog.push({kind:tI.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t});else if(Tt(e.sheet,u.sheet)&&gI(e.range,u.range)){var c={samples:[],failures:[t]};this.outputMessageLog.push({kind:tI.PrecisionStatistics,stateId:this.stateId,stats:c})}},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.logUnavailableObject=function(e){var t=nk([e]);this.outputMessageLog.push({kind:tI.UnhandledFailure,stateId:this.stateId,reason:t})},e.prototype.onSetCellValue=function(e,t,r,n,i,a){var o=i,u=o.computeKind,c=o.computeCell;if(u===BO.PrecisionTest)return this.setPrecisionResult(c,e,t,r);var s=void 0,l=this.docs.getEditedFormat(e);if(l.kind===ze.Failure)return this.logUnavailableObject(l.reason);var f=this.docs.getServerFormat(e);if(f.kind===ze.Failure)return this.logUnavailableObject(f.reason);l.value!==f.value&&"object"==typeof l.value&&(s=this.docs.resolveIformat(l.value)),a||void 0!==s?(this.outputMessageLog.push({kind:tI.RecalcStatistics,message:JO.ChangedCell,stateId:this.stateId,cellKind:n}),n!==HO.EditedCell&&n!==HO.DependentCell||this.outputMessageLog.push({kind:tI.CellWrite,stateId:this.stateId,cellKind:n,cell:e,value:t,format:s})):this.outputMessageLog.push({kind:tI.RecalcStatistics,message:JO.UnchangedCell,stateId:this.stateId,cellKind:n})},e.prototype.onSetCellValues=function(e,t,r,n,i){var a=this,o=i,u=o.computeKind,c=o.computeCell;u!==BO.PrecisionTest?n!==HO.EditedCell&&n!==HO.DependentCell||this.outputMessageLog.push({kind:tI.RangeWrite,stateId:this.stateId,cellKind:n,range:e,values:t}):Ot(e.range,(function(n,i,o){return a.setPrecisionResult(c,sr(e.sheet,n),t[i][o],r),!0}))},e.prototype.setPrecisionResult=function(e,t,r,n){var i=this.docs.allServerAvailable(t);if(i.kind===ze.Failure)return this.logUnavailableObject(i.reason);if(At(e,t)){var a=this.docs.getEditedFormula(t);if(a.kind===ze.Failure)return this.logUnavailableObject(a.reason);if(void 0===a.value)return this.logUnavailableObject({kind:zT.CellMissingFormula});var o=a.value,u=o[0],c=o[1];if(void 0===c.compiledFmla)return this.logUnavailableObject({kind:zT.CellEvaluatingValue});if(!i.value)return this.logUnavailableObject({kind:zT.GridRange,range:t});var s=this.docs.getServerValue(t);if(s.kind===ze.Failure)return this.logUnavailableObject(s.reason);var l={samples:[this.precisionResult(r,s.value,zt(c.lexicalKind,cr(t.sheet,u)),c)],failures:[]};this.outputMessageLog.push({kind:tI.PrecisionStatistics,stateId:this.stateId,stats:l})}else if(i.value){var f=this.docs.getServerValue(t);if(f.kind===ze.Failure)return this.logUnavailableObject(f.reason);Bt(r,f.value,!0)||this.docs.setCellFailure(t,nk([{kind:zT.PrecisionIncorrect}]),n)}else this.docs.setCellFailure(t,nk([{kind:zT.PrecisionUnknown}]),n)},e.prototype.precisionResult=function(e,t,r,n){var i=ZO(t),a=this.docs.anonymizeFormula(r,n),o=a[0],u=a[1];if(Bt(e,t,!0))return{expected:i,formula:o,functions:u};var c=ZO(e);return"number"==typeof t&&"number"==typeof e?{expected:i,sampled:c,relMagnitude:zO(0===t?e:(e-t)/t),formula:o,functions:u}:{expected:i,sampled:c,formula:o,functions:u}},e.prototype.handleSetCellContents=function(e,t){var r=this,n=t.cells,i=t.isFormula,a=t.fmla,o=t.value,u=t.origin,c=t.format,s=t.clientFailure,l=t.viewport,f=void 0!==i?i:void 0!==a&&oT(a),d=!e&&f?Ke:o,h=f||void 0===a?yI.Dirty:yI.Calced,v=this.docs.setCellContents(e,n,a,f,u,d,s,h,c,l);if(v.kind===ze.Failure)return this.logUnavailableObject(v.reason);if(this.docs.onCellModified(e),e)void 0!==s||!f&&void 0!==a||WO(n.set,(function(e){return r.shouldSample(r.config.samplePrecisionRate)&&r.computeCellValue(sr(n.sheet,e),BO.PrecisionTest),!0}));else{if(f){var p=sr(n.sheet,u);if(this.docs.inferRangeFormat(n.set,p).forEach(this.logUnavailableObject.bind(this)),void 0!==l&&Tt(l.sheet,n.sheet))WO(SO(n.set,_O(l.range)),(function(e){var t=sr(n.sheet,e);return r.computeCellValue(t,BO.EditedCell),!0}))}var m=this.scheduleDependents(n,l);if(m.kind===ze.Failure)return this.logUnavailableObject(m.reason);this.computeFinished()}},e.prototype.handleSetRangeFormula=function(e,t){var r=t.range,n=t.fmla,i=t.origin,a=t.viewport,o=oT(n);A("calc.calc.PartialWorkbook: handleSetRangeFormula",""===n&&!e||o);var u,c=o?yI.Dirty:yI.Calced,s=e?void 0:Ke,l=!!e&&void 0,f=this.docs.setRangeFormula(e,r,n,i,s,c,l,a);if(f.kind===ze.Failure)return this.logUnavailableObject(f.reason);if(this.docs.onCellModified(e),!e){o&&this.computeCellValue(V(V({},r),{range:bt(r.range)}),BO.EditedCell);var d=qO((u=r).sheet,_O(u.range)),h=this.scheduleDependents(d,a);if(h.kind===ze.Failure)return this.logUnavailableObject(h.reason);this.computeFinished()}},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerInfo.totalTimeMs;if(void 0===t)return e();var r,n=kr();try{r=e()}finally{this.stateEvalTime+=Or(1,kr()-n),this.stateEvalTime>=t&&(this.queue.invalidate($O.ComputeCellValue),this.queue.invalidate($O.PrecisionComputeCellValue),this.queue.invalidate($O.ContinueComputation),this.queue.invalidate($O.PrecisionContinueComputation),this.outputMessageLog.push({kind:tI.RecalcStatistics,stateId:this.stateId,message:JO.StateTimedOut}),r=[])}return r},e.prototype.handleComputeCellValue=function(e){var t,r,n,i=this,a=e.kind,o=e.kindId,u=e.stateId,c=e.message;if(c.finished)return null===(t=c.stopwatch)||void 0===t||t.stop(),void this.outputMessageLog.push({kind:tI.RecalcStatistics,message:JO.EditFinished,stateId:this.stateId});var s=this.shouldSample(this.config.sampleCellEvalStopwatchRate)?On("calc.calc.PartialWorkbook: cell eval"):void 0,l={kind:a,kindId:o,stateId:u,message:c},f=c.cell;a===$O.PrecisionComputeCellValue&&this.docs.onCellModified(!0);var d=this.docs.getRecalcValue(f);if(d.kind===ze.Failure)return this.logUnavailableObject(d.reason);if(d.value.calcState!==yI.Calced){var h=this.docs.getEditedFormula(f);if(h.kind===ze.Failure)return this.logUnavailableObject(h.reason);if(void 0!==h.value){var v=this.withEvalTiming((function(){return i.docs.evaluate(c.computeKind,f)}));if(Array.isArray(v))return null===(r=s)||void 0===r||r.stop(),void(null===(n=c.stopwatch)||void 0===n||n.stop());this.continueComputation(v.resume,l,s)}}},e.prototype.handleContinueComputation=function(e){var t,r,n=e.message,i=n.resume,a=n.computeMsg,o=n.stopwatch,u=a.message;this.outputMessageLog.push({kind:tI.RecalcStatistics,stateId:this.stateId,message:JO.ContinueComputation});var c=this.withEvalTiming(i);if(Array.isArray(c))return null===(t=o)||void 0===t||t.stop(),void(null===(r=u.stopwatch)||void 0===r||r.stop());this.continueComputation(c.resume,a,o)},e.prototype.handlePromoteCellContents=function(e){var t=e.cells,r=e.range,n=e.fromStateId,i=this.docs.promoteServerAvailability(t,n);if(i.kind===ze.Failure)return this.logUnavailableObject(i.reason);this.docs.onCellModified(!0),i.value||this.outputMessageLog.push({kind:tI.UpdateRequest,stateId:this.stateId,range:r})},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u,c,s){this.queue.enqueue(e,t,{kind:eI.SetCellContents,cells:r,fmla:n,isFormula:i,value:a,origin:o,format:u,clientFailure:c,viewport:s})},e.prototype.writeCellContents=function(e,t,r,n,i,a,o,u){var c=void 0!==o?RI(!0,o):void 0;this.setCellContents($O.ServerUpdate,e,t,r,n,a,i,c,u,void 0)},e.prototype.editCellContents=function(e,t,r,n,i,a,o){void 0===a&&(a=Ke),void 0===o&&(o=cr(t.sheet,rk));this.setCellContents($O.ClientEdit,e,t,r,n,a,i,!1,void 0,o)},e.prototype.setArrayFormula=function(e,t,r,n,i,a){this.queue.enqueue(e,t,{kind:eI.SetRangeFormula,range:r,fmla:n,origin:i,viewport:a})},e.prototype.writeArrayFormula=function(e,t,r,n,i){void 0===n&&(n=bt(t.range)),void 0===i&&(i=!1);this.setArrayFormula($O.ServerUpdate,e,t,r,n,void 0)},e.prototype.editArrayFormula=function(e,t,r,n,i){void 0===n&&(n=bt(t.range)),void 0===i&&(i=cr(t.sheet,rk)),this.setArrayFormula($O.ClientEdit,e,t,r,n,i)},e.prototype.promoteCellContents=function(e,t,r,n){this.queue.enqueue($O.ServerUpdate,e,{kind:eI.PromoteCellContents,cells:r,fromStateId:n,range:t})},e.prototype.computeCellValue=function(e,t){var r=t===BO.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?On("calc.calc.PartialWorkbook: recalc edited"):void 0;this.queue.enqueue(t===BO.PrecisionTest?$O.PrecisionComputeCellValue:$O.ComputeCellValue,this.stateId,{finished:!1,cell:e,computeKind:t,stopwatch:r})},e.prototype.continueComputation=function(e,t,r){this.queue.enqueue(t.kind===$O.PrecisionComputeCellValue?$O.PrecisionContinueComputation:$O.ContinueComputation,this.stateId,{resume:e,computeMsg:t,stopwatch:r})},e.prototype.computeFinished=function(){var e=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?On("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.queue.enqueue($O.ComputeCellValue,this.stateId,{finished:!0,stopwatch:e})},e.prototype.testAdvanceState=function(e){this.queue.enqueue($O.TestAdvanceState,e,{})},e.prototype.step=function(){var e=this.queue.pop();if(void 0===e)return{queueEmpty:!0,messages:[]};this.trySetStateId(e)&&this.handleMessage(e);var t=this.queue.peek();e.kind>=$O.ClientEdit&&e.kind<$O.MaybeCollectGarbage&&(void 0===t||t.kind>=$O.MaybeCollectGarbage)&&this.outputMessageLog.push({kind:tI.RecalcStatistics,message:JO.RecalcFinished,stateId:this.stateId});var r=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:0===this.queue.getCountUpperBound(),messages:r}},e.prototype.trySetStateId=function(e){var t=this;if(e.kind===$O.MaybeCollectGarbage)return!0;if(e.kind===$O.RunExperiment)return!0;if(e.stateId<this.stateId)return!1;if(e.kind===$O.ClientEdit&&(this.queue.invalidate($O.ContinueComputation),this.queue.invalidate($O.PrecisionContinueComputation),this.queue.invalidate($O.PrecisionComputeCellValue),this.stateEvalTime=0),e.stateId>this.stateId){if(this.stateId!==-1/0&&this.shouldSample(this.config.sampleWorkbookStatisticsRate)&&this.outputMessageLog.push({kind:tI.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics()}),2===this.stateChanges&&void 0!==this.config.experimentDefinitions){var r=this.config.experimentDefinitions;this.docs.forEachDocument((function(e){for(var n=e.cloneServer(),i=0,a=r.experiments;i<a.length;i++){var o=a[i];o.setContext(n),t.queue.enqueueRunExperimentMessage({budget:r.budget,experiment:o})}}))}var n=this.stateId;this.stateId=e.stateId,this.docs.advanceState(n),this.outputMessageLog.push({kind:tI.StateAdvanced,stateId:this.stateId}),this.queue.invalidate($O.ComputeCellValue),this.queue.invalidate($O.PrecisionComputeCellValue),this.queue.invalidate($O.ContinueComputation),this.queue.invalidate($O.PrecisionContinueComputation),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.queue.enqueue($O.MaybeCollectGarbage,this.stateId,{})}return!0},e.prototype.handleMessage=function(e){switch(e.kind){case $O.ServerUpdate:case $O.ClientEdit:switch(e.message.kind){case eI.SetCellContents:return this.handleSetCellContents(e.kind===$O.ServerUpdate,e.message);case eI.SetRangeFormula:return this.handleSetRangeFormula(e.kind===$O.ServerUpdate,e.message);case eI.PromoteCellContents:return this.handlePromoteCellContents(e.message);case eI.SetRefStyle:return this.handleSetRefStyle(e.message.refStyle);case eI.SetSheetNames:return this.handleSetSheetNames(e.message.document,e.message.sheetNames);case eI.SetLocaleInfo:return this.handleSetLocaleInfo(e.message.localeInfo);case eI.SetNumberFormats:return this.handleSetNumberFormats(e.message.numberFormats,e.message.merge);case eI.ExtendUnusedRange:return this.handleExtendUnusedRange(e.message.range);case eI.WriteNamedObject:return this.handleWriteNamedObject(e.message.scope,e.message.name,e.message.obj);case eI.WriteUndefinedNames:return this.handleWriteUndefinedNames(e.message.scope);case eI.PromoteNamedObjects:return this.handlePromoteNamedObjects(e.message.scope,e.message.fromStateId);case eI.WriteHiddenRows:return this.handleWriteHiddenRows(e.message.rows);case eI.WriteInFilterMode:return this.handleWriteInFilterMode(e.message.mode);default:return T("calc.calc.partialWorkbook.handleMessage",e.message)}case $O.ContinueComputation:return this.handleContinueComputation(e);case $O.ComputeCellValue:return this.handleComputeCellValue(e);case $O.MaybeCollectGarbage:return this.maybeCollectGarbage();case $O.PrecisionContinueComputation:return this.handleContinueComputation(e);case $O.PrecisionComputeCellValue:return this.handleComputeCellValue(e);case $O.RunExperiment:return this.handleRunExperiment(e.message);case $O.TestAdvanceState:return;default:return T("calc.calc.partialWorkbook.handleMessage",e)}},e.prototype.setSheetNames=function(e,t,r){this.queue.enqueue($O.ServerUpdate,r,{kind:eI.SetSheetNames,document:e,sheetNames:t})},e.prototype.handleRunExperiment=function(e){if(e.experiment.done)this.outputMessageLog.push({kind:tI.ExperimentRunResult,logMessage:e.experiment.resultLogMessage});else{var t=kr();e.experiment.step(),kr()-t<e.budget&&this.queue.pushRunExperimentMessage(e)}},e.prototype.handleSetSheetNames=function(e,t){var r=this.docs.setSheetNames(e,t);r.kind===ze.Failure&&this.logUnavailableObject(r.reason),this.queue.invalidate($O.ComputeCellValue),this.queue.invalidate($O.PrecisionComputeCellValue),this.queue.invalidate($O.ContinueComputation),this.queue.invalidate($O.PrecisionContinueComputation)},e.prototype.clearCompiledFormulas=function(){this.docs.clearCompiledFormulas(),this.queue.invalidate($O.ComputeCellValue),this.queue.invalidate($O.PrecisionComputeCellValue),this.queue.invalidate($O.ContinueComputation),this.queue.invalidate($O.PrecisionContinueComputation)},e.prototype.setRefStyle=function(e,t){this.queue.enqueue($O.ServerUpdate,t,{kind:eI.SetRefStyle,refStyle:e})},e.prototype.handleSetRefStyle=function(e){this.docs.setRefStyle(e),this.clearCompiledFormulas()},e.prototype.setLocaleInfo=function(e,t){this.queue.enqueue($O.ServerUpdate,t,{kind:eI.SetLocaleInfo,localeInfo:e})},e.prototype.handleSetLocaleInfo=function(e){this.docs.setLocaleInfo(e),this.clearCompiledFormulas()},e.prototype.setNumberFormats=function(e,t,r){this.queue.enqueue($O.ServerUpdate,r,{kind:eI.SetNumberFormats,numberFormats:e,merge:t})},e.prototype.handleSetNumberFormats=function(e,t){this.docs.setNumberFormats(e,t)},e.prototype.writeNamedObject=function(e,t,r,n){this.queue.enqueue($O.ServerUpdate,e,{kind:eI.WriteNamedObject,scope:t,name:r,obj:n})},e.prototype.handleWriteNamedObject=function(e,t,r){var n=this.docs.setNamedObject(!0,hr(e,t),r);if(n.kind===ze.Failure)return this.logUnavailableObject(n.reason)},e.prototype.writeUndefinedNames=function(e,t){this.queue.enqueue($O.ServerUpdate,e,{kind:eI.WriteUndefinedNames,scope:t})},e.prototype.handleWriteUndefinedNames=function(e){var t=this.docs.setUndefinedNames(e);if(t.kind===ze.Failure)return this.logUnavailableObject(t.reason)},e.prototype.promoteNamedObjects=function(e,t,r){this.queue.enqueue($O.ServerUpdate,e,{kind:eI.PromoteNamedObjects,scope:t,fromStateId:r})},e.prototype.handlePromoteNamedObjects=function(e,t){var r=this.docs.promoteNamedObjects(e,t);if(r.kind===ze.Failure)return this.logUnavailableObject(r.reason);r.value||this.outputMessageLog.push({kind:tI.UpdateNamesRequest,stateId:this.stateId,scope:e})},e.prototype.extendUnusedRange=function(e,t){this.queue.enqueue($O.ServerUpdate,t,{kind:eI.ExtendUnusedRange,range:e})},e.prototype.handleExtendUnusedRange=function(e){var t=this.docs.extendServerUnused(e.sheet,e.range);if(t.kind===ze.Failure)return this.logUnavailableObject(t.reason);this.docs.onCellModified(!0)},e.prototype.writeHiddenRows=function(e,t){this.queue.enqueue($O.ServerUpdate,e,{kind:eI.WriteHiddenRows,rows:t})},e.prototype.handleWriteHiddenRows=function(e){var t=this.docs.writeHiddenRows(e.sheet,e.range,e.hidden);if(t.kind===ze.Failure)return this.logUnavailableObject(t.reason)},e.prototype.writeInFilterMode=function(e,t){this.queue.enqueue($O.ServerUpdate,e,{kind:eI.WriteInFilterMode,mode:t})},e.prototype.handleWriteInFilterMode=function(e){var t=this.docs.writeInFilterMode(e.sheet,e.inFilterMode);if(t.kind===ze.Failure)return this.logUnavailableObject(t.reason)},e.prototype.getStatistics=function(){return{queueSize:this.queue.getCountUpperBound(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.maybeCollectGarbage=function(){if(!(this.stateChangesSinceLastGC<17)){var e=this.stateId-17;this.docs.collectGarbage(e),this.outputMessageLog.push({kind:tI.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.scheduleDependents=function(e,t){var r=this,n=function(t,n){var i=n;return Tt(t,e.sheet)&&(i=SO(i,kO(e.set))),r.docs.forEachEditedNonBlankCellInSet(t,i,(function(e){var n=sr(t,e),i=r.docs.getEditedFormula(n);return i.kind===ze.Failure?(r.logUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla&&r.computeCellValue(n,BO.DependentCell),!0)}))};return void 0!==t?n(t.sheet,_O(t.range)):n(e.sheet,WR)},e}();function ak(e){return new Promise((function(t){return setTimeout(t,e)}))}function ok(e,t){var r=t&&t.timeThreshold||10,n=t&&t.costThreshold||1,i=t&&t.macrotaskDelay||0,a={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},o=Vy(),u=o[0],c=o[1],s=c[0],l=c[1];var f=!0;var d=ak(i),h=kr();return function t(){if(!f||!function(){try{for(var t=0;t<n;){a.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return l(e),!1}}())return s();var o=kr();o-h<r?(Promise.resolve().then(t),a.microtaskContinues+=1):(d.then((function(){d=ak(i),h=kr(),a.macrotaskTotalDelay+=h-o,t()})),a.macrotaskContinues+=1)}(),{promise:u,stop:function(){f=!1},stats:a}}function uk(e,t){var r=Tr("en-US"),n=function(e,t,r){var n=mi().slice();return WI(t,cT,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),gi(e,n)}(r,e.worksheetFunctionNames,t),i=n.getWorksheetFuncId,a=n.getWorksheetFuncName,o=function(e,t){var r=di.slice();return WI(e,sT,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t);return V(V({},e),{parseNumber:ui(Zn()),getWorksheetFuncId:i,getWorksheetFuncName:a,isNumeral:ci,getOrdinal:si,isIdentStart:li,isIdentContinue:fi,stringCompareCI:r,errorNames:o})}function ck(e,t){return Sr(t)?{index:e,length:1}:{index:e,length:Ir(t-e)+1}}function sk(e,t){var r=ck(t.row,t.lastRow),n=r.index,i=r.length,a=ck(t.column,t.lastColumn),o=a.index,u=a.length;return cr(rr(e,t.sheetId),ir(n,o,i,u))}function lk(e,t){var r=t.sheetId,n=t.usedRange;return Cr(n)?sk(e,V({sheetId:r},n)):{sheet:rr(e,r),range:void 0}}function fk(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=aO({row:t}),i=aO({col:r}),a=gO(n,i);return yO(_O(e),a)}(e.range,t,r)}}function dk(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function hk(e){return Rt(e)?ey(e.sheet.index,e.range.row,e.range.col):ey(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function vk(e,t,r,n){var i=BR;if(Sr(n))return i;for(var a=0;a<n.length;a+=1){var o=n[a];if(e<=o&&o<e+t){for(var u=1;a+u<n.length&&n[a+u]===o+u;)u+=1;a+=u-1,i=LR(i,r(yr(o,o+u)))}}return i}function pk(e,t){switch(typeof t){case"string":case"boolean":return t;case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return Ke;case"Error":return be(t.type);default:return}}function mk(e,t,r){if(!Sr(r)){switch(r.kind){case"NamedValue":switch(typeof r.value){case"string":case"boolean":return BT(r.value);case"number":return BT(e.fromNumber(r.value))}return"Error"===r.value.kind?BT(be(r.value.type)):T("calc.calc.namedObjectDataToNamedObject: NamedValue",r.value.kind);case"NamedFormula":return HT(r.formulaBarText);case"NamedRange":var n=sk(t,r.range);return BT(Be(n.sheet,n.range));case"NamedFailure":return jT(r.failureReason,Sr(r.objectKind)?void 0:r.objectKind)}return T("calc.calc.namedObjectDataToNamedObject: kind",r)}}function gk(e,t){var r;if(t.kind===od.NotImplemented)for(var n=0,i=t.features;n<i.length;n++){var a=i[n];GI(e,od.NotImplemented+" "+a)}else if(t.kind===od.IllFormedFormula)GI(e,od.IllFormedFormula+" "+JSON.stringify(null!=(r=t.diagnostics)?r:{}));else if(t.kind===od.Unavailable)for(var o=0,u=t.objects;o<u.length;o++){var c=u[o],s=[od.Unavailable];if("string"==typeof c.kind&&c.kind in zT){var l=c;switch(s.push(l.kind),l.kind){case zT.SheetId:s.push(l.sheetId);break;case zT.NameLoc:s.push(void 0===l.name.scope.index?"global":"sheet");break;case zT.ClientFailure:s.push(l.reason);break;case zT.VolatileFunction:s.push(l.name)}}else s.push(JSON.stringify(c));GI(e,s.join(" "))}else t.kind===od.LimitExceeded?GI(e,t.kind+" "+fd[t.limit]):GI(e,t.kind)}var Ck,Sk=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.arrayDeltas=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.isRecalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==HO.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(t=e!==HO.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push.apply(t,r)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.isRecalcFinished=this.isRecalcFinished||e},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(Gy(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.arrayDeltas.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,this.arrayDeltas),this.editedRangeDeltas=[],this.arrayDeltas=[]),this.dependentRangeDeltas.length>0&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[]),this.dependentRangeDeltas=[]),this.isRecalcFinished&&(this.onRecalcResults(Uy(this.currentOutputStateId,"Dependents",!0,[],[])),this.isRecalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r){for(var n=0;n<Math.max(t.length,r.length);n+=10)this.onRecalcResults(Uy(this.currentOutputStateId,e,!1,t.slice(n,n+10).filter((function(e){return"object"!=typeof e.data.value})),r.slice(n,n+10)))},e}(),Ek=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.document=er(void 0,""),this.localeInfo=Si(),this.mathpack=Zn(),this.refStyle=_.A1,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.recalcStatistics=XO,this.precisionStatistics=rI,this.nameFailures=[],this.rangeFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.setConfig({}),this.dataModel=new ik(this.localeInfo,this.mathpack,this.refStyle,this.config)}return e.prototype.setInputStateId=function(e){var t=e-this.currentInputStateId;return t<0?(this.logInputStateIdDecrease(),!1):(0!==t&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;return this.clearAsyncResumeRecalc(),this.recalcLoop=ok((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs}),Py(this.recalcLoop.promise,(function(){e.recalcLoop=void 0}))},e.prototype.processRecalcResults=function(e){for(var t,r,n=new Sk(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),i=0,a=e;i<a.length;i++){var o=a[i];if(o.kind!==tI.GarbageCollected)if(o.kind!==tI.ExperimentRunResult){if(this.setOutputStateId(o.stateId))switch(n.setOutputStateId(o.stateId),o.kind){case tI.CellWrite:var u=o.cell,c=o.value,s=o.format,l=o.cellKind,f=u.sheet,d=u.range,h=this.cellWriteToRangeDelta(f.index,d.row,d.col,c,s,"messages.<index>.value");Cr(h)&&n.pushCellWrite(l,h);break;case tI.RangeWrite:var v=o.range,p=o.values;l=o.cellKind,f=v.sheet,d=v.range;n.pushRangeWrite.apply(n,j([l],this.rangeWriteToRangeDeltas(f.index,d,p,"messages.<index>.values")));break;case tI.NameFailure:this.nameFailures.push(o);break;case tI.RangeFailure:this.rangeFailures.push(o);break;case tI.UnhandledFailure:this.unhandledFailures.push(o);break;case tI.UpdateRequest:n.pushUpdateRequest(hk(o.range));break;case tI.UpdateNamesRequest:n.pushUpdateNameRequest(o.scope);break;case tI.RecalcStatistics:n.pushRecalcFinished(o.message===JO.RecalcFinished),this.recalcStatistics=QO(this.recalcStatistics,o);break;case tI.PrecisionStatistics:this.precisionStatistics=(t=this.precisionStatistics,r=o.stats,{samples:nI(t.samples,r.samples),failures:nI(t.failures,r.failures)});break;case tI.WorkbookStatistics:this.logWorkbookStats(o.stateId,o.stats);break;case tI.StateAdvanced:break;default:return T("calc.calc.RecalcServiceImpl.processRecalcResults",o)}}else this.logExperimentRunResult(o.logMessage);else this.onGC(o.minStateIdKept)}n.flush()},e.prototype.logExperimentRunResult=function(e){O.ULS.traceTag(594409422,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.calc.RecalcServiceImpl.ExperimentRunResult: "+e)},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",d.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",d.TraceLevel.Info),this.logGenFailureStats(r,595194338,"unhandled",d.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var i={},a=0,o=e;a<o.length;a++){gk(i,o[a].reason)}var u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(i);O.ULS.traceTag(t,d.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var i=this;if(0!==e.length){for(var a={},o=0,u=e;o<u.length;o++){var c=u[o],s=c.reason,l=c.cellKind;gk(a[l]||(a[l]={}),s)}Object.getOwnPropertyNames(a).sort().forEach((function(e){var o=a[e],u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+i.currentOutputStateId+", cell kind = "+e+", stats = "+JSON.stringify(o);O.ULS.traceTag(t,d.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r].reason;if(i.kind===od.JavaScriptError){var a="calc.calc.RecalcService: recalc "+t+" JavaScript error: "+m(i.error);O.ULS.traceTag(595658721,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,a)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var i="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+t+", stats = "+JSON.stringify(n));O.ULS.traceTag(e,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,i)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0){var e=this.recalcStatistics;if(this.recalcStatistics=XO,this.dataModel.shouldSample(this.config.sampleRecalcStatisticsRate)){var t="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e));O.ULS.traceTag(595654593,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,t)}}},e.prototype.logPrecisionStats=function(){if(0!==this.precisionStatistics.samples.length||0!==this.precisionStatistics.failures.length){var e=this.precisionStatistics,t=e.samples,r=e.failures,n={};r.forEach((function(e){return gk(n,e)}));var i="calc.calc.RecalcService: precision statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify({samples:t,failures:n}));O.ULS.traceTag(595645023,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,i),this.precisionStatistics=rI}},e.prototype.logWorkbookStats=function(e,t){var r="calc.calc.RecalcService: workbook statistics; "+("stateId = "+e+", stats = "+JSON.stringify(t));O.ULS.traceTag(595359882,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,r)},e.prototype.logInputStateIdDecrease=function(){GI(this.ignoredInputStats,"stateId went backwards")},e.prototype.logOutputStateIdDecrease=function(){GI(this.ignoredOutputStats,"stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats(),this.logPrecisionStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,i,a){if(VI(n,WT,this.ignoredOutputStats,a)){var o=function(e,t){switch(typeof t){case"string":case"boolean":return t;case"number":return e.toNumber(t)}switch(t.kind){case te.Error:return YE(t.type);default:return}}(this.mathpack,n),u=function(e){if(void 0!==e)return Ly(e.isExact,e.iformat,!1,e.category,e.decimals)}(i);return Cr(void 0)||Cr(o)||Cr(u)?_y(ey(e,t,r),wy(void 0,o,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n){for(var i=n+".<index>.<index>",a=t.row,o=t.col,u=t.rows,c=t.cols,s=[],l=0;l<u;l+=1)for(var f=0;f<c;f+=1){var d=this.cellWriteToRangeDelta(e,a+l,o+f,r[l][f],void 0,i);Cr(d)&&s.push(d)}return s},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?_.A1:_.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentInputStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.localeInfo=uk(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentInputStateId)},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(WI(e,fT,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.setSheetNames=function(e){this.updateSheetNames(this.currentInputStateId,e)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e)&&(this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,WI(t,hT,this.ignoredInputStats,"sheetNames"),e))},e.prototype.updateNamedObjects=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=WI(t,_T,this.ignoredInputStats,"namedObjectsUpdates");r<n.length;r++){var i=n[r],a=i.scope,o=i.objects,u=i.fromStateId,c=dr(this.document,Cr(a)?a:void 0);if(Cr(o))for(var s=0,l=WI(o,wT,this.ignoredInputStats,"namedObjectsUpdates.<index>.objects");s<l.length;s++){var f=l[s],d=f.name,h=f.data;this.dataModel.writeNamedObject(e,c,d,mk(this.mathpack,this.document,h))}else Cr(u)?this.dataModel.promoteNamedObjects(e,c,u):this.dataModel.writeUndefinedNames(e,c)}}},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=WI(t,kT,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var i=n[r];this.dataModel.extendUnusedRange(lk(this.document,i),e)}}},e.prototype.updateRanges=function(e,t){var r,n;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var i=0,a=WI(t,OT,this.ignoredInputStats,"rangeUpdates");i<a.length;i++){var o=a[i],u=o.range,c=o.excludeRows,s=o.excludeColumns,l=o.data,f=o.fromStateId,d=sk(this.document,u),h=d.range,v=vk(h.row,h.rows,wO.row,c),p=fk(d,v,vk(h.col,h.cols,wO.col,s)),m=Cr(l)?pk(this.mathpack,l.value):Ke;if(void 0!==m){var g=bt(h);if(Cr(l)){var C=l.iformat,S="ArrayFormula"===l.kind?void 0:null!=(r=l.formulaBarText)?r:void 0,E=null!=(n=l.failureReason)?n:void 0;if("Inferred"===l.kind)this.dataModel.writeCellContents(e,p,S,void 0,g,m,C,E);else{var y="CellFormula"===l.kind;this.dataModel.writeCellContents(e,p,S,y,g,m,C,E)}}else Sr(f)?this.dataModel.writeCellContents(e,p,"",!1,g,Ke,0,void 0):this.dataModel.promoteCellContents(e,d,p,f);this.dataModel.writeHiddenRows(e,dk(d,v))}}}},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=WI(t,TT,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var i=n[r],a=i.range,o=i.data,u=i.fromStateId,c=sk(this.document,a);if(Cr(o)){var s=o.formulaBarText,l=o.isSpilled,f=bt(c.range);this.dataModel.writeArrayFormula(e,c,s,f,l)}else Cr(u)}}},e.prototype.editRangeFormulas=function(e,t){var r=this;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var n=WI(t,xT,this.ignoredInputStats,"rangeFormulaEdits"),i=function(t){var n=t.kind,i=t.range,o=t.formulaBarText,u=t.value,c=t.origin,s=t.viewport,l=BR;i.forEach((function(e){l=gO(l,_O(sk(r.document,e).range))}));var f=sk(a.document,i[0]),d=Cr(c)?ar(c.row,c.column):bt(f.range),h=Cr(s)?sk(a.document,s):void 0,v=void 0;if(Cr(u)){if(void 0===(v=pk(a.mathpack,u)))return"continue"}else v=void 0;var p="CellFormula"===n||"Value"!==n&&void 0;a.dataModel.editCellContents(e,qO(f.sheet,l),o,p,d,v,h)},a=this,o=0,u=n;o<u.length;o++){i(u[o])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=WI(t,PT,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var i=n[r],a=i.range,o=i.formulaBarText,u=i.origin,c=i.viewport,s=sk(this.document,a),l=Cr(u)?ar(u.row,u.column):ar(a.row,a.column),f=Cr(c)?sk(this.document,c):void 0;this.dataModel.editArrayFormula(e,s,o,l,f)}}},e.prototype.setConfig=function(e){var t,r,n,i,a,o,u,c;this.config={yieldIntervalMs:10,totalTimeMs:(t=e.totalEvalTimeMs,null!=t?t:1e4),maxCellChain:32768,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionRate:(r=e.samplePrecisionRate,null!=r?r:.02),sampleRecalcStatisticsRate:(n=e.sampleRecalcStatisticsRate,null!=n?n:.2),sampleWorkbookStatisticsRate:(i=e.sampleWorkbookStatisticsRate,null!=i?i:.1),sampleCellEvalStopwatchRate:(a=e.sampleCellEvalStopwatchRate,null!=a?a:.003),sampleRecalcEditedStopwatchRate:(o=e.sampleRecalcEditedStopwatchRate,null!=o?o:1),sampleRecalcViewportStopwatchRate:(u=e.sampleRecalcViewportStopwatchRate,null!=u?u:1),rngSeed:(c=e.rngSeed,null!=c?c:1e3*Date.now())}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new ik(this.localeInfo,this.mathpack,this.refStyle,this.config),this.recalcStatistics=XO,this.precisionStatistics=rI,this.nameFailures=[],this.rangeFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=-1/0},e.prototype.testAdvanceState=function(e){this.setInputStateId(e)&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.testDelay=function(e){return B(this,void 0,void 0,(function(){return H(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},e}();function yk(){return{onError:function(e,t){var r="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:m(t.error)});O.ULS.traceTag(595658753,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,r)},onInit:function(e){var t=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),r=t.onRecalcResults,n=t.onUpdateRequest,i=t.onGC;e.setExports("service",new Ek(r.notify,n.notify,i.notify))},scriptName:"excelOnlineRecalcService.worker"}}!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(Ck||(Ck={}));var Rk=function(e){return void 0===e&&(e=Ck.Thread),B(this,void 0,void 0,(function(){var t,r,n,i,a,o,u;return H(this,(function(c){switch(c.label){case 0:return t=!1,r={outside:{onError:function(e,r){var n=null!=r.error.stack?r.error.stack:r.error.message,i="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});O.ULS.traceTag(595658719,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,i),r.closing&&(t=!0)},onClosed:function(e){var r="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(t?"because of an error":"normally");O.ULS.traceTag(595658720,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,r)}},inside:yk()},[4,dR(e===Ck.Thread?[ky.Dedicated]:e===Ck.Local?[ky.FunctionCall]:[ky.Dedicated,ky.FunctionCall],r)];case 1:if(null==(n=c.sent()))throw new Error("could not create recalc service worker");return i="calc.calc.createRecalcService: worker created; outside.workerKind = "+n.workerKind,O.ULS.traceTag(595731987,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,i),a=-1/0,o={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){a=e}},n.setExports("client",o),u=n.getImports("service",["setA1ReferenceStyle","setLocale","setNumberFormats","setSheetNames","updateSheetNames","updateUnusedCells","updateNamedObjects","updateRanges","updateArrays","editRangeFormulas","editArrayFormulas","resumeRecalc","reconfigure","clearCache","testAdvanceState","testDelay"]),[2,{setOnRecalcResults:function(e){o.onRecalcResults=e},setOnUpdateRequest:function(e){o.onUpdateRequest=e},setA1ReferenceStyle:function(e){t||u.setA1ReferenceStyle.notify(e)},setLocale:function(e){t||u.setLocale.notify(e)},setNumberFormats:function(e,r){t||u.setNumberFormats.notify(e,r)},setSheetNames:function(e){t||u.setSheetNames.notify(e)},updateSheetNames:function(e,r){t||u.updateSheetNames.notify(e,r)},updateNamedObjects:function(e,r){t||u.updateNamedObjects.notify(e,r)},setUsedRanges:function(e,t){},updateUnusedCells:function(e,r){t||u.updateUnusedCells.notify(e,r)},updateRanges:function(e,r){t||u.updateRanges.notify(e,r)},updateArrays:function(e,r){t||u.updateArrays.notify(e,r)},editRangeFormulas:function(e,r){t||u.editRangeFormulas.notify(e,r)},editArrayFormulas:function(e,r){t||u.editArrayFormulas.notify(e,r)},resumeRecalc:function(){t||u.resumeRecalc.notify()},reconfigure:function(e){t||u.reconfigure.notify(e)},clearCache:function(){t||u.clearCache.notify()},testAdvanceState:function(e){t||u.testAdvanceState.notify(e)},testResumeRecalc:function(){return t?Promise.resolve():u.resumeRecalc.call()},testCrash:function(){return u.testDelay.isCritical=!0,u.testDelay.callTimeout=0,u.testDelay.call(100)},close:function(){n.close()},stateIdAvailable:function(e){return e>=a}}]}}))}))}}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map